{"version":3,"sources":["skylark-panolens.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"../skylark-panolens.js","sourcesContent":["define('skylark-panolens/panolens',[\n\t\"skylark-langx/skylark\"\n], function (skylark) {\n\n    return {\n    };\n});\ndefine('skylark-panolens/Constants',[], function () {\n    'use strict';\n    const REVISION = \"11\";\n    const VERSION = \"0\";\n    const THREE_REVISION = \"105\";\n    const THREE_VERSION = \"0\";\n    const CONTROLS = {\n        ORBIT: 0,\n        DEVICEORIENTATION: 1\n    };\n    const MODES = {\n        UNKNOWN: 0,\n        NORMAL: 1,\n        CARDBOARD: 2,\n        STEREO: 3\n    };\n    return {\n        REVISION: REVISION,\n        VERSION: VERSION,\n        THREE_REVISION: THREE_REVISION,\n        THREE_VERSION: THREE_VERSION,\n        CONTROLS: CONTROLS,\n        MODES: MODES\n    };\n});\ndefine('skylark-panolens/DataImage',[],function () {\n    'use strict';\n    const DataImage = {\n        Info: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAABAAAAAQADq8/hgAAADBklEQVR42u2bP08UQRiHnzFaSYCI/xoksdBIqGwIiYWRUBISExpCQ0ej38FWOmlIKKhoMPEbaCxsrrHiYrQgOSlQEaICrT+LHSPZzNzt3s3c3Hn7lHvLzvv82L2dm30XKioqKgYY062BJF0HpoA7wARwBbhsPz4DjoEG8AnYNcZ8Sx1Op8IXJM1KWpdUV3nq9m9nJV1I7VNGfEzSM0mNNqR9NOwxx1L7NRMflbQm6SSgeJ4TO8Zoat+8/LKkg4jieQ4kLaf2RtKwpJ0uiufZkTScSn5S0l5C+b/sSZrstvyMpKPU5uc4kjTTjkvpeYCkaeA1/+7hvcIZMGuMqUULQNIU8Aa4ltrWwyHwyBizGzwASSPAe+B2assW7AH3jTE/i+xcZoa12Qfy2Bo3i+5cKABl99zF1GYlWFTBeULLS0DZrOsDcDNggTXgc27bLWA64BhfgHvGmB8dHUXZ1DM0S45xliKMs9bKr+klIOkqsBrwv9JtVq1DewEAT4Ch1BYdMGQdygeg7Df4SmqDAKyoyXpCszPgITCeuvoAjFuX0gE8jljUdv7bCtiOOJ7XpdUZ8L/gdXHOA5QtYH5NXXVgbrgWWn1nwFTqaiPgdPIFcDd1tRFwOl307DwRuZgXwLvctgfA04hjOp18AcReZ6sZY16e3yDpUuQxnU6+S2AkcjEpcDr1zxOXSPgCKLSa0mc4nXwB/EpdbQScTr4AGqmrjYDTyRfAx9TVRsDp5Aug8LJyH+F0cgZg58z11BUHpO5ruGh2G3ybuuqAeF2aBfAqddUB8bq0OgP2U1cegH3aOQOMMb+BrdTVB2DLupQLwLIOnKY26IBT6+ClaQDGmO/ARmqLDtiwDn7HVkcY+EdjNoTlCI+tYhO2iUppm6HKslPUq2qQKHpUe8AFsjaUXuUQWCgqXyoAG8IuME/WkNRrnAHzZfqDSgdgQ6gBc2Td3b3CMTBXtkOsIzTIjZLnQhjcVtlcEIPZLJ0LoVvt8s/Va+3yuSAG84UJRxB98cpM9dJURUVFxSDzBxKde4Lk3/h2AAAAAElFTkSuQmCC',\n        Arrow: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAABAAAAAQADq8/hgAAADPklEQVR42u2bMUscQRiG30/SRaJEI1ZKUiRErNIELRUbQYSAnX8hpVUgkDYp0wgWVjYW+QcJaQzYpLojJIXhtDDEKBpj65ti58ixmdmb2ZvZ7+T2AUHudmfmeXf2bnb3O6CmpqZmgJGqOiI5AWAWwEMA0wDuArht3r4CcAagBeAbgIaI/NQOp1fhIZKLJN+SbDKcptl3keSQtk+I+BjJVyRbJaRdtEybY9p+ReKjJN+QvIwonufS9DGq7ZuXXyd5nFA8zzHJdW1vkLxDcrdC8Ty7JO9oyc+QPFCUb3NAcqZq+TmSp9rmHZySnCvjErwOIPkUwHv8+w7vF64ALIrIfrIASM4C+ADgnratgxMACyLSiB4AyREAnwE80LbswgGAJyJy4bNxyApr6wbIw4xxy3djrwCYfeeuaZsFsEbPdULXU4DZqusLgMkEA21P05EEbf8A8FhEzos28pkBLxLKL5s/r/M1kEkz9vKQHGeatf05yfmOfubNa7G5JDle5NhtBjwHMBz5yFwAWBaRT+0XzP8pZsKwcQiH2fX8Ycojb+kzxUw4ZJn7CSQXqpRPHMKCq7+iZJ71Mvdy/DftXSQ6HcJdSDaqPPKW/mPOBO+lcbvzCU35RCFM2PpwnQKzZQfdgfe0dxH5dLA6uQJ4pC2fIASrkyuA6X6QjxyC1ckVQNn7bNHlI4ZgdXIFUObiJJl8pBCsTjGfuIwA2Cv4FN7xbYjkjqsRAHuIePXoCiDF1Zk2VidXAL+1R5sAq5MrgJb2aBNgdXIF8FV7tAmwOrkCCFs73wysTtYATHFCU3vEEWm6Ci6KvgY/ao86Ik6XogDeaY86Ik6XbjPgSHvkEThCwQy45XpDRK5JbgN4GWkgUyR9H65MRQxgW0SunZ5FezK7pfwd8e8MV8UfAPdF5Jdrg8JrAbPjprZFD2wWyQP6j8ZSEufRmGlgQ9umBBvd5IOgbjFUKLu+XnWBhG+rpsFVZGUo/coJgFVf+aAATAgNACvICpL6jSsAKyH1QcEBmBD2ASwhq+7uF84ALIVWiPUEB7lQsiOEwS2VzQUxmMXSuRCqKpd/zX4rl88FMZg/mLAEcSN+MlP/aKqmpqZmkPkL0hSjwOpNKxwAAAAASUVORK5CYII=',\n        FullscreenEnter: 'data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICAgIDxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz4KICAgIDxwYXRoIGQ9Ik03IDE0SDV2NWg1di0ySDd2LTN6bS0yLTRoMlY3aDNWNUg1djV6bTEyIDdoLTN2Mmg1di01aC0ydjN6TTE0IDV2MmgzdjNoMlY1aC01eiIvPgo8L3N2Zz4=',\n        FullscreenLeave: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggc3R5bGU9ImZpbGw6I2ZmZiIgZD0iTTE0LDE0SDE5VjE2SDE2VjE5SDE0VjE0TTUsMTRIMTBWMTlIOFYxNkg1VjE0TTgsNUgxMFYxMEg1VjhIOFY1TTE5LDhWMTBIMTRWNUgxNlY4SDE5WiIgLz48L3N2Zz4=',\n        VideoPlay: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggc3R5bGU9ImZpbGw6I2ZmZiIgZD0iTTgsNS4xNFYxOS4xNEwxOSwxMi4xNEw4LDUuMTRaIiAvPjwvc3ZnPg==',\n        VideoPause: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggc3R5bGU9ImZpbGw6I2ZmZiIgZD0iTTE0LDE5LjE0SDE4VjUuMTRIMTRNNiwxOS4xNEgxMFY1LjE0SDZWMTkuMTRaIiAvPjwvc3ZnPg==',\n        WhiteTile: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIABAMAAAAGVsnJAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAB1WlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx0aWZmOkNvbXByZXNzaW9uPjE8L3RpZmY6Q29tcHJlc3Npb24+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDx0aWZmOlBob3RvbWV0cmljSW50ZXJwcmV0YXRpb24+MjwvdGlmZjpQaG90b21ldHJpY0ludGVycHJldGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KAtiABQAAACRQTFRFAAAAAAAABgYGBwcHHh4eKysrx8fHy8vLzMzM7OzsAAAABgYG+q7SZgAAAAp0Uk5TAP7+/v7+/v7+/iJx/a8AAAOwSURBVHja7d0hbsNAEAVQo6SFI6XEcALDcgNLvUBvEBQVhpkWVYWlhSsVFS7t5QIshRt695lEASZP+8c7a1kzDL1fz+/zyuvzp6FbvoddrL6uDd1yGZ5eXldeb18N3fIx7A+58prmhm65DfvDcd0952lu6JabFbD/zVprZj1lzcys+fj9z8xTZtbT8rv8yWlu6BYAIgAAAAAAAAAAAABAM6QXEAEAAAAAAAAAgJ2gnaAIiIA3Q2qAGgAAAAAAAAAAAAAAAAAAAAAAAAAAQJsADkVFAAAAAAA8Bj0GRUAEREAEREAEREAEREAEAAAAAAAAAAB2gnaCIiACPplRA9QANUAERAAAAEVQERQBERCBVlfAcZ3aeZobusUKMGBhV6KUElHGKBERJR6/fxExRkQZl9/lT8S1oVsuhqyYMmPKjCkzvfcCpsxohrwY0Q06EAEAAAAAAAAAAACgGdILiAAAAAAAAAAAwE7QTlAERMCbITVADQAAAAAAAAAAAAAAAAAAAAAAAAAAwKmwQ1ERAAAAAACPQY9BERABERABERABERABERABAAAAAAAAAICdoJ2gCIiAT2bUADVADRABEQAAQBFUBEVABERgEyvAlJm+V4ApM6bMmDJjyowpM6bMdN0LmDKjGfJiRDfoQAQAAAAAAAAAAACAZkgvIAIAAAAAAAAAADtBO0EREAFvhtQANQAAAAAAAAAAAAAAAAAAAAAAAAAAAKfCDkVFAAAAAAA8Bj0GRUAEREAEREAEREAEREAEAAAAAAAAAAB2gnaCIiACPplRA9QANUAERAAAAEVQERQBERCBTawAU2b6XgGmzJgyY8qMKTOmzJgy03UvYMqMZsiLEd2gAxEAAAAAAAAAAAAAmiG9gAgAAAAAAAAAAOwE7QRFQAS8GVID1AAAAAAAAAAAAAAAAAAAAAAAAAAAAJwKOxQVAQAAAADwGPQYFAEREAEREAEREAEREAERAAAAAAAAAADYCdoJioAI+GRGDVAD1AAREAEAABRBRVAEREAENrECTJnpewWYMmPKjCkzpsyYMmPKTNe9gCkzmiEvRnSDDkQAAAAAAAAAAAAAaIb0AiIAAAAAAAAAALATtBMUARHwZkgNUAMAAAAAAAAAAAAAAAAAAAAAAAAAAHAq7FBUBAAAAADAY9BjUAREQAREQAREQAREQAREAAAAAAAAAABgJ2gnKAIi4JMZNUANUANEQAQAAFAEFUEREAER2MQKMGWm7xVgyowpM50PWen9ugNGXz1XaocAFgAAAABJRU5ErkJggg==',\n        Setting: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAABAAAAAQADq8/hgAAADn0lEQVR42u2bzUsVURjGnyO6CPzAMnTjppAo3LTwH1CqTfaxbeOiRS37A0wXtROFVi1aRBs3LWohSIGbQAQXViBGRhG0UIRKUCpK7q/FnOB2uc6cOXNmRnGe3eW+H8/7zLln3vNxpQoVKlQ4wjBFJAFOSRqX1O7osivpvjHmU1nChBZglvSYLYJbS0EanCvIJzWK+gnsyH34/8OuMaYjb265jwCgz6N4SWq3vodbAEmnS/KtBDgoAgyU5BteAOAkMAPcBroc7PskDWfgN+wyDwBdltMMcDI3tYBnde/pHeARMNTErgd4APzweP834oeN1dMkz5DlsFNn/yyv4kdiSK4At4AO4CqwGaDwRmza2B0210qM7YhrXU59ANAq6bWkwQTTn5KO5fIE0uVYlXTeGLOXFMx1DrjlULwKKN41x6DlnIjEEQCckPRe0okCiguJr5LOGGO+xhm5jICJQ1i8LOeJJKPYEQAMKvrtt5ZdjSf2FM0Fq/sZJI2A6UNcvCz36TiDfUcAcE1SPu/U6Mm8k/TFfu6XdFb5iX3dGPM8lQfwNod3+TowBnQ3yddtv1vPIe+b1JIBiwEJ1IAJ208k5W21trWA+V/5CHAcmAtU/A2P/DcCiTAHHE8tgCVhgLvAXgYCk17Jo/yTGfLuWe7Zd72AC8CWB4n3OAz7mLytNkZabAEXMhfeQKYfWEpJZCxA3rGUOZeA/qDF15FpAz47EvlNk9neI2e3jeWCz0BbmvipNkSMMX8kuSZYM8Z8zyqAjbHmaN5mOeYjgIXrU93MWrxHrNQjrqiDkQMLHwG+OdqF3NN3jeXKzU8AoF1SzdH8XKhJUO7HZDXLMbwAwICkJUULFxe0SbqSVQAbw3Xi7Ze0ZLmGAzAKbHs0JGU1QtvAaIjCW4B7ZOvJy2qFa5a730RPtBiaz0CgnkiZi6F5fBZDVMvho7EhcuS3xJJ2hV9IupgTqaLw0hhzab8vq23xOG/r+LDsKjLgYVzxUnU0ltwK2wDezUyJmEwqXgp/PL4rvxthaeCSI+zxuA10J8ZkWdJNSb2SLkvayKHwDRu71+ZajrG941J8agALDQ3GU/a/IvMkYCPzmCbtLNEVmacNtgs5iP9fYVNEV1Q6Hez7yNZSL+J2SarTcpqiyV2iUkG0IvPFvbz5FbEn+KEk3wMjwMeSfCsBXFBdly9CAPk9ydyffpECuB5tZfVJjaKWueOSfinln6YK4lahQoUKRxd/AcRPGTcQCAUQAAAAAElFTkSuQmCC',\n        ChevronRight: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTguNTksMTYuNThMMTMuMTcsMTJMOC41OSw3LjQxTDEwLDZMMTYsMTJMMTAsMThMOC41OSwxNi41OFoiIC8+PC9zdmc+',\n        Check: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTIxLDdMOSwxOUwzLjUsMTMuNUw0LjkxLDEyLjA5TDksMTYuMTdMMTkuNTksNS41OUwyMSw3WiIgLz48L3N2Zz4=',\n        ViewIndicator: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBpZD0idmlldy1pbmRpY2F0b3IiIGhlaWdodD0iMzAiIHdpZHRoPSIzMCIgdmlld0JveD0iLTIuNSAtMSAzMCAzMCI+Cgk8c3R5bGUgdHlwZT0idGV4dC9jc3MiPi5zdDB7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLW1pdGVybGltaXQ6MTA7ZmlsbDpub25lO30uc3Qxe3N0cm9rZS13aWR0aDo2O3N0cm9rZS1taXRlcmxpbWl0OjEwO30KCTwvc3R5bGU+Cgk8Zz4KCQk8cGF0aCBjbGFzcz0ic3QwIiBkPSJNIDEyLjUgMCBBIDEyLjUgMTIuNSAwIDAgMCAtMTIuNSAwIEEgMTIuNSAxMi41IDAgMCAwIDEyLjUgMCIgdHJhbnNmb3JtPSJtYXRyaXgoMSwwLDAsMSwxMywxNS41KSI+PC9wYXRoPgoJCTxwYXRoIGNsYXNzPSJzdDIiIGQ9Ik0gMTMgMCBMIDEwIDIgTCAxNiAyIFoiPjwvcGF0aD4KCQk8cGF0aCBjbGFzcz0ic3QyIiBkPSJNIDIgMCBBIDIgMiAwIDAgMCAtMiAwIEEgMiAyIDAgMCAwIDIgMCIgdHJhbnNmb3JtPSJtYXRyaXgoMSwwLDAsMSwxMywxNS41KSI+PC9wYXRoPgoJCTxwYXRoIGNsYXNzPSJzdDEiIGlkPSJpbmRpY2F0b3IiIHRyYW5zZm9ybT0ibWF0cml4KDEsMCwwLDEsMTMsMTUuNSkiPjwvcGF0aD4KCTwvZz4KPC9zdmc+'\n    };\n    return DataImage;\n});\ndefine('skylark-panolens/lib/controls/OrbitControls',['skylark-threejs'], function (THREE) {\n    'use strict';\n    function OrbitControls(object, domElement) {\n        this.object = object;\n        this.domElement = domElement !== undefined ? domElement : document;\n        this.frameId = null;\n        this.enabled = true;\n        this.target = new THREE.Vector3();\n        this.center = this.target;\n        this.noZoom = false;\n        this.zoomSpeed = 1;\n        this.minDistance = 0;\n        this.maxDistance = Infinity;\n        this.minZoom = 0;\n        this.maxZoom = Infinity;\n        this.noRotate = false;\n        this.rotateSpeed = -0.15;\n        this.noPan = true;\n        this.keyPanSpeed = 7;\n        this.autoRotate = false;\n        this.autoRotateSpeed = 2;\n        this.minPolarAngle = 0;\n        this.maxPolarAngle = Math.PI;\n        this.momentumDampingFactor = 0.9;\n        this.momentumScalingFactor = -0.005;\n        this.momentumKeydownFactor = 20;\n        this.minFov = 30;\n        this.maxFov = 120;\n        this.minAzimuthAngle = -Infinity;\n        this.maxAzimuthAngle = Infinity;\n        this.noKeys = false;\n        this.keys = {\n            LEFT: 37,\n            UP: 38,\n            RIGHT: 39,\n            BOTTOM: 40\n        };\n        this.mouseButtons = {\n            ORBIT: THREE.MOUSE.LEFT,\n            ZOOM: THREE.MOUSE.MIDDLE,\n            PAN: THREE.MOUSE.RIGHT\n        };\n        var scope = this;\n        var EPS = 1e-7;\n        var MEPS = 0.0001;\n        var rotateStart = new THREE.Vector2();\n        var rotateEnd = new THREE.Vector2();\n        var rotateDelta = new THREE.Vector2();\n        var panStart = new THREE.Vector2();\n        var panEnd = new THREE.Vector2();\n        var panDelta = new THREE.Vector2();\n        var panOffset = new THREE.Vector3();\n        var offset = new THREE.Vector3();\n        var dollyStart = new THREE.Vector2();\n        var dollyEnd = new THREE.Vector2();\n        var dollyDelta = new THREE.Vector2();\n        var theta = 0;\n        var phi = 0;\n        var phiDelta = 0;\n        var thetaDelta = 0;\n        var scale = 1;\n        var pan = new THREE.Vector3();\n        var lastPosition = new THREE.Vector3();\n        var lastQuaternion = new THREE.Quaternion();\n        var momentumLeft = 0, momentumUp = 0;\n        var eventPrevious;\n        var momentumOn = false;\n        var keyUp, keyBottom, keyLeft, keyRight;\n        var STATE = {\n            NONE: -1,\n            ROTATE: 0,\n            DOLLY: 1,\n            PAN: 2,\n            TOUCH_ROTATE: 3,\n            TOUCH_DOLLY: 4,\n            TOUCH_PAN: 5\n        };\n        var state = STATE.NONE;\n        this.target0 = this.target.clone();\n        this.position0 = this.object.position.clone();\n        this.zoom0 = this.object.zoom;\n        var quat = new THREE.Quaternion().setFromUnitVectors(object.up, new THREE.Vector3(0, 1, 0));\n        var quatInverse = quat.clone().inverse();\n        var changeEvent = { type: 'change' };\n        var startEvent = { type: 'start' };\n        var endEvent = { type: 'end' };\n        this.setLastQuaternion = function (quaternion) {\n            lastQuaternion.copy(quaternion);\n            scope.object.quaternion.copy(quaternion);\n        };\n        this.getLastPosition = function () {\n            return lastPosition;\n        };\n        this.rotateLeft = function (angle) {\n            if (angle === undefined) {\n                angle = getAutoRotationAngle();\n            }\n            thetaDelta -= angle;\n        };\n        this.rotateUp = function (angle) {\n            if (angle === undefined) {\n                angle = getAutoRotationAngle();\n            }\n            phiDelta -= angle;\n        };\n        this.panLeft = function (distance) {\n            var te = this.object.matrix.elements;\n            panOffset.set(te[0], te[1], te[2]);\n            panOffset.multiplyScalar(-distance);\n            pan.add(panOffset);\n        };\n        this.panUp = function (distance) {\n            var te = this.object.matrix.elements;\n            panOffset.set(te[4], te[5], te[6]);\n            panOffset.multiplyScalar(distance);\n            pan.add(panOffset);\n        };\n        this.pan = function (deltaX, deltaY) {\n            var element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n            if (scope.object instanceof THREE.PerspectiveCamera) {\n                var position = scope.object.position;\n                var offset = position.clone().sub(scope.target);\n                var targetDistance = offset.length();\n                targetDistance *= Math.tan(scope.object.fov / 2 * Math.PI / 180);\n                scope.panLeft(2 * deltaX * targetDistance / element.clientHeight);\n                scope.panUp(2 * deltaY * targetDistance / element.clientHeight);\n            } else if (scope.object instanceof THREE.OrthographicCamera) {\n                scope.panLeft(deltaX * (scope.object.right - scope.object.left) / element.clientWidth);\n                scope.panUp(deltaY * (scope.object.top - scope.object.bottom) / element.clientHeight);\n            } else {\n                console.warn('WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.');\n            }\n        };\n        this.momentum = function () {\n            if (!momentumOn)\n                return;\n            if (Math.abs(momentumLeft) < MEPS && Math.abs(momentumUp) < MEPS) {\n                momentumOn = false;\n                return;\n            }\n            momentumUp *= this.momentumDampingFactor;\n            momentumLeft *= this.momentumDampingFactor;\n            thetaDelta -= this.momentumScalingFactor * momentumLeft;\n            phiDelta -= this.momentumScalingFactor * momentumUp;\n        };\n        this.dollyIn = function (dollyScale) {\n            if (dollyScale === undefined) {\n                dollyScale = getZoomScale();\n            }\n            if (scope.object instanceof THREE.PerspectiveCamera) {\n                scale /= dollyScale;\n            } else if (scope.object instanceof THREE.OrthographicCamera) {\n                scope.object.zoom = Math.max(this.minZoom, Math.min(this.maxZoom, this.object.zoom * dollyScale));\n                scope.object.updateProjectionMatrix();\n                scope.dispatchEvent(changeEvent);\n            } else {\n                console.warn('WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.');\n            }\n        };\n        this.dollyOut = function (dollyScale) {\n            if (dollyScale === undefined) {\n                dollyScale = getZoomScale();\n            }\n            if (scope.object instanceof THREE.PerspectiveCamera) {\n                scale *= dollyScale;\n            } else if (scope.object instanceof THREE.OrthographicCamera) {\n                scope.object.zoom = Math.max(this.minZoom, Math.min(this.maxZoom, this.object.zoom / dollyScale));\n                scope.object.updateProjectionMatrix();\n                scope.dispatchEvent(changeEvent);\n            } else {\n                console.warn('WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.');\n            }\n        };\n        this.update = function (ignoreUpdate) {\n            var position = this.object.position;\n            offset.copy(position).sub(this.target);\n            offset.applyQuaternion(quat);\n            theta = Math.atan2(offset.x, offset.z);\n            phi = Math.atan2(Math.sqrt(offset.x * offset.x + offset.z * offset.z), offset.y);\n            if (this.autoRotate && state === STATE.NONE) {\n                this.rotateLeft(getAutoRotationAngle());\n            }\n            this.momentum();\n            theta += thetaDelta;\n            phi += phiDelta;\n            theta = Math.max(this.minAzimuthAngle, Math.min(this.maxAzimuthAngle, theta));\n            phi = Math.max(this.minPolarAngle, Math.min(this.maxPolarAngle, phi));\n            phi = Math.max(EPS, Math.min(Math.PI - EPS, phi));\n            var radius = offset.length() * scale;\n            radius = Math.max(this.minDistance, Math.min(this.maxDistance, radius));\n            this.target.add(pan);\n            offset.x = radius * Math.sin(phi) * Math.sin(theta);\n            offset.y = radius * Math.cos(phi);\n            offset.z = radius * Math.sin(phi) * Math.cos(theta);\n            offset.applyQuaternion(quatInverse);\n            position.copy(this.target).add(offset);\n            this.object.lookAt(this.target);\n            thetaDelta = 0;\n            phiDelta = 0;\n            scale = 1;\n            pan.set(0, 0, 0);\n            if (lastPosition.distanceToSquared(this.object.position) > EPS || 8 * (1 - lastQuaternion.dot(this.object.quaternion)) > EPS) {\n                if (ignoreUpdate !== true) {\n                    this.dispatchEvent(changeEvent);\n                }\n                lastPosition.copy(this.object.position);\n                lastQuaternion.copy(this.object.quaternion);\n            }\n        };\n        this.reset = function () {\n            state = STATE.NONE;\n            this.target.copy(this.target0);\n            this.object.position.copy(this.position0);\n            this.object.zoom = this.zoom0;\n            this.object.updateProjectionMatrix();\n            this.dispatchEvent(changeEvent);\n            this.update();\n        };\n        this.getPolarAngle = function () {\n            return phi;\n        };\n        this.getAzimuthalAngle = function () {\n            return theta;\n        };\n        function getAutoRotationAngle() {\n            return 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\n        }\n        function getZoomScale() {\n            return Math.pow(0.95, scope.zoomSpeed);\n        }\n        function onMouseDown(event) {\n            momentumOn = false;\n            momentumLeft = momentumUp = 0;\n            if (scope.enabled === false)\n                return;\n            event.preventDefault();\n            if (event.button === scope.mouseButtons.ORBIT) {\n                if (scope.noRotate === true)\n                    return;\n                state = STATE.ROTATE;\n                rotateStart.set(event.clientX, event.clientY);\n            } else if (event.button === scope.mouseButtons.ZOOM) {\n                if (scope.noZoom === true)\n                    return;\n                state = STATE.DOLLY;\n                dollyStart.set(event.clientX, event.clientY);\n            } else if (event.button === scope.mouseButtons.PAN) {\n                if (scope.noPan === true)\n                    return;\n                state = STATE.PAN;\n                panStart.set(event.clientX, event.clientY);\n            }\n            if (state !== STATE.NONE) {\n                document.addEventListener('mousemove', onMouseMove, false);\n                document.addEventListener('mouseup', onMouseUp, false);\n                scope.dispatchEvent(startEvent);\n            }\n            scope.update();\n        }\n        function onMouseMove(event) {\n            if (scope.enabled === false)\n                return;\n            event.preventDefault();\n            var element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n            if (state === STATE.ROTATE) {\n                if (scope.noRotate === true)\n                    return;\n                rotateEnd.set(event.clientX, event.clientY);\n                rotateDelta.subVectors(rotateEnd, rotateStart);\n                scope.rotateLeft(2 * Math.PI * rotateDelta.x / element.clientWidth * scope.rotateSpeed);\n                scope.rotateUp(2 * Math.PI * rotateDelta.y / element.clientHeight * scope.rotateSpeed);\n                rotateStart.copy(rotateEnd);\n                if (eventPrevious) {\n                    momentumLeft = event.clientX - eventPrevious.clientX;\n                    momentumUp = event.clientY - eventPrevious.clientY;\n                }\n                eventPrevious = event;\n            } else if (state === STATE.DOLLY) {\n                if (scope.noZoom === true)\n                    return;\n                dollyEnd.set(event.clientX, event.clientY);\n                dollyDelta.subVectors(dollyEnd, dollyStart);\n                if (dollyDelta.y > 0) {\n                    scope.dollyIn();\n                } else if (dollyDelta.y < 0) {\n                    scope.dollyOut();\n                }\n                dollyStart.copy(dollyEnd);\n            } else if (state === STATE.PAN) {\n                if (scope.noPan === true)\n                    return;\n                panEnd.set(event.clientX, event.clientY);\n                panDelta.subVectors(panEnd, panStart);\n                scope.pan(panDelta.x, panDelta.y);\n                panStart.copy(panEnd);\n            }\n            if (state !== STATE.NONE)\n                scope.update();\n        }\n        function onMouseUp() {\n            momentumOn = true;\n            eventPrevious = undefined;\n            if (scope.enabled === false)\n                return;\n            document.removeEventListener('mousemove', onMouseMove, false);\n            document.removeEventListener('mouseup', onMouseUp, false);\n            scope.dispatchEvent(endEvent);\n            state = STATE.NONE;\n        }\n        function onMouseWheel(event) {\n            if (scope.enabled === false || scope.noZoom === true || state !== STATE.NONE)\n                return;\n            event.preventDefault();\n            event.stopPropagation();\n            var delta = 0;\n            if (event.wheelDelta !== undefined) {\n                delta = event.wheelDelta;\n            } else if (event.detail !== undefined) {\n                delta = -event.detail;\n            }\n            if (delta > 0) {\n                scope.object.fov = scope.object.fov < scope.maxFov ? scope.object.fov + 1 : scope.maxFov;\n                scope.object.updateProjectionMatrix();\n            } else if (delta < 0) {\n                scope.object.fov = scope.object.fov > scope.minFov ? scope.object.fov - 1 : scope.minFov;\n                scope.object.updateProjectionMatrix();\n            }\n            scope.update();\n            scope.dispatchEvent(changeEvent);\n            scope.dispatchEvent(startEvent);\n            scope.dispatchEvent(endEvent);\n        }\n        function onKeyUp(event) {\n            switch (event.keyCode) {\n            case scope.keys.UP:\n                keyUp = false;\n                break;\n            case scope.keys.BOTTOM:\n                keyBottom = false;\n                break;\n            case scope.keys.LEFT:\n                keyLeft = false;\n                break;\n            case scope.keys.RIGHT:\n                keyRight = false;\n                break;\n            }\n        }\n        function onKeyDown(event) {\n            if (scope.enabled === false || scope.noKeys === true || scope.noRotate === true)\n                return;\n            switch (event.keyCode) {\n            case scope.keys.UP:\n                keyUp = true;\n                break;\n            case scope.keys.BOTTOM:\n                keyBottom = true;\n                break;\n            case scope.keys.LEFT:\n                keyLeft = true;\n                break;\n            case scope.keys.RIGHT:\n                keyRight = true;\n                break;\n            }\n            if (keyUp || keyBottom || keyLeft || keyRight) {\n                momentumOn = true;\n                if (keyUp)\n                    momentumUp = -scope.rotateSpeed * scope.momentumKeydownFactor;\n                if (keyBottom)\n                    momentumUp = scope.rotateSpeed * scope.momentumKeydownFactor;\n                if (keyLeft)\n                    momentumLeft = -scope.rotateSpeed * scope.momentumKeydownFactor;\n                if (keyRight)\n                    momentumLeft = scope.rotateSpeed * scope.momentumKeydownFactor;\n            }\n        }\n        function touchstart(event) {\n            momentumOn = false;\n            momentumLeft = momentumUp = 0;\n            if (scope.enabled === false)\n                return;\n            switch (event.touches.length) {\n            case 1:\n                if (scope.noRotate === true)\n                    return;\n                state = STATE.TOUCH_ROTATE;\n                rotateStart.set(event.touches[0].pageX, event.touches[0].pageY);\n                break;\n            case 2:\n                if (scope.noZoom === true)\n                    return;\n                state = STATE.TOUCH_DOLLY;\n                var dx = event.touches[0].pageX - event.touches[1].pageX;\n                var dy = event.touches[0].pageY - event.touches[1].pageY;\n                var distance = Math.sqrt(dx * dx + dy * dy);\n                dollyStart.set(0, distance);\n                break;\n            case 3:\n                if (scope.noPan === true)\n                    return;\n                state = STATE.TOUCH_PAN;\n                panStart.set(event.touches[0].pageX, event.touches[0].pageY);\n                break;\n            default:\n                state = STATE.NONE;\n            }\n            if (state !== STATE.NONE)\n                scope.dispatchEvent(startEvent);\n        }\n        function touchmove(event) {\n            if (scope.enabled === false)\n                return;\n            event.preventDefault();\n            event.stopPropagation();\n            var element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n            switch (event.touches.length) {\n            case 1:\n                if (scope.noRotate === true)\n                    return;\n                if (state !== STATE.TOUCH_ROTATE)\n                    return;\n                rotateEnd.set(event.touches[0].pageX, event.touches[0].pageY);\n                rotateDelta.subVectors(rotateEnd, rotateStart);\n                scope.rotateLeft(2 * Math.PI * rotateDelta.x / element.clientWidth * scope.rotateSpeed);\n                scope.rotateUp(2 * Math.PI * rotateDelta.y / element.clientHeight * scope.rotateSpeed);\n                rotateStart.copy(rotateEnd);\n                if (eventPrevious) {\n                    momentumLeft = event.touches[0].pageX - eventPrevious.pageX;\n                    momentumUp = event.touches[0].pageY - eventPrevious.pageY;\n                }\n                eventPrevious = {\n                    pageX: event.touches[0].pageX,\n                    pageY: event.touches[0].pageY\n                };\n                scope.update();\n                break;\n            case 2:\n                if (scope.noZoom === true)\n                    return;\n                if (state !== STATE.TOUCH_DOLLY)\n                    return;\n                var dx = event.touches[0].pageX - event.touches[1].pageX;\n                var dy = event.touches[0].pageY - event.touches[1].pageY;\n                var distance = Math.sqrt(dx * dx + dy * dy);\n                dollyEnd.set(0, distance);\n                dollyDelta.subVectors(dollyEnd, dollyStart);\n                if (dollyDelta.y < 0) {\n                    scope.object.fov = scope.object.fov < scope.maxFov ? scope.object.fov + 1 : scope.maxFov;\n                    scope.object.updateProjectionMatrix();\n                } else if (dollyDelta.y > 0) {\n                    scope.object.fov = scope.object.fov > scope.minFov ? scope.object.fov - 1 : scope.minFov;\n                    scope.object.updateProjectionMatrix();\n                }\n                dollyStart.copy(dollyEnd);\n                scope.update();\n                scope.dispatchEvent(changeEvent);\n                break;\n            case 3:\n                if (scope.noPan === true)\n                    return;\n                if (state !== STATE.TOUCH_PAN)\n                    return;\n                panEnd.set(event.touches[0].pageX, event.touches[0].pageY);\n                panDelta.subVectors(panEnd, panStart);\n                scope.pan(panDelta.x, panDelta.y);\n                panStart.copy(panEnd);\n                scope.update();\n                break;\n            default:\n                state = STATE.NONE;\n            }\n        }\n        function touchend() {\n            momentumOn = true;\n            eventPrevious = undefined;\n            if (scope.enabled === false)\n                return;\n            scope.dispatchEvent(endEvent);\n            state = STATE.NONE;\n        }\n        this.dispose = function () {\n            this.domElement.removeEventListener('mousedown', onMouseDown);\n            this.domElement.removeEventListener('mousewheel', onMouseWheel);\n            this.domElement.removeEventListener('DOMMouseScroll', onMouseWheel);\n            this.domElement.removeEventListener('touchstart', touchstart);\n            this.domElement.removeEventListener('touchend', touchend);\n            this.domElement.removeEventListener('touchmove', touchmove);\n            window.removeEventListener('keyup', onKeyUp);\n            window.removeEventListener('keydown', onKeyDown);\n        };\n        this.domElement.addEventListener('mousedown', onMouseDown, { passive: false });\n        this.domElement.addEventListener('mousewheel', onMouseWheel, { passive: false });\n        this.domElement.addEventListener('DOMMouseScroll', onMouseWheel, { passive: false });\n        this.domElement.addEventListener('touchstart', touchstart, { passive: false });\n        this.domElement.addEventListener('touchend', touchend, { passive: false });\n        this.domElement.addEventListener('touchmove', touchmove, { passive: false });\n        window.addEventListener('keyup', onKeyUp, { passive: false });\n        window.addEventListener('keydown', onKeyDown, { passive: false });\n        this.update();\n    }\n    ;\n    OrbitControls.prototype = Object.assign(Object.create(THREE.EventDispatcher.prototype), { constructor: OrbitControls });\n    return OrbitControls;\n});\ndefine('skylark-panolens/lib/controls/DeviceOrientationControls',['skylark-threejs'], function (THREE) {\n    'use strict';\n    function DeviceOrientationControls(camera, domElement) {\n        var scope = this;\n        var changeEvent = { type: 'change' };\n        var rotY = 0;\n        var rotX = 0;\n        var tempX = 0;\n        var tempY = 0;\n        this.camera = camera;\n        this.camera.rotation.reorder('YXZ');\n        this.domElement = domElement !== undefined ? domElement : document;\n        this.enabled = true;\n        this.deviceOrientation = {};\n        this.screenOrientation = 0;\n        this.alpha = 0;\n        this.alphaOffsetAngle = 0;\n        var onDeviceOrientationChangeEvent = function (event) {\n            scope.deviceOrientation = event;\n        };\n        var onScreenOrientationChangeEvent = function () {\n            scope.screenOrientation = window.orientation || 0;\n        };\n        var onTouchStartEvent = function (event) {\n            event.preventDefault();\n            event.stopPropagation();\n            tempX = event.touches[0].pageX;\n            tempY = event.touches[0].pageY;\n        };\n        var onTouchMoveEvent = function (event) {\n            event.preventDefault();\n            event.stopPropagation();\n            rotY += THREE.Math.degToRad((event.touches[0].pageX - tempX) / 4);\n            rotX += THREE.Math.degToRad((tempY - event.touches[0].pageY) / 4);\n            scope.updateAlphaOffsetAngle(rotY);\n            tempX = event.touches[0].pageX;\n            tempY = event.touches[0].pageY;\n        };\n        var setCameraQuaternion = function (quaternion, alpha, beta, gamma, orient) {\n            var zee = new THREE.Vector3(0, 0, 1);\n            var euler = new THREE.Euler();\n            var q0 = new THREE.Quaternion();\n            var q1 = new THREE.Quaternion(-Math.sqrt(0.5), 0, 0, Math.sqrt(0.5));\n            var vectorFingerY;\n            var fingerQY = new THREE.Quaternion();\n            var fingerQX = new THREE.Quaternion();\n            if (scope.screenOrientation == 0) {\n                vectorFingerY = new THREE.Vector3(1, 0, 0);\n                fingerQY.setFromAxisAngle(vectorFingerY, -rotX);\n            } else if (scope.screenOrientation == 180) {\n                vectorFingerY = new THREE.Vector3(1, 0, 0);\n                fingerQY.setFromAxisAngle(vectorFingerY, rotX);\n            } else if (scope.screenOrientation == 90) {\n                vectorFingerY = new THREE.Vector3(0, 1, 0);\n                fingerQY.setFromAxisAngle(vectorFingerY, rotX);\n            } else if (scope.screenOrientation == -90) {\n                vectorFingerY = new THREE.Vector3(0, 1, 0);\n                fingerQY.setFromAxisAngle(vectorFingerY, -rotX);\n            }\n            q1.multiply(fingerQY);\n            q1.multiply(fingerQX);\n            euler.set(beta, alpha, -gamma, 'YXZ');\n            quaternion.setFromEuler(euler);\n            quaternion.multiply(q1);\n            quaternion.multiply(q0.setFromAxisAngle(zee, -orient));\n        };\n        this.connect = function () {\n            onScreenOrientationChangeEvent();\n            window.addEventListener('orientationchange', onScreenOrientationChangeEvent, { passive: true });\n            window.addEventListener('deviceorientation', onDeviceOrientationChangeEvent, { passive: true });\n            window.addEventListener('deviceorientation', this.update.bind(this), { passive: true });\n            scope.domElement.addEventListener('touchstart', onTouchStartEvent, { passive: false });\n            scope.domElement.addEventListener('touchmove', onTouchMoveEvent, { passive: false });\n            scope.enabled = true;\n        };\n        this.disconnect = function () {\n            window.removeEventListener('orientationchange', onScreenOrientationChangeEvent, false);\n            window.removeEventListener('deviceorientation', onDeviceOrientationChangeEvent, false);\n            window.removeEventListener('deviceorientation', this.update.bind(this), false);\n            scope.domElement.removeEventListener('touchstart', onTouchStartEvent, false);\n            scope.domElement.removeEventListener('touchmove', onTouchMoveEvent, false);\n            scope.enabled = false;\n        };\n        this.update = function (ignoreUpdate) {\n            if (scope.enabled === false)\n                return;\n            var alpha = scope.deviceOrientation.alpha ? THREE.Math.degToRad(scope.deviceOrientation.alpha) + scope.alphaOffsetAngle : 0;\n            var beta = scope.deviceOrientation.beta ? THREE.Math.degToRad(scope.deviceOrientation.beta) : 0;\n            var gamma = scope.deviceOrientation.gamma ? THREE.Math.degToRad(scope.deviceOrientation.gamma) : 0;\n            var orient = scope.screenOrientation ? THREE.Math.degToRad(scope.screenOrientation) : 0;\n            setCameraQuaternion(scope.camera.quaternion, alpha, beta, gamma, orient);\n            scope.alpha = alpha;\n            if (ignoreUpdate !== true) {\n                scope.dispatchEvent(changeEvent);\n            }\n        };\n        this.updateAlphaOffsetAngle = function (angle) {\n            this.alphaOffsetAngle = angle;\n            this.update();\n        };\n        this.dispose = function () {\n            this.disconnect();\n        };\n        this.connect();\n    }\n    ;\n    DeviceOrientationControls.prototype = Object.assign(Object.create(THREE.EventDispatcher.prototype), { constructor: DeviceOrientationControls });\n    return DeviceOrientationControls;\n});\ndefine('skylark-panolens/lib/effects/CardboardEffect',['skylark-threejs'], function (THREE) {\n    'use strict';\n    function CardboardEffect(renderer) {\n        var _camera = new THREE.OrthographicCamera(-1, 1, 1, -1, 0, 1);\n        var _scene = new THREE.Scene();\n        var _stereo = new THREE.StereoCamera();\n        _stereo.aspect = 0.5;\n        var _params = {\n            minFilter: THREE.LinearFilter,\n            magFilter: THREE.NearestFilter,\n            format: THREE.RGBAFormat\n        };\n        var _renderTarget = new THREE.WebGLRenderTarget(512, 512, _params);\n        _renderTarget.scissorTest = true;\n        _renderTarget.texture.generateMipmaps = false;\n        var distortion = new THREE.Vector2(0.441, 0.156);\n        var geometry = new THREE.PlaneBufferGeometry(1, 1, 10, 20).removeAttribute('normal').toNonIndexed();\n        var positions = geometry.attributes.position.array;\n        var uvs = geometry.attributes.uv.array;\n        geometry.attributes.position.count *= 2;\n        geometry.attributes.uv.count *= 2;\n        var positions2 = new Float32Array(positions.length * 2);\n        positions2.set(positions);\n        positions2.set(positions, positions.length);\n        var uvs2 = new Float32Array(uvs.length * 2);\n        uvs2.set(uvs);\n        uvs2.set(uvs, uvs.length);\n        var vector = new THREE.Vector2();\n        var length = positions.length / 3;\n        for (var i = 0, l = positions2.length / 3; i < l; i++) {\n            vector.x = positions2[i * 3 + 0];\n            vector.y = positions2[i * 3 + 1];\n            var dot = vector.dot(vector);\n            var scalar = 1.5 + (distortion.x + distortion.y * dot) * dot;\n            var offset = i < length ? 0 : 1;\n            positions2[i * 3 + 0] = vector.x / scalar * 1.5 - 0.5 + offset;\n            positions2[i * 3 + 1] = vector.y / scalar * 3;\n            uvs2[i * 2] = (uvs2[i * 2] + offset) * 0.5;\n        }\n        geometry.attributes.position.array = positions2;\n        geometry.attributes.uv.array = uvs2;\n        var material = new THREE.MeshBasicMaterial({ map: _renderTarget.texture });\n        var mesh = new THREE.Mesh(geometry, material);\n        _scene.add(mesh);\n        this.setSize = function (width, height) {\n            renderer.setSize(width, height);\n            var pixelRatio = renderer.getPixelRatio();\n            _renderTarget.setSize(width * pixelRatio, height * pixelRatio);\n        };\n        this.render = function (scene, camera) {\n            scene.updateMatrixWorld();\n            if (camera.parent === null)\n                camera.updateMatrixWorld();\n            _stereo.update(camera);\n            var width = _renderTarget.width / 2;\n            var height = _renderTarget.height;\n            if (renderer.autoClear)\n                renderer.clear();\n            _renderTarget.scissor.set(0, 0, width, height);\n            _renderTarget.viewport.set(0, 0, width, height);\n            renderer.setRenderTarget(_renderTarget);\n            renderer.render(scene, _stereo.cameraL);\n            renderer.clearDepth();\n            _renderTarget.scissor.set(width, 0, width, height);\n            _renderTarget.viewport.set(width, 0, width, height);\n            renderer.setRenderTarget(_renderTarget);\n            renderer.render(scene, _stereo.cameraR);\n            renderer.clearDepth();\n            renderer.setRenderTarget(null);\n            renderer.render(_scene, _camera);\n        };\n    }\n    ;\n    return CardboardEffect;\n});\ndefine('skylark-panolens/lib/effects/StereoEffect',['skylark-threejs'], function (THREE) {\n    'use strict';\n    const StereoEffect = function (renderer) {\n        var _stereo = new THREE.StereoCamera();\n        _stereo.aspect = 0.5;\n        var size = new THREE.Vector2();\n        this.setEyeSeparation = function (eyeSep) {\n            _stereo.eyeSep = eyeSep;\n        };\n        this.setSize = function (width, height) {\n            renderer.setSize(width, height);\n        };\n        this.render = function (scene, camera) {\n            scene.updateMatrixWorld();\n            if (camera.parent === null)\n                camera.updateMatrixWorld();\n            _stereo.update(camera);\n            renderer.getSize(size);\n            if (renderer.autoClear)\n                renderer.clear();\n            renderer.setScissorTest(true);\n            renderer.setScissor(0, 0, size.width / 2, size.height);\n            renderer.setViewport(0, 0, size.width / 2, size.height);\n            renderer.render(scene, _stereo.cameraL);\n            renderer.setScissor(size.width / 2, 0, size.width / 2, size.height);\n            renderer.setViewport(size.width / 2, 0, size.width / 2, size.height);\n            renderer.render(scene, _stereo.cameraR);\n            renderer.setScissorTest(false);\n        };\n    };\n    return StereoEffect;\n});\ndefine('skylark-panolens/widget/Widget',[\n    '../Constants',\n    '../DataImage',\n    'skylark-threejs'\n], function (Constants, DataImage, THREE) {\n    'use strict';\n    function Widget(container) {\n        if (!container) {\n            console.warn('PANOLENS.Widget: No container specified');\n        }\n        THREE.EventDispatcher.call(this);\n        this.DEFAULT_TRANSITION = 'all 0.27s ease';\n        this.TOUCH_ENABLED = !!('ontouchstart' in window || window.DocumentTouch && document instanceof DocumentTouch);\n        this.PREVENT_EVENT_HANDLER = function (event) {\n            event.preventDefault();\n            event.stopPropagation();\n        };\n        this.container = container;\n        this.barElement = null;\n        this.fullscreenElement = null;\n        this.videoElement = null;\n        this.settingElement = null;\n        this.mainMenu = null;\n        this.activeMainItem = null;\n        this.activeSubMenu = null;\n        this.mask = null;\n    }\n    Widget.prototype = Object.assign(Object.create(THREE.EventDispatcher.prototype), {\n        constructor: Widget,\n        addControlBar: function () {\n            if (!this.container) {\n                console.warn('Widget container not set');\n                return;\n            }\n            var scope = this, bar, styleTranslate, styleOpacity, gradientStyle;\n            gradientStyle = 'linear-gradient(bottom, rgba(0,0,0,0.2), rgba(0,0,0,0))';\n            bar = document.createElement('div');\n            bar.style.width = '100%';\n            bar.style.height = '44px';\n            bar.style.float = 'left';\n            bar.style.transform = bar.style.webkitTransform = bar.style.msTransform = 'translateY(-100%)';\n            bar.style.background = '-webkit-' + gradientStyle;\n            bar.style.background = '-moz-' + gradientStyle;\n            bar.style.background = '-o-' + gradientStyle;\n            bar.style.background = '-ms-' + gradientStyle;\n            bar.style.background = gradientStyle;\n            bar.style.transition = this.DEFAULT_TRANSITION;\n            bar.style.pointerEvents = 'none';\n            bar.isHidden = false;\n            bar.toggle = function () {\n                bar.isHidden = !bar.isHidden;\n                styleTranslate = bar.isHidden ? 'translateY(0)' : 'translateY(-100%)';\n                styleOpacity = bar.isHidden ? 0 : 1;\n                bar.style.transform = bar.style.webkitTransform = bar.style.msTransform = styleTranslate;\n                bar.style.opacity = styleOpacity;\n            };\n            var menu = this.createDefaultMenu();\n            this.mainMenu = this.createMainMenu(menu);\n            bar.appendChild(this.mainMenu);\n            var mask = this.createMask();\n            this.mask = mask;\n            this.container.appendChild(mask);\n            bar.dispose = function () {\n                if (scope.fullscreenElement) {\n                    bar.removeChild(scope.fullscreenElement);\n                    scope.fullscreenElement.dispose();\n                    scope.fullscreenElement = null;\n                }\n                if (scope.settingElement) {\n                    bar.removeChild(scope.settingElement);\n                    scope.settingElement.dispose();\n                    scope.settingElement = null;\n                }\n                if (scope.videoElement) {\n                    bar.removeChild(scope.videoElement);\n                    scope.videoElement.dispose();\n                    scope.videoElement = null;\n                }\n            };\n            this.container.appendChild(bar);\n            this.mask.addEventListener('mousemove', this.PREVENT_EVENT_HANDLER, true);\n            this.mask.addEventListener('mouseup', this.PREVENT_EVENT_HANDLER, true);\n            this.mask.addEventListener('mousedown', this.PREVENT_EVENT_HANDLER, true);\n            this.mask.addEventListener(scope.TOUCH_ENABLED ? 'touchend' : 'click', function (event) {\n                event.preventDefault();\n                event.stopPropagation();\n                scope.mask.hide();\n                scope.settingElement.deactivate();\n            }, false);\n            this.addEventListener('control-bar-toggle', bar.toggle);\n            this.barElement = bar;\n        },\n        createDefaultMenu: function () {\n            var scope = this, handler;\n            handler = function (method, data) {\n                return function () {\n                    scope.dispatchEvent({\n                        type: 'panolens-viewer-handler',\n                        method: method,\n                        data: data\n                    });\n                };\n            };\n            return [\n                {\n                    title: 'Control',\n                    subMenu: [\n                        {\n                            title: this.TOUCH_ENABLED ? 'Touch' : 'Mouse',\n                            handler: handler('enableControl', Constants.CONTROLS.ORBIT)\n                        },\n                        {\n                            title: 'Sensor',\n                            handler: handler('enableControl', Constants.CONTROLS.DEVICEORIENTATION)\n                        }\n                    ]\n                },\n                {\n                    title: 'Mode',\n                    subMenu: [\n                        {\n                            title: 'Normal',\n                            handler: handler('disableEffect')\n                        },\n                        {\n                            title: 'Cardboard',\n                            handler: handler('enableEffect', Constants.MODES.CARDBOARD)\n                        },\n                        {\n                            title: 'Stereoscopic',\n                            handler: handler('enableEffect', Constants.MODES.STEREO)\n                        }\n                    ]\n                }\n            ];\n        },\n        addControlButton: function (name) {\n            let element;\n            switch (name) {\n            case 'fullscreen':\n                element = this.createFullscreenButton();\n                this.fullscreenElement = element;\n                break;\n            case 'setting':\n                element = this.createSettingButton();\n                this.settingElement = element;\n                break;\n            case 'video':\n                element = this.createVideoControl();\n                this.videoElement = element;\n                break;\n            default:\n                return;\n            }\n            if (!element) {\n                return;\n            }\n            this.barElement.appendChild(element);\n        },\n        createMask: function () {\n            const element = document.createElement('div');\n            element.style.position = 'absolute';\n            element.style.top = 0;\n            element.style.left = 0;\n            element.style.width = '100%';\n            element.style.height = '100%';\n            element.style.background = 'transparent';\n            element.style.display = 'none';\n            element.show = function () {\n                this.style.display = 'block';\n            };\n            element.hide = function () {\n                this.style.display = 'none';\n            };\n            return element;\n        },\n        createSettingButton: function () {\n            let scope = this, item;\n            function onTap(event) {\n                event.preventDefault();\n                event.stopPropagation();\n                scope.mainMenu.toggle();\n                if (this.activated) {\n                    this.deactivate();\n                } else {\n                    this.activate();\n                }\n            }\n            item = this.createCustomItem({\n                style: {\n                    backgroundImage: 'url(\"' + DataImage.Setting + '\")',\n                    webkitTransition: this.DEFAULT_TRANSITION,\n                    transition: this.DEFAULT_TRANSITION\n                },\n                onTap: onTap\n            });\n            item.activate = function () {\n                this.style.transform = 'rotate3d(0,0,1,90deg)';\n                this.activated = true;\n                scope.mask.show();\n            };\n            item.deactivate = function () {\n                this.style.transform = 'rotate3d(0,0,0,0)';\n                this.activated = false;\n                scope.mask.hide();\n                if (scope.mainMenu && scope.mainMenu.visible) {\n                    scope.mainMenu.hide();\n                }\n                if (scope.activeSubMenu && scope.activeSubMenu.visible) {\n                    scope.activeSubMenu.hide();\n                }\n                if (scope.mainMenu && scope.mainMenu._width) {\n                    scope.mainMenu.changeSize(scope.mainMenu._width);\n                    scope.mainMenu.unslideAll();\n                }\n            };\n            item.activated = false;\n            return item;\n        },\n        createFullscreenButton: function () {\n            let scope = this, item, isFullscreen = false, tapSkipped = true, stylesheetId;\n            const {container} = this;\n            stylesheetId = 'panolens-style-addon';\n            if (!document.fullscreenEnabled && !document.webkitFullscreenEnabled && !document.mozFullScreenEnabled && !document.msFullscreenEnabled) {\n                return;\n            }\n            function onTap(event) {\n                event.preventDefault();\n                event.stopPropagation();\n                tapSkipped = false;\n                if (!isFullscreen) {\n                    if (container.requestFullscreen) {\n                        container.requestFullscreen();\n                    }\n                    if (container.msRequestFullscreen) {\n                        container.msRequestFullscreen();\n                    }\n                    if (container.mozRequestFullScreen) {\n                        container.mozRequestFullScreen();\n                    }\n                    if (container.webkitRequestFullscreen) {\n                        container.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);\n                    }\n                    isFullscreen = true;\n                } else {\n                    if (document.exitFullscreen) {\n                        document.exitFullscreen();\n                    }\n                    if (document.msExitFullscreen) {\n                        document.msExitFullscreen();\n                    }\n                    if (document.mozCancelFullScreen) {\n                        document.mozCancelFullScreen();\n                    }\n                    if (document.webkitExitFullscreen) {\n                        document.webkitExitFullscreen();\n                    }\n                    isFullscreen = false;\n                }\n                this.style.backgroundImage = isFullscreen ? 'url(\"' + DataImage.FullscreenLeave + '\")' : 'url(\"' + DataImage.FullscreenEnter + '\")';\n            }\n            function onFullScreenChange() {\n                if (tapSkipped) {\n                    isFullscreen = !isFullscreen;\n                    item.style.backgroundImage = isFullscreen ? 'url(\"' + DataImage.FullscreenLeave + '\")' : 'url(\"' + DataImage.FullscreenEnter + '\")';\n                }\n                scope.dispatchEvent({\n                    type: 'panolens-viewer-handler',\n                    method: 'onWindowResize'\n                });\n                tapSkipped = true;\n            }\n            document.addEventListener('fullscreenchange', onFullScreenChange, false);\n            document.addEventListener('webkitfullscreenchange', onFullScreenChange, false);\n            document.addEventListener('mozfullscreenchange', onFullScreenChange, false);\n            document.addEventListener('MSFullscreenChange', onFullScreenChange, false);\n            item = this.createCustomItem({\n                style: { backgroundImage: 'url(\"' + DataImage.FullscreenEnter + '\")' },\n                onTap: onTap\n            });\n            if (!document.querySelector(stylesheetId)) {\n                const sheet = document.createElement('style');\n                sheet.id = stylesheetId;\n                sheet.innerHTML = ':-webkit-full-screen { width: 100% !important; height: 100% !important }';\n                document.body.appendChild(sheet);\n            }\n            return item;\n        },\n        createVideoControl: function () {\n            const item = document.createElement('span');\n            item.style.display = 'none';\n            item.show = function () {\n                item.style.display = '';\n            };\n            item.hide = function () {\n                item.style.display = 'none';\n                item.controlButton.paused = true;\n                item.controlButton.update();\n            };\n            item.controlButton = this.createVideoControlButton();\n            item.seekBar = this.createVideoControlSeekbar();\n            item.appendChild(item.controlButton);\n            item.appendChild(item.seekBar);\n            item.dispose = function () {\n                item.removeChild(item.controlButton);\n                item.removeChild(item.seekBar);\n                item.controlButton.dispose();\n                item.controlButton = null;\n                item.seekBar.dispose();\n                item.seekBar = null;\n            };\n            this.addEventListener('video-control-show', item.show);\n            this.addEventListener('video-control-hide', item.hide);\n            return item;\n        },\n        createVideoControlButton: function () {\n            const scope = this;\n            function onTap(event) {\n                event.preventDefault();\n                event.stopPropagation();\n                scope.dispatchEvent({\n                    type: 'panolens-viewer-handler',\n                    method: 'toggleVideoPlay',\n                    data: !this.paused\n                });\n                this.paused = !this.paused;\n                item.update();\n            }\n            ;\n            const item = this.createCustomItem({\n                style: {\n                    float: 'left',\n                    backgroundImage: 'url(\"' + DataImage.VideoPlay + '\")'\n                },\n                onTap: onTap\n            });\n            item.paused = true;\n            item.update = function (paused) {\n                this.paused = paused !== undefined ? paused : this.paused;\n                this.style.backgroundImage = 'url(\"' + (this.paused ? DataImage.VideoPlay : DataImage.VideoPause) + '\")';\n            };\n            return item;\n        },\n        createVideoControlSeekbar: function () {\n            let scope = this, item, progressElement, progressElementControl, isDragging = false, mouseX, percentageNow, percentageNext;\n            progressElement = document.createElement('div');\n            progressElement.style.width = '0%';\n            progressElement.style.height = '100%';\n            progressElement.style.backgroundColor = '#fff';\n            progressElementControl = document.createElement('div');\n            progressElementControl.style.float = 'right';\n            progressElementControl.style.width = '14px';\n            progressElementControl.style.height = '14px';\n            progressElementControl.style.transform = 'translate(7px, -5px)';\n            progressElementControl.style.borderRadius = '50%';\n            progressElementControl.style.backgroundColor = '#ddd';\n            progressElementControl.addEventListener('mousedown', onMouseDown, { passive: true });\n            progressElementControl.addEventListener('touchstart', onMouseDown, { passive: true });\n            function onMouseDown(event) {\n                event.stopPropagation();\n                isDragging = true;\n                mouseX = event.clientX || event.changedTouches && event.changedTouches[0].clientX;\n                percentageNow = parseInt(progressElement.style.width) / 100;\n                addControlListeners();\n            }\n            function onVideoControlDrag(event) {\n                if (isDragging) {\n                    const clientX = event.clientX || event.changedTouches && event.changedTouches[0].clientX;\n                    percentageNext = (clientX - mouseX) / item.clientWidth;\n                    percentageNext = percentageNow + percentageNext;\n                    percentageNext = percentageNext > 1 ? 1 : percentageNext < 0 ? 0 : percentageNext;\n                    item.setProgress(percentageNext);\n                    scope.dispatchEvent({\n                        type: 'panolens-viewer-handler',\n                        method: 'setVideoCurrentTime',\n                        data: percentageNext\n                    });\n                }\n            }\n            function onVideoControlStop(event) {\n                event.stopPropagation();\n                isDragging = false;\n                removeControlListeners();\n            }\n            function addControlListeners() {\n                scope.container.addEventListener('mousemove', onVideoControlDrag, { passive: true });\n                scope.container.addEventListener('mouseup', onVideoControlStop, { passive: true });\n                scope.container.addEventListener('touchmove', onVideoControlDrag, { passive: true });\n                scope.container.addEventListener('touchend', onVideoControlStop, { passive: true });\n            }\n            function removeControlListeners() {\n                scope.container.removeEventListener('mousemove', onVideoControlDrag, false);\n                scope.container.removeEventListener('mouseup', onVideoControlStop, false);\n                scope.container.removeEventListener('touchmove', onVideoControlDrag, false);\n                scope.container.removeEventListener('touchend', onVideoControlStop, false);\n            }\n            function onTap(event) {\n                event.preventDefault();\n                event.stopPropagation();\n                if (event.target === progressElementControl) {\n                    return;\n                }\n                const percentage = event.changedTouches && event.changedTouches.length > 0 ? (event.changedTouches[0].pageX - event.target.getBoundingClientRect().left) / this.clientWidth : event.offsetX / this.clientWidth;\n                scope.dispatchEvent({\n                    type: 'panolens-viewer-handler',\n                    method: 'setVideoCurrentTime',\n                    data: percentage\n                });\n                item.setProgress(event.offsetX / this.clientWidth);\n            }\n            ;\n            function onDispose() {\n                removeControlListeners();\n                progressElement = null;\n                progressElementControl = null;\n            }\n            progressElement.appendChild(progressElementControl);\n            item = this.createCustomItem({\n                style: {\n                    float: 'left',\n                    width: '30%',\n                    height: '4px',\n                    marginTop: '20px',\n                    backgroundColor: 'rgba(188,188,188,0.8)'\n                },\n                onTap: onTap,\n                onDispose: onDispose\n            });\n            item.appendChild(progressElement);\n            item.setProgress = function (percentage) {\n                progressElement.style.width = percentage * 100 + '%';\n            };\n            this.addEventListener('video-update', function (event) {\n                item.setProgress(event.percentage);\n            });\n            item.progressElement = progressElement;\n            item.progressElementControl = progressElementControl;\n            return item;\n        },\n        createMenuItem: function (title) {\n            const scope = this;\n            const item = document.createElement('a');\n            item.textContent = title;\n            item.style.display = 'block';\n            item.style.padding = '10px';\n            item.style.textDecoration = 'none';\n            item.style.cursor = 'pointer';\n            item.style.pointerEvents = 'auto';\n            item.style.transition = this.DEFAULT_TRANSITION;\n            item.slide = function (right) {\n                this.style.transform = 'translateX(' + (right ? '' : '-') + '100%)';\n            };\n            item.unslide = function () {\n                this.style.transform = 'translateX(0)';\n            };\n            item.setIcon = function (url) {\n                if (this.icon) {\n                    this.icon.style.backgroundImage = 'url(' + url + ')';\n                }\n            };\n            item.setSelectionTitle = function (title) {\n                if (this.selection) {\n                    this.selection.textContent = title;\n                }\n            };\n            item.addSelection = function (name) {\n                const selection = document.createElement('span');\n                selection.style.fontSize = '13px';\n                selection.style.fontWeight = '300';\n                selection.style.float = 'right';\n                this.selection = selection;\n                this.setSelectionTitle(name);\n                this.appendChild(selection);\n                return this;\n            };\n            item.addIcon = function (url = DataImage.ChevronRight, left = false, flip = false) {\n                const element = document.createElement('span');\n                element.style.float = left ? 'left' : 'right';\n                element.style.width = '17px';\n                element.style.height = '17px';\n                element.style['margin' + (left ? 'Right' : 'Left')] = '12px';\n                element.style.backgroundSize = 'cover';\n                if (flip) {\n                    element.style.transform = 'rotateZ(180deg)';\n                }\n                this.icon = element;\n                this.setIcon(url);\n                this.appendChild(element);\n                return this;\n            };\n            item.addSubMenu = function (title, items) {\n                this.subMenu = scope.createSubMenu(title, items);\n                return this;\n            };\n            item.addEventListener('mouseenter', function () {\n                this.style.backgroundColor = '#e0e0e0';\n            }, false);\n            item.addEventListener('mouseleave', function () {\n                this.style.backgroundColor = '#fafafa';\n            }, false);\n            return item;\n        },\n        createMenuItemHeader: function (title) {\n            const header = this.createMenuItem(title);\n            header.style.borderBottom = '1px solid #333';\n            header.style.paddingBottom = '15px';\n            return header;\n        },\n        createMainMenu: function (menus) {\n            let scope = this, menu = this.createMenu();\n            menu._width = 200;\n            menu.changeSize(menu._width);\n            function onTap(event) {\n                event.preventDefault();\n                event.stopPropagation();\n                let mainMenu = scope.mainMenu, subMenu = this.subMenu;\n                function onNextTick() {\n                    mainMenu.changeSize(subMenu.clientWidth);\n                    subMenu.show();\n                    subMenu.unslideAll();\n                }\n                mainMenu.hide();\n                mainMenu.slideAll();\n                mainMenu.parentElement.appendChild(subMenu);\n                scope.activeMainItem = this;\n                scope.activeSubMenu = subMenu;\n                window.requestAnimationFrame(onNextTick);\n            }\n            ;\n            for (var i = 0; i < menus.length; i++) {\n                var item = menu.addItem(menus[i].title);\n                item.style.paddingLeft = '20px';\n                item.addIcon().addEventListener(scope.TOUCH_ENABLED ? 'touchend' : 'click', onTap, false);\n                if (menus[i].subMenu && menus[i].subMenu.length > 0) {\n                    var title = menus[i].subMenu[0].title;\n                    item.addSelection(title).addSubMenu(menus[i].title, menus[i].subMenu);\n                }\n            }\n            return menu;\n        },\n        createSubMenu: function (title, items) {\n            let scope = this, menu, subMenu = this.createMenu();\n            subMenu.items = items;\n            subMenu.activeItem = null;\n            function onTap(event) {\n                event.preventDefault();\n                event.stopPropagation();\n                menu = scope.mainMenu;\n                menu.changeSize(menu._width);\n                menu.unslideAll();\n                menu.show();\n                subMenu.slideAll(true);\n                subMenu.hide();\n                if (this.type !== 'header') {\n                    subMenu.setActiveItem(this);\n                    scope.activeMainItem.setSelectionTitle(this.textContent);\n                    if (this.handler) {\n                        this.handler();\n                    }\n                }\n            }\n            subMenu.addHeader(title).addIcon(undefined, true, true).addEventListener(scope.TOUCH_ENABLED ? 'touchend' : 'click', onTap, false);\n            for (let i = 0; i < items.length; i++) {\n                const item = subMenu.addItem(items[i].title);\n                item.style.fontWeight = 300;\n                item.handler = items[i].handler;\n                item.addIcon(' ', true);\n                item.addEventListener(scope.TOUCH_ENABLED ? 'touchend' : 'click', onTap, false);\n                if (!subMenu.activeItem) {\n                    subMenu.setActiveItem(item);\n                }\n            }\n            subMenu.slideAll(true);\n            return subMenu;\n        },\n        createMenu: function () {\n            const scope = this;\n            const menu = document.createElement('span');\n            const style = menu.style;\n            style.padding = '5px 0';\n            style.position = 'fixed';\n            style.bottom = '100%';\n            style.right = '14px';\n            style.backgroundColor = '#fafafa';\n            style.fontFamily = 'Helvetica Neue';\n            style.fontSize = '14px';\n            style.visibility = 'hidden';\n            style.opacity = 0;\n            style.boxShadow = '0 0 12pt rgba(0,0,0,0.25)';\n            style.borderRadius = '2px';\n            style.overflow = 'hidden';\n            style.willChange = 'width, height, opacity';\n            style.pointerEvents = 'auto';\n            style.transition = this.DEFAULT_TRANSITION;\n            menu.visible = false;\n            menu.changeSize = function (width, height) {\n                if (width) {\n                    this.style.width = width + 'px';\n                }\n                if (height) {\n                    this.style.height = height + 'px';\n                }\n            };\n            menu.show = function () {\n                this.style.opacity = 1;\n                this.style.visibility = 'visible';\n                this.visible = true;\n            };\n            menu.hide = function () {\n                this.style.opacity = 0;\n                this.style.visibility = 'hidden';\n                this.visible = false;\n            };\n            menu.toggle = function () {\n                if (this.visible) {\n                    this.hide();\n                } else {\n                    this.show();\n                }\n            };\n            menu.slideAll = function (right) {\n                for (let i = 0; i < menu.children.length; i++) {\n                    if (menu.children[i].slide) {\n                        menu.children[i].slide(right);\n                    }\n                }\n            };\n            menu.unslideAll = function () {\n                for (let i = 0; i < menu.children.length; i++) {\n                    if (menu.children[i].unslide) {\n                        menu.children[i].unslide();\n                    }\n                }\n            };\n            menu.addHeader = function (title) {\n                const header = scope.createMenuItemHeader(title);\n                header.type = 'header';\n                this.appendChild(header);\n                return header;\n            };\n            menu.addItem = function (title) {\n                const item = scope.createMenuItem(title);\n                item.type = 'item';\n                this.appendChild(item);\n                return item;\n            };\n            menu.setActiveItem = function (item) {\n                if (this.activeItem) {\n                    this.activeItem.setIcon(' ');\n                }\n                item.setIcon(DataImage.Check);\n                this.activeItem = item;\n            };\n            menu.addEventListener('mousemove', this.PREVENT_EVENT_HANDLER, true);\n            menu.addEventListener('mouseup', this.PREVENT_EVENT_HANDLER, true);\n            menu.addEventListener('mousedown', this.PREVENT_EVENT_HANDLER, true);\n            return menu;\n        },\n        createCustomItem: function (options = {}) {\n            const scope = this;\n            const item = options.element || document.createElement('span');\n            const {onDispose} = options;\n            item.style.cursor = 'pointer';\n            item.style.float = 'right';\n            item.style.width = '44px';\n            item.style.height = '100%';\n            item.style.backgroundSize = '60%';\n            item.style.backgroundRepeat = 'no-repeat';\n            item.style.backgroundPosition = 'center';\n            item.style.webkitUserSelect = item.style.MozUserSelect = item.style.userSelect = 'none';\n            item.style.position = 'relative';\n            item.style.pointerEvents = 'auto';\n            item.addEventListener(scope.TOUCH_ENABLED ? 'touchstart' : 'mouseenter', function () {\n                item.style.filter = item.style.webkitFilter = 'drop-shadow(0 0 5px rgba(255,255,255,1))';\n            }, { passive: true });\n            item.addEventListener(scope.TOUCH_ENABLED ? 'touchend' : 'mouseleave', function () {\n                item.style.filter = item.style.webkitFilter = '';\n            }, { passive: true });\n            this.mergeStyleOptions(item, options.style);\n            if (options.onTap) {\n                item.addEventListener(scope.TOUCH_ENABLED ? 'touchend' : 'click', options.onTap, false);\n            }\n            item.dispose = function () {\n                item.removeEventListener(scope.TOUCH_ENABLED ? 'touchend' : 'click', options.onTap, false);\n                if (onDispose) {\n                    options.onDispose();\n                }\n            };\n            return item;\n        },\n        mergeStyleOptions: function (element, options = {}) {\n            for (let property in options) {\n                if (options.hasOwnProperty(property)) {\n                    element.style[property] = options[property];\n                }\n            }\n            return element;\n        },\n        dispose: function () {\n            if (this.barElement) {\n                this.container.removeChild(this.barElement);\n                this.barElement.dispose();\n                this.barElement = null;\n            }\n        }\n    });\n    return Widget;\n});\ndefine('skylark-panolens/interface/Reticle',['skylark-threejs'], function (THREE) {\n    'use strict';\n    function Reticle(color = 16777215, autoSelect = true, dwellTime = 1500) {\n        this.dpr = window.devicePixelRatio;\n        const {canvas, context} = this.createCanvas();\n        const material = new THREE.SpriteMaterial({\n            color,\n            map: this.createCanvasTexture(canvas)\n        });\n        THREE.Sprite.call(this, material);\n        this.canvasWidth = canvas.width;\n        this.canvasHeight = canvas.height;\n        this.context = context;\n        this.color = color instanceof THREE.Color ? color : new THREE.Color(color);\n        this.autoSelect = autoSelect;\n        this.dwellTime = dwellTime;\n        this.rippleDuration = 500;\n        this.position.z = -10;\n        this.center.set(0.5, 0.5);\n        this.scale.set(0.5, 0.5, 1);\n        this.startTimestamp = null;\n        this.timerId = null;\n        this.callback = null;\n        this.frustumCulled = false;\n        this.updateCanvasArcByProgress(0);\n    }\n    ;\n    Reticle.prototype = Object.assign(Object.create(THREE.Sprite.prototype), {\n        constructor: Reticle,\n        setColor: function (color) {\n            this.material.color.copy(color instanceof THREE.Color ? color : new THREE.Color(color));\n        },\n        createCanvasTexture: function (canvas) {\n            const texture = new THREE.CanvasTexture(canvas);\n            texture.minFilter = THREE.LinearFilter;\n            texture.magFilter = THREE.LinearFilter;\n            texture.generateMipmaps = false;\n            return texture;\n        },\n        createCanvas: function () {\n            const width = 32;\n            const height = 32;\n            const canvas = document.createElement('canvas');\n            const context = canvas.getContext('2d');\n            const dpr = this.dpr;\n            canvas.width = width * dpr;\n            canvas.height = height * dpr;\n            context.scale(dpr, dpr);\n            context.shadowBlur = 5;\n            context.shadowColor = 'rgba(200,200,200,0.9)';\n            return {\n                canvas,\n                context\n            };\n        },\n        updateCanvasArcByProgress: function (progress) {\n            const context = this.context;\n            const {canvasWidth, canvasHeight, material} = this;\n            const dpr = this.dpr;\n            const degree = progress * Math.PI * 2;\n            const color = this.color.getStyle();\n            const x = canvasWidth * 0.5 / dpr;\n            const y = canvasHeight * 0.5 / dpr;\n            const lineWidth = 3;\n            context.clearRect(0, 0, canvasWidth, canvasHeight);\n            context.beginPath();\n            if (progress === 0) {\n                context.arc(x, y, canvasWidth / 16, 0, 2 * Math.PI);\n                context.fillStyle = color;\n                context.fill();\n            } else {\n                context.arc(x, y, canvasWidth / 4 - lineWidth, -Math.PI / 2, -Math.PI / 2 + degree);\n                context.strokeStyle = color;\n                context.lineWidth = lineWidth;\n                context.stroke();\n            }\n            context.closePath();\n            material.map.needsUpdate = true;\n        },\n        ripple: function () {\n            const context = this.context;\n            const {canvasWidth, canvasHeight, material} = this;\n            const duration = this.rippleDuration;\n            const timestamp = performance.now();\n            const color = this.color;\n            const dpr = this.dpr;\n            const x = canvasWidth * 0.5 / dpr;\n            const y = canvasHeight * 0.5 / dpr;\n            const update = () => {\n                const timerId = window.requestAnimationFrame(update);\n                const elapsed = performance.now() - timestamp;\n                const progress = elapsed / duration;\n                const opacity = 1 - progress > 0 ? 1 - progress : 0;\n                const radius = progress * canvasWidth * 0.5 / dpr;\n                context.clearRect(0, 0, canvasWidth, canvasHeight);\n                context.beginPath();\n                context.arc(x, y, radius, 0, Math.PI * 2);\n                context.fillStyle = `rgba(${ color.r * 255 }, ${ color.g * 255 }, ${ color.b * 255 }, ${ opacity })`;\n                context.fill();\n                context.closePath();\n                if (progress >= 1) {\n                    window.cancelAnimationFrame(timerId);\n                    this.updateCanvasArcByProgress(0);\n                    this.dispatchEvent({ type: 'reticle-ripple-end' });\n                }\n                material.map.needsUpdate = true;\n            };\n            this.dispatchEvent({ type: 'reticle-ripple-start' });\n            update();\n        },\n        show: function () {\n            this.visible = true;\n        },\n        hide: function () {\n            this.visible = false;\n        },\n        start: function (callback) {\n            if (!this.autoSelect) {\n                return;\n            }\n            this.dispatchEvent({ type: 'reticle-start' });\n            this.startTimestamp = performance.now();\n            this.callback = callback;\n            this.update();\n        },\n        end: function () {\n            if (!this.startTimestamp) {\n                return;\n            }\n            window.cancelAnimationFrame(this.timerId);\n            this.updateCanvasArcByProgress(0);\n            this.callback = null;\n            this.timerId = null;\n            this.startTimestamp = null;\n            this.dispatchEvent({ type: 'reticle-end' });\n        },\n        update: function () {\n            this.timerId = window.requestAnimationFrame(this.update.bind(this));\n            const elapsed = performance.now() - this.startTimestamp;\n            const progress = elapsed / this.dwellTime;\n            this.updateCanvasArcByProgress(progress);\n            this.dispatchEvent({\n                type: 'reticle-update',\n                progress\n            });\n            if (progress >= 1) {\n                window.cancelAnimationFrame(this.timerId);\n                if (this.callback) {\n                    this.callback();\n                }\n                this.end();\n                this.ripple();\n            }\n        }\n    });\n    return Reticle;\n});\ndefine('skylark-panolens/loaders/ImageLoader',[\n    '../DataImage',\n    'skylark-threejs'\n], function (DataImage, THREE) {\n    'use strict';\n    const ImageLoader = {\n        load: function (url, onLoad = () => {\n        }, onProgress = () => {\n        }, onError = () => {\n        }) {\n            THREE.Cache.enabled = true;\n            let cached, request, arrayBufferView, blob, urlCreator, image, reference;\n            for (let iconName in DataImage) {\n                if (DataImage.hasOwnProperty(iconName) && url === DataImage[iconName]) {\n                    reference = iconName;\n                }\n            }\n            cached = THREE.Cache.get(reference ? reference : url);\n            if (cached !== undefined) {\n                if (onLoad) {\n                    setTimeout(function () {\n                        onProgress({\n                            loaded: 1,\n                            total: 1\n                        });\n                        onLoad(cached);\n                    }, 0);\n                }\n                return cached;\n            }\n            urlCreator = window.URL || window.webkitURL;\n            image = document.createElementNS('http://www.w3.org/1999/xhtml', 'img');\n            THREE.Cache.add(reference ? reference : url, image);\n            const onImageLoaded = () => {\n                urlCreator.revokeObjectURL(image.src);\n                onLoad(image);\n            };\n            if (url.indexOf('data:') === 0) {\n                image.addEventListener('load', onImageLoaded, false);\n                image.src = url;\n                return image;\n            }\n            image.crossOrigin = this.crossOrigin !== undefined ? this.crossOrigin : '';\n            request = new window.XMLHttpRequest();\n            request.open('GET', url, true);\n            request.responseType = 'arraybuffer';\n            request.addEventListener('error', onError);\n            request.addEventListener('progress', event => {\n                if (!event)\n                    return;\n                const {loaded, total, lengthComputable} = event;\n                if (lengthComputable) {\n                    onProgress({\n                        loaded,\n                        total\n                    });\n                }\n            });\n            request.addEventListener('loadend', event => {\n                if (!event)\n                    return;\n                const {\n                    currentTarget: {response}\n                } = event;\n                arrayBufferView = new Uint8Array(response);\n                blob = new window.Blob([arrayBufferView]);\n                image.addEventListener('load', onImageLoaded, false);\n                image.src = urlCreator.createObjectURL(blob);\n            });\n            request.send(null);\n        }\n    };\n    return ImageLoader;\n});\ndefine('skylark-panolens/loaders/TextureLoader',[\n    './ImageLoader',\n    'skylark-threejs'\n], function (ImageLoader, THREE) {\n    'use strict';\n    const TextureLoader = {\n        load: function (url, onLoad = () => {\n        }, onProgress, onError) {\n            var texture = new THREE.Texture();\n            ImageLoader.load(url, function (image) {\n                texture.image = image;\n                const isJPEG = url.search(/\\.(jpg|jpeg)$/) > 0 || url.search(/^data\\:image\\/jpeg/) === 0;\n                texture.format = isJPEG ? THREE.RGBFormat : THREE.RGBAFormat;\n                texture.needsUpdate = true;\n                onLoad(texture);\n            }, onProgress, onError);\n            return texture;\n        }\n    };\n    return TextureLoader;\n});\ndefine('skylark-panolens/infospot/Infospot',[\n    'skylark-threejs',\n    '../DataImage',\n    '../Constants',\n    '../loaders/TextureLoader',\n    'skylark-tweenjs'\n], function (THREE, DataImage, Constants, TextureLoader, TWEEN) {\n    'use strict';\n    function Infospot(scale = 300, imageSrc, animated) {\n        const duration = 500, scaleFactor = 1.3;\n        imageSrc = imageSrc || DataImage.Info;\n        THREE.Sprite.call(this);\n        this.type = 'infospot';\n        this.animated = animated !== undefined ? animated : true;\n        this.isHovering = false;\n        this.frustumCulled = false;\n        this.element = null;\n        this.toPanorama = null;\n        this.cursorStyle = null;\n        this.mode = Constants.MODES.NORMAL;\n        this.scale.set(scale, scale, 1);\n        this.rotation.y = Math.PI;\n        this.container = null;\n        this.originalRaycast = this.raycast;\n        this.HANDLER_FOCUS = null;\n        this.material.side = THREE.DoubleSide;\n        this.material.depthTest = false;\n        this.material.transparent = true;\n        this.material.opacity = 0;\n        this.scaleUpAnimation = new TWEEN.Tween();\n        this.scaleDownAnimation = new TWEEN.Tween();\n        const postLoad = function (texture) {\n            if (!this.material) {\n                return;\n            }\n            const ratio = texture.image.width / texture.image.height;\n            const textureScale = new THREE.Vector3();\n            texture.image.width = texture.image.naturalWidth || 64;\n            texture.image.height = texture.image.naturalHeight || 64;\n            this.scale.set(ratio * scale, scale, 1);\n            textureScale.copy(this.scale);\n            this.scaleUpAnimation = new TWEEN.Tween(this.scale).to({\n                x: textureScale.x * scaleFactor,\n                y: textureScale.y * scaleFactor\n            }, duration).easing(TWEEN.Easing.Elastic.Out);\n            this.scaleDownAnimation = new TWEEN.Tween(this.scale).to({\n                x: textureScale.x,\n                y: textureScale.y\n            }, duration).easing(TWEEN.Easing.Elastic.Out);\n            this.material.map = texture;\n            this.material.needsUpdate = true;\n        }.bind(this);\n        this.showAnimation = new TWEEN.Tween(this.material).to({ opacity: 1 }, duration).onStart(this.enableRaycast.bind(this, true)).easing(TWEEN.Easing.Quartic.Out);\n        this.hideAnimation = new TWEEN.Tween(this.material).to({ opacity: 0 }, duration).onStart(this.enableRaycast.bind(this, false)).easing(TWEEN.Easing.Quartic.Out);\n        this.addEventListener('click', this.onClick);\n        this.addEventListener('hover', this.onHover);\n        this.addEventListener('hoverenter', this.onHoverStart);\n        this.addEventListener('hoverleave', this.onHoverEnd);\n        this.addEventListener('panolens-dual-eye-effect', this.onDualEyeEffect);\n        this.addEventListener('panolens-container', this.setContainer.bind(this));\n        this.addEventListener('dismiss', this.onDismiss);\n        this.addEventListener('panolens-infospot-focus', this.setFocusMethod);\n        TextureLoader.load(imageSrc, postLoad);\n    }\n    ;\n    Infospot.prototype = Object.assign(Object.create(THREE.Sprite.prototype), {\n        constructor: Infospot,\n        setContainer: function (data) {\n            let container;\n            if (data instanceof HTMLElement) {\n                container = data;\n            } else if (data && data.container) {\n                container = data.container;\n            }\n            if (container && this.element) {\n                container.appendChild(this.element);\n            }\n            this.container = container;\n        },\n        getContainer: function () {\n            return this.container;\n        },\n        onClick: function (event) {\n            if (this.element && this.getContainer()) {\n                this.onHoverStart(event);\n                this.lockHoverElement();\n            }\n        },\n        onDismiss: function () {\n            if (this.element) {\n                this.unlockHoverElement();\n                this.onHoverEnd();\n            }\n        },\n        onHover: function () {\n        },\n        onHoverStart: function (event) {\n            if (!this.getContainer()) {\n                return;\n            }\n            const cursorStyle = this.cursorStyle || (this.mode === Constants.MODES.NORMAL ? 'pointer' : 'default');\n            const {scaleDownAnimation, scaleUpAnimation, element} = this;\n            this.isHovering = true;\n            this.container.style.cursor = cursorStyle;\n            if (this.animated) {\n                scaleDownAnimation.stop();\n                scaleUpAnimation.start();\n            }\n            if (element && event.mouseEvent.clientX >= 0 && event.mouseEvent.clientY >= 0) {\n                const {left, right, style} = element;\n                if (this.mode === Constants.MODES.CARDBOARD || this.mode === Constants.MODES.STEREO) {\n                    style.display = 'none';\n                    left.style.display = 'block';\n                    right.style.display = 'block';\n                    element._width = left.clientWidth;\n                    element._height = left.clientHeight;\n                } else {\n                    style.display = 'block';\n                    if (left) {\n                        left.style.display = 'none';\n                    }\n                    if (right) {\n                        right.style.display = 'none';\n                    }\n                    element._width = element.clientWidth;\n                    element._height = element.clientHeight;\n                }\n            }\n        },\n        onHoverEnd: function () {\n            if (!this.getContainer()) {\n                return;\n            }\n            const {scaleDownAnimation, scaleUpAnimation, element} = this;\n            this.isHovering = false;\n            this.container.style.cursor = 'default';\n            if (this.animated) {\n                scaleUpAnimation.stop();\n                scaleDownAnimation.start();\n            }\n            if (element && !this.element.locked) {\n                const {left, right, style} = element;\n                style.display = 'none';\n                if (left) {\n                    left.style.display = 'none';\n                }\n                if (right) {\n                    right.style.display = 'none';\n                }\n                this.unlockHoverElement();\n            }\n        },\n        onDualEyeEffect: function (event) {\n            if (!this.getContainer()) {\n                return;\n            }\n            let element, halfWidth, halfHeight;\n            this.mode = event.mode;\n            element = this.element;\n            halfWidth = this.container.clientWidth / 2;\n            halfHeight = this.container.clientHeight / 2;\n            if (!element) {\n                return;\n            }\n            if (!element.left && !element.right) {\n                element.left = element.cloneNode(true);\n                element.right = element.cloneNode(true);\n            }\n            if (this.mode === Constants.MODES.CARDBOARD || this.mode === Constants.MODES.STEREO) {\n                element.left.style.display = element.style.display;\n                element.right.style.display = element.style.display;\n                element.style.display = 'none';\n            } else {\n                element.style.display = element.left.style.display;\n                element.left.style.display = 'none';\n                element.right.style.display = 'none';\n            }\n            this.translateElement(halfWidth, halfHeight);\n            this.container.appendChild(element.left);\n            this.container.appendChild(element.right);\n        },\n        translateElement: function (x, y) {\n            if (!this.element._width || !this.element._height || !this.getContainer()) {\n                return;\n            }\n            let left, top, element, width, height, delta, container;\n            container = this.container;\n            element = this.element;\n            width = element._width / 2;\n            height = element._height / 2;\n            delta = element.verticalDelta !== undefined ? element.verticalDelta : 40;\n            left = x - width;\n            top = y - height - delta;\n            if ((this.mode === Constants.MODES.CARDBOARD || this.mode === Constants.MODES.STEREO) && element.left && element.right && !(x === container.clientWidth / 2 && y === container.clientHeight / 2)) {\n                left = container.clientWidth / 4 - width + (x - container.clientWidth / 2);\n                top = container.clientHeight / 2 - height - delta + (y - container.clientHeight / 2);\n                this.setElementStyle('transform', element.left, 'translate(' + left + 'px, ' + top + 'px)');\n                left += container.clientWidth / 2;\n                this.setElementStyle('transform', element.right, 'translate(' + left + 'px, ' + top + 'px)');\n            } else {\n                this.setElementStyle('transform', element, 'translate(' + left + 'px, ' + top + 'px)');\n            }\n        },\n        setElementStyle: function (type, element, value) {\n            const style = element.style;\n            if (type === 'transform') {\n                style.webkitTransform = style.msTransform = style.transform = value;\n            }\n        },\n        setText: function (text) {\n            if (this.element) {\n                this.element.textContent = text;\n            }\n        },\n        setCursorHoverStyle: function (style) {\n            this.cursorStyle = style;\n        },\n        addHoverText: function (text, delta = 40) {\n            if (!this.element) {\n                this.element = document.createElement('div');\n                this.element.style.display = 'none';\n                this.element.style.color = '#fff';\n                this.element.style.top = 0;\n                this.element.style.maxWidth = '50%';\n                this.element.style.maxHeight = '50%';\n                this.element.style.textShadow = '0 0 3px #000000';\n                this.element.style.fontFamily = '\"Trebuchet MS\", Helvetica, sans-serif';\n                this.element.style.position = 'absolute';\n                this.element.classList.add('panolens-infospot');\n                this.element.verticalDelta = delta;\n            }\n            this.setText(text);\n        },\n        addHoverElement: function (el, delta = 40) {\n            if (!this.element) {\n                this.element = el.cloneNode(true);\n                this.element.style.display = 'none';\n                this.element.style.top = 0;\n                this.element.style.position = 'absolute';\n                this.element.classList.add('panolens-infospot');\n                this.element.verticalDelta = delta;\n            }\n        },\n        removeHoverElement: function () {\n            if (this.element) {\n                if (this.element.left) {\n                    this.container.removeChild(this.element.left);\n                    this.element.left = null;\n                }\n                if (this.element.right) {\n                    this.container.removeChild(this.element.right);\n                    this.element.right = null;\n                }\n                this.container.removeChild(this.element);\n                this.element = null;\n            }\n        },\n        lockHoverElement: function () {\n            if (this.element) {\n                this.element.locked = true;\n            }\n        },\n        unlockHoverElement: function () {\n            if (this.element) {\n                this.element.locked = false;\n            }\n        },\n        enableRaycast: function (enabled = true) {\n            if (enabled) {\n                this.raycast = this.originalRaycast;\n            } else {\n                this.raycast = () => {\n                };\n            }\n        },\n        show: function (delay = 0) {\n            const {animated, hideAnimation, showAnimation, material} = this;\n            if (animated) {\n                hideAnimation.stop();\n                showAnimation.delay(delay).start();\n            } else {\n                this.enableRaycast(true);\n                material.opacity = 1;\n            }\n        },\n        hide: function (delay = 0) {\n            const {animated, hideAnimation, showAnimation, material} = this;\n            if (animated) {\n                showAnimation.stop();\n                hideAnimation.delay(delay).start();\n            } else {\n                this.enableRaycast(false);\n                material.opacity = 0;\n            }\n        },\n        setFocusMethod: function (event) {\n            if (event) {\n                this.HANDLER_FOCUS = event.method;\n            }\n        },\n        focus: function (duration, easing) {\n            if (this.HANDLER_FOCUS) {\n                this.HANDLER_FOCUS(this.position, duration, easing);\n                this.onDismiss();\n            }\n        },\n        dispose: function () {\n            const {geometry, material} = this;\n            const {map} = material;\n            this.removeHoverElement();\n            if (this.parent) {\n                this.parent.remove(this);\n            }\n            if (map) {\n                map.dispose();\n                material.map = null;\n            }\n            if (geometry) {\n                geometry.dispose();\n                this.geometry = null;\n            }\n            if (material) {\n                material.dispose();\n                this.material = null;\n            }\n        }\n    });\n    return Infospot;\n});\ndefine('skylark-panolens/panorama/Panorama',[\n    '../infospot/Infospot',\n    '../DataImage',\n    'skylark-threejs',\n    'skylark-tweenjs'\n], function (Infospot, DataImage, THREE, TWEEN) {\n    'use strict';\n    function Panorama(geometry, material) {\n        THREE.Mesh.call(this, geometry, material);\n        this.type = 'panorama';\n        this.ImageQualityLow = 1;\n        this.ImageQualityFair = 2;\n        this.ImageQualityMedium = 3;\n        this.ImageQualityHigh = 4;\n        this.ImageQualitySuperHigh = 5;\n        this.animationDuration = 1000;\n        this.defaultInfospotSize = 350;\n        this.container = undefined;\n        this.loaded = false;\n        this.linkedSpots = [];\n        this.isInfospotVisible = false;\n        this.linkingImageURL = undefined;\n        this.linkingImageScale = undefined;\n        this.material.side = THREE.BackSide;\n        this.material.opacity = 0;\n        this.scale.x *= -1;\n        this.renderOrder = -1;\n        this.active = false;\n        this.infospotAnimation = new TWEEN.Tween(this).to({}, this.animationDuration / 2);\n        this.addEventListener('load', this.fadeIn.bind(this));\n        this.addEventListener('panolens-container', this.setContainer.bind(this));\n        this.addEventListener('click', this.onClick.bind(this));\n        this.setupTransitions();\n    }\n    Panorama.prototype = Object.assign(Object.create(THREE.Mesh.prototype), {\n        constructor: Panorama,\n        add: function (object) {\n            let invertedObject;\n            if (arguments.length > 1) {\n                for (var i = 0; i < arguments.length; i++) {\n                    this.add(arguments[i]);\n                }\n                return this;\n            }\n            if (object instanceof Infospot) {\n                invertedObject = object;\n                if (object.dispatchEvent) {\n                    const {container} = this;\n                    if (container) {\n                        object.dispatchEvent({\n                            type: 'panolens-container',\n                            container\n                        });\n                    }\n                    object.dispatchEvent({\n                        type: 'panolens-infospot-focus',\n                        method: function (vector, duration, easing) {\n                            this.dispatchEvent({\n                                type: 'panolens-viewer-handler',\n                                method: 'tweenControlCenter',\n                                data: [\n                                    vector,\n                                    duration,\n                                    easing\n                                ]\n                            });\n                        }.bind(this)\n                    });\n                }\n            } else {\n                invertedObject = new THREE.Object3D();\n                invertedObject.scale.x = -1;\n                invertedObject.scalePlaceHolder = true;\n                invertedObject.add(object);\n            }\n            THREE.Object3D.prototype.add.call(this, invertedObject);\n        },\n        load: function () {\n            this.onLoad();\n        },\n        onClick: function (event) {\n            if (event.intersects && event.intersects.length === 0) {\n                this.traverse(function (object) {\n                    object.dispatchEvent({ type: 'dismiss' });\n                });\n            }\n        },\n        setContainer: function (data) {\n            let container;\n            if (data instanceof HTMLElement) {\n                container = data;\n            } else if (data && data.container) {\n                container = data.container;\n            }\n            if (container) {\n                this.children.forEach(function (child) {\n                    if (child instanceof Infospot && child.dispatchEvent) {\n                        child.dispatchEvent({\n                            type: 'panolens-container',\n                            container: container\n                        });\n                    }\n                });\n                this.container = container;\n            }\n        },\n        onLoad: function () {\n            this.loaded = true;\n            this.dispatchEvent({ type: 'load' });\n        },\n        onProgress: function (progress) {\n            this.dispatchEvent({\n                type: 'progress',\n                progress: progress\n            });\n        },\n        onError: function () {\n            this.dispatchEvent({ type: 'error' });\n        },\n        getZoomLevel: function () {\n            let zoomLevel;\n            if (window.innerWidth <= 800) {\n                zoomLevel = this.ImageQualityFair;\n            } else if (window.innerWidth > 800 && window.innerWidth <= 1280) {\n                zoomLevel = this.ImageQualityMedium;\n            } else if (window.innerWidth > 1280 && window.innerWidth <= 1920) {\n                zoomLevel = this.ImageQualityHigh;\n            } else if (window.innerWidth > 1920) {\n                zoomLevel = this.ImageQualitySuperHigh;\n            } else {\n                zoomLevel = this.ImageQualityLow;\n            }\n            return zoomLevel;\n        },\n        updateTexture: function (texture) {\n            this.material.map = texture;\n            this.material.needsUpdate = true;\n        },\n        toggleInfospotVisibility: function (isVisible, delay) {\n            delay = delay !== undefined ? delay : 0;\n            const visible = isVisible !== undefined ? isVisible : this.isInfospotVisible ? false : true;\n            this.traverse(function (object) {\n                if (object instanceof Infospot) {\n                    if (visible) {\n                        object.show(delay);\n                    } else {\n                        object.hide(delay);\n                    }\n                }\n            });\n            this.isInfospotVisible = visible;\n            this.infospotAnimation.onComplete(function () {\n                this.dispatchEvent({\n                    type: 'infospot-animation-complete',\n                    visible: visible\n                });\n            }.bind(this)).delay(delay).start();\n        },\n        setLinkingImage: function (url, scale) {\n            this.linkingImageURL = url;\n            this.linkingImageScale = scale;\n        },\n        link: function (pano, position, imageScale, imageSrc) {\n            let scale, img;\n            this.visible = true;\n            if (!position) {\n                console.warn('Please specify infospot position for linking');\n                return;\n            }\n            if (imageScale !== undefined) {\n                scale = imageScale;\n            } else if (pano.linkingImageScale !== undefined) {\n                scale = pano.linkingImageScale;\n            } else {\n                scale = 300;\n            }\n            if (imageSrc) {\n                img = imageSrc;\n            } else if (pano.linkingImageURL) {\n                img = pano.linkingImageURL;\n            } else {\n                img = DataImage.Arrow;\n            }\n            const spot = new Infospot(scale, img);\n            spot.position.copy(position);\n            spot.toPanorama = pano;\n            spot.addEventListener('click', function () {\n                this.dispatchEvent({\n                    type: 'panolens-viewer-handler',\n                    method: 'setPanorama',\n                    data: pano\n                });\n            }.bind(this));\n            this.linkedSpots.push(spot);\n            this.add(spot);\n            this.visible = false;\n        },\n        reset: function () {\n            this.children.length = 0;\n        },\n        setupTransitions: function () {\n            this.fadeInAnimation = new TWEEN.Tween(this.material).easing(TWEEN.Easing.Quartic.Out).onStart(function () {\n                this.visible = true;\n                this.dispatchEvent({ type: 'enter-fade-start' });\n            }.bind(this));\n            this.fadeOutAnimation = new TWEEN.Tween(this.material).easing(TWEEN.Easing.Quartic.Out).onComplete(function () {\n                this.visible = false;\n                this.dispatchEvent({ type: 'leave-complete' });\n            }.bind(this));\n            this.enterTransition = new TWEEN.Tween(this).easing(TWEEN.Easing.Quartic.Out).onComplete(function () {\n                this.dispatchEvent({ type: 'enter-complete' });\n            }.bind(this)).start();\n            this.leaveTransition = new TWEEN.Tween(this).easing(TWEEN.Easing.Quartic.Out);\n        },\n        onFadeAnimationUpdate: function () {\n            const alpha = this.material.opacity;\n            const {uniforms} = this.material;\n            if (uniforms && uniforms.opacity) {\n                uniforms.opacity.value = alpha;\n            }\n        },\n        fadeIn: function (duration) {\n            duration = duration >= 0 ? duration : this.animationDuration;\n            this.fadeOutAnimation.stop();\n            this.fadeInAnimation.to({ opacity: 1 }, duration).onUpdate(this.onFadeAnimationUpdate.bind(this)).onComplete(function () {\n                this.toggleInfospotVisibility(true, duration / 2);\n                this.dispatchEvent({ type: 'enter-fade-complete' });\n            }.bind(this)).start();\n        },\n        fadeOut: function (duration) {\n            duration = duration >= 0 ? duration : this.animationDuration;\n            this.fadeInAnimation.stop();\n            this.fadeOutAnimation.to({ opacity: 0 }, duration).onUpdate(this.onFadeAnimationUpdate.bind(this)).start();\n        },\n        onEnter: function () {\n            const duration = this.animationDuration;\n            this.leaveTransition.stop();\n            this.enterTransition.to({}, duration).onStart(function () {\n                this.dispatchEvent({ type: 'enter-start' });\n                if (this.loaded) {\n                    this.fadeIn(duration);\n                } else {\n                    this.load();\n                }\n            }.bind(this)).start();\n            this.dispatchEvent({ type: 'enter' });\n            this.children.forEach(child => {\n                child.dispatchEvent({ type: 'panorama-enter' });\n            });\n            this.active = true;\n        },\n        onLeave: function () {\n            const duration = this.animationDuration;\n            this.enterTransition.stop();\n            this.leaveTransition.to({}, duration).onStart(function () {\n                this.dispatchEvent({ type: 'leave-start' });\n                this.fadeOut(duration);\n                this.toggleInfospotVisibility(false);\n            }.bind(this)).start();\n            this.dispatchEvent({ type: 'leave' });\n            this.children.forEach(child => {\n                child.dispatchEvent({ type: 'panorama-leave' });\n            });\n            this.active = false;\n        },\n        dispose: function () {\n            this.infospotAnimation.stop();\n            this.fadeInAnimation.stop();\n            this.fadeOutAnimation.stop();\n            this.enterTransition.stop();\n            this.leaveTransition.stop();\n            this.dispatchEvent({\n                type: 'panolens-viewer-handler',\n                method: 'onPanoramaDispose',\n                data: this\n            });\n            function recursiveDispose(object) {\n                const {geometry, material} = object;\n                for (var i = object.children.length - 1; i >= 0; i--) {\n                    recursiveDispose(object.children[i]);\n                    object.remove(object.children[i]);\n                }\n                if (object instanceof Infospot) {\n                    object.dispose();\n                }\n                if (geometry) {\n                    geometry.dispose();\n                    object.geometry = null;\n                }\n                if (material) {\n                    material.dispose();\n                    object.material = null;\n                }\n            }\n            recursiveDispose(this);\n            if (this.parent) {\n                this.parent.remove(this);\n            }\n        }\n    });\n    return Panorama;\n});\ndefine('skylark-panolens/panorama/VideoPanorama',[\n    './Panorama',\n    'skylark-threejs'\n], function (Panorama, THREE) {\n    'use strict';\n    function VideoPanorama(src, options = {}) {\n        const radius = 5000;\n        const geometry = new THREE.SphereBufferGeometry(radius, 60, 40);\n        const material = new THREE.MeshBasicMaterial({\n            opacity: 0,\n            transparent: true\n        });\n        Panorama.call(this, geometry, material);\n        this.src = src;\n        this.options = {\n            videoElement: document.createElement('video'),\n            loop: true,\n            muted: true,\n            autoplay: false,\n            playsinline: true,\n            crossOrigin: 'anonymous'\n        };\n        Object.assign(this.options, options);\n        this.videoElement = this.options.videoElement;\n        this.videoProgress = 0;\n        this.radius = radius;\n        this.addEventListener('leave', this.pauseVideo.bind(this));\n        this.addEventListener('enter-fade-start', this.resumeVideoProgress.bind(this));\n        this.addEventListener('video-toggle', this.toggleVideo.bind(this));\n        this.addEventListener('video-time', this.setVideoCurrentTime.bind(this));\n    }\n    ;\n    VideoPanorama.prototype = Object.assign(Object.create(Panorama.prototype), {\n        constructor: VideoPanorama,\n        isMobile: function () {\n            let check = false;\n            (function (a) {\n                if (/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0, 4)))\n                    check = true;\n            }(window.navigator.userAgent || window.navigator.vendor || window.opera));\n            return check;\n        },\n        load: function () {\n            const {muted, loop, autoplay, playsinline, crossOrigin} = this.options;\n            const video = this.videoElement;\n            const material = this.material;\n            const onProgress = this.onProgress.bind(this);\n            const onLoad = this.onLoad.bind(this);\n            video.loop = loop;\n            video.autoplay = autoplay;\n            video.playsinline = playsinline;\n            video.crossOrigin = crossOrigin;\n            video.muted = muted;\n            if (playsinline) {\n                video.setAttribute('playsinline', '');\n                video.setAttribute('webkit-playsinline', '');\n            }\n            const onloadeddata = function () {\n                this.setVideoTexture(video);\n                if (autoplay) {\n                    this.dispatchEvent({\n                        type: 'panolens-viewer-handler',\n                        method: 'updateVideoPlayButton',\n                        data: false\n                    });\n                }\n                if (this.isMobile()) {\n                    video.pause();\n                    if (autoplay && muted) {\n                        this.dispatchEvent({\n                            type: 'panolens-viewer-handler',\n                            method: 'updateVideoPlayButton',\n                            data: false\n                        });\n                    } else {\n                        this.dispatchEvent({\n                            type: 'panolens-viewer-handler',\n                            method: 'updateVideoPlayButton',\n                            data: true\n                        });\n                    }\n                }\n                const loaded = () => {\n                    material.map.needsUpdate = true;\n                    onProgress({\n                        loaded: 1,\n                        total: 1\n                    });\n                    onLoad();\n                };\n                window.requestAnimationFrame(loaded);\n            };\n            if (video.readyState > 2) {\n                onloadeddata.call(this);\n            } else {\n                if (video.querySelectorAll('source').length === 0) {\n                    const source = document.createElement('source');\n                    source.src = this.src;\n                    video.appendChild(source);\n                }\n                video.load();\n            }\n            video.addEventListener('loadeddata', onloadeddata.bind(this));\n            video.addEventListener('timeupdate', function () {\n                this.videoProgress = video.duration >= 0 ? video.currentTime / video.duration : 0;\n                this.dispatchEvent({\n                    type: 'panolens-viewer-handler',\n                    method: 'onVideoUpdate',\n                    data: this.videoProgress\n                });\n            }.bind(this));\n            video.addEventListener('ended', function () {\n                if (!loop) {\n                    this.resetVideo();\n                    this.dispatchEvent({\n                        type: 'panolens-viewer-handler',\n                        method: 'updateVideoPlayButton',\n                        data: true\n                    });\n                }\n            }.bind(this), false);\n        },\n        setVideoTexture: function (video) {\n            if (!video)\n                return;\n            const videoTexture = new THREE.VideoTexture(video);\n            videoTexture.minFilter = THREE.LinearFilter;\n            videoTexture.magFilter = THREE.LinearFilter;\n            videoTexture.format = THREE.RGBFormat;\n            this.updateTexture(videoTexture);\n        },\n        reset: function () {\n            this.videoElement = undefined;\n            Panorama.prototype.reset.call(this);\n        },\n        isVideoPaused: function () {\n            return this.videoElement.paused;\n        },\n        toggleVideo: function () {\n            const video = this.videoElement;\n            if (!video) {\n                return;\n            }\n            video[video.paused ? 'play' : 'pause']();\n        },\n        setVideoCurrentTime: function ({percentage}) {\n            const video = this.videoElement;\n            if (video && !Number.isNaN(percentage) && percentage !== 1) {\n                video.currentTime = video.duration * percentage;\n                this.dispatchEvent({\n                    type: 'panolens-viewer-handler',\n                    method: 'onVideoUpdate',\n                    data: percentage\n                });\n            }\n        },\n        playVideo: function () {\n            const video = this.videoElement;\n            const playVideo = this.playVideo.bind(this);\n            const dispatchEvent = this.dispatchEvent.bind(this);\n            const onSuccess = () => {\n                dispatchEvent({ type: 'play' });\n            };\n            const onError = error => {\n                window.requestAnimationFrame(playVideo);\n                dispatchEvent({\n                    type: 'play-error',\n                    error\n                });\n            };\n            if (video && video.paused) {\n                video.play().then(onSuccess).catch(onError);\n            }\n        },\n        pauseVideo: function () {\n            const video = this.videoElement;\n            if (video && !video.paused) {\n                video.pause();\n            }\n            this.dispatchEvent({ type: 'pause' });\n        },\n        resumeVideoProgress: function () {\n            const video = this.videoElement;\n            if (video.readyState >= 4 && video.autoplay && !this.isMobile()) {\n                this.playVideo();\n                this.dispatchEvent({\n                    type: 'panolens-viewer-handler',\n                    method: 'updateVideoPlayButton',\n                    data: false\n                });\n            } else {\n                this.pauseVideo();\n                this.dispatchEvent({\n                    type: 'panolens-viewer-handler',\n                    method: 'updateVideoPlayButton',\n                    data: true\n                });\n            }\n            this.setVideoCurrentTime({ percentage: this.videoProgress });\n        },\n        resetVideo: function () {\n            const video = this.videoElement;\n            if (video) {\n                this.setVideoCurrentTime({ percentage: 0 });\n            }\n        },\n        isVideoMuted: function () {\n            return this.videoElement.muted;\n        },\n        muteVideo: function () {\n            const video = this.videoElement;\n            if (video && !video.muted) {\n                video.muted = true;\n            }\n            this.dispatchEvent({ type: 'volumechange' });\n        },\n        unmuteVideo: function () {\n            const video = this.videoElement;\n            if (video && this.isVideoMuted()) {\n                video.muted = false;\n            }\n            this.dispatchEvent({ type: 'volumechange' });\n        },\n        getVideoElement: function () {\n            return this.videoElement;\n        },\n        dispose: function () {\n            const {\n                material: {map}\n            } = this;\n            this.pauseVideo();\n            this.removeEventListener('leave', this.pauseVideo.bind(this));\n            this.removeEventListener('enter-fade-start', this.resumeVideoProgress.bind(this));\n            this.removeEventListener('video-toggle', this.toggleVideo.bind(this));\n            this.removeEventListener('video-time', this.setVideoCurrentTime.bind(this));\n            if (map) {\n                map.dispose();\n            }\n            Panorama.prototype.dispose.call(this);\n        }\n    });\n    return VideoPanorama;\n});\ndefine('skylark-panolens/media/Media',['skylark-threejs'], function (THREE) {\n    'use strict';\n    function Media(constraints) {\n        const defaultConstraints = {\n            video: {\n                width: { ideal: 1920 },\n                height: { ideal: 1080 },\n                facingMode: { exact: 'environment' }\n            },\n            audio: false\n        };\n        this.constraints = Object.assign(defaultConstraints, constraints);\n        this.container = null;\n        this.scene = null;\n        this.element = null;\n        this.devices = [];\n        this.stream = null;\n        this.ratioScalar = 1;\n        this.videoDeviceIndex = 0;\n    }\n    ;\n    Media.prototype = Object.assign(Object.create(THREE.EventDispatcher.prototype), {\n        setContainer: function (container) {\n            this.container = container;\n        },\n        setScene: function (scene) {\n            this.scene = scene;\n        },\n        enumerateDevices: function () {\n            const devices = this.devices;\n            const resolvedPromise = new Promise(resolve => {\n                resolve(devices);\n            });\n            return devices.length > 0 ? resolvedPromise : window.navigator.mediaDevices.enumerateDevices();\n        },\n        switchNextVideoDevice: function () {\n            const stop = this.stop.bind(this);\n            const start = this.start.bind(this);\n            const setVideDeviceIndex = this.setVideDeviceIndex.bind(this);\n            let index = this.videoDeviceIndex;\n            this.getDevices('video').then(devices => {\n                stop();\n                index++;\n                if (index >= devices.length) {\n                    setVideDeviceIndex(0);\n                    index--;\n                } else {\n                    setVideDeviceIndex(index);\n                }\n                start(devices[index]);\n            });\n        },\n        getDevices: function (type = 'video') {\n            const devices = this.devices;\n            const validate = _devices => {\n                return _devices.map(device => {\n                    if (!devices.includes(device)) {\n                        devices.push(device);\n                    }\n                    return device;\n                });\n            };\n            const filter = _devices => {\n                const reg = new RegExp(type, 'i');\n                return _devices.filter(device => reg.test(device.kind));\n            };\n            return this.enumerateDevices().then(validate).then(filter);\n        },\n        getUserMedia: function (constraints) {\n            const setMediaStream = this.setMediaStream.bind(this);\n            const playVideo = this.playVideo.bind(this);\n            const onCatchError = error => {\n                console.warn(`PANOLENS.Media: ${ error }`);\n            };\n            return window.navigator.mediaDevices.getUserMedia(constraints).then(setMediaStream).then(playVideo).catch(onCatchError);\n        },\n        setVideDeviceIndex: function (index) {\n            this.videoDeviceIndex = index;\n        },\n        start: function (targetDevice) {\n            const constraints = this.constraints;\n            const getUserMedia = this.getUserMedia.bind(this);\n            const onVideoDevices = devices => {\n                if (!devices || devices.length === 0) {\n                    throw Error('no video device found');\n                }\n                const device = targetDevice || devices[0];\n                constraints.video.deviceId = device.deviceId;\n                return getUserMedia(constraints);\n            };\n            this.element = this.createVideoElement();\n            return this.getDevices().then(onVideoDevices);\n        },\n        stop: function () {\n            const stream = this.stream;\n            if (stream && stream.active) {\n                const track = stream.getTracks()[0];\n                track.stop();\n                window.removeEventListener('resize', this.onWindowResize.bind(this));\n                this.element = null;\n                this.stream = null;\n            }\n        },\n        setMediaStream: function (stream) {\n            this.stream = stream;\n            this.element.srcObject = stream;\n            if (this.scene) {\n                this.scene.background = this.createVideoTexture();\n            }\n            window.addEventListener('resize', this.onWindowResize.bind(this));\n        },\n        playVideo: function () {\n            const {element} = this;\n            if (element) {\n                element.play();\n                this.dispatchEvent({ type: 'play' });\n            }\n        },\n        pauseVideo: function () {\n            const {element} = this;\n            if (element) {\n                element.pause();\n                this.dispatchEvent({ type: 'pause' });\n            }\n        },\n        createVideoTexture: function () {\n            const video = this.element;\n            const texture = new THREE.VideoTexture(video);\n            texture.generateMipmaps = false;\n            texture.minFilter = THREE.LinearFilter;\n            texture.magFilter = THREE.LinearFilter;\n            texture.format = THREE.RGBFormat;\n            texture.center.set(0.5, 0.5);\n            video.addEventListener('canplay', this.onWindowResize.bind(this));\n            return texture;\n        },\n        createVideoElement: function () {\n            const dispatchEvent = this.dispatchEvent.bind(this);\n            const video = document.createElement('video');\n            const canPlay = () => dispatchEvent({ type: 'canplay' });\n            video.setAttribute('autoplay', '');\n            video.setAttribute('muted', '');\n            video.setAttribute('playsinline', '');\n            video.style.position = 'absolute';\n            video.style.top = '0';\n            video.style.left = '0';\n            video.style.width = '100%';\n            video.style.height = '100%';\n            video.style.objectPosition = 'center';\n            video.style.objectFit = 'cover';\n            video.style.display = this.scene ? 'none' : '';\n            video.addEventListener('canplay', canPlay);\n            return video;\n        },\n        onWindowResize: function () {\n            if (this.element && this.element.videoWidth && this.element.videoHeight && this.scene) {\n                const {\n                    clientWidth: width,\n                    clientHeight: height\n                } = this.container;\n                const texture = this.scene.background;\n                const {videoWidth, videoHeight} = this.element;\n                const cameraRatio = videoHeight / videoWidth;\n                const viewportRatio = this.container ? width / height : 1;\n                const ratio = cameraRatio * viewportRatio * this.ratioScalar;\n                if (width > height) {\n                    texture.repeat.set(ratio, 1);\n                } else {\n                    texture.repeat.set(1, 1 / ratio);\n                }\n            }\n        }\n    });\n    return Media;\n});\ndefine('skylark-panolens/panorama/CameraPanorama',[\n    './Panorama',\n    '../media/Media',\n    'skylark-threejs'\n], function (Panorama, Media, THREE) {\n    'use strict';\n    function CameraPanorama(constraints) {\n        const radius = 5000;\n        const geometry = new THREE.SphereBufferGeometry(radius, 60, 40);\n        const material = new THREE.MeshBasicMaterial({ visible: false });\n        Panorama.call(this, geometry, material);\n        this.media = new Media(constraints);\n        this.radius = radius;\n        this.addEventListener('enter', this.start.bind(this));\n        this.addEventListener('leave', this.stop.bind(this));\n        this.addEventListener('panolens-container', this.onPanolensContainer.bind(this));\n        this.addEventListener('panolens-scene', this.onPanolensScene.bind(this));\n    }\n    CameraPanorama.prototype = Object.assign(Object.create(Panorama.prototype), {\n        constructor: CameraPanorama,\n        onPanolensContainer: function ({container}) {\n            this.media.setContainer(container);\n        },\n        onPanolensScene: function ({scene}) {\n            this.media.setScene(scene);\n        },\n        start: function () {\n            return this.media.start();\n        },\n        stop: function () {\n            this.media.stop();\n        }\n    });\n    return CameraPanorama;\n});\ndefine('skylark-panolens/Viewer',[\n    './panolens',\n    './Constants',\n    './lib/controls/OrbitControls',\n    './lib/controls/DeviceOrientationControls',\n    './lib/effects/CardboardEffect',\n    './lib/effects/StereoEffect',\n    './widget/Widget',\n    './interface/Reticle',\n    './infospot/Infospot',\n    './DataImage',\n    './panorama/Panorama',\n    './panorama/VideoPanorama',\n    './panorama/CameraPanorama',\n    'skylark-threejs',\n    'skylark-tweenjs'\n], function (panolens,Constants, OrbitControls, DeviceOrientationControls, CardboardEffect, StereoEffect, Widget, Reticle, Infospot, DataImage, Panorama, VideoPanorama, CameraPanorama, THREE, TWEEN) {\n    'use strict';\n    function Viewer(options) {\n        let container;\n        options = options || {};\n        options.controlBar = options.controlBar !== undefined ? options.controlBar : true;\n        options.controlButtons = options.controlButtons || [\n            'fullscreen',\n            'setting',\n            'video'\n        ];\n        options.autoHideControlBar = options.autoHideControlBar !== undefined ? options.autoHideControlBar : false;\n        options.autoHideInfospot = options.autoHideInfospot !== undefined ? options.autoHideInfospot : true;\n        options.horizontalView = options.horizontalView !== undefined ? options.horizontalView : false;\n        options.clickTolerance = options.clickTolerance || 10;\n        options.cameraFov = options.cameraFov || 60;\n        options.reverseDragging = options.reverseDragging || false;\n        options.enableReticle = options.enableReticle || false;\n        options.dwellTime = options.dwellTime || 1500;\n        options.autoReticleSelect = options.autoReticleSelect !== undefined ? options.autoReticleSelect : true;\n        options.viewIndicator = options.viewIndicator !== undefined ? options.viewIndicator : false;\n        options.indicatorSize = options.indicatorSize || 30;\n        options.output = options.output ? options.output : 'none';\n        options.autoRotate = options.autoRotate || false;\n        options.autoRotateSpeed = options.autoRotateSpeed || 2;\n        options.autoRotateActivationDuration = options.autoRotateActivationDuration || 5000;\n        this.options = options;\n        if (options.container) {\n            container = options.container;\n            container._width = container.clientWidth;\n            container._height = container.clientHeight;\n        } else {\n            container = document.createElement('div');\n            container.classList.add('panolens-container');\n            container.style.width = '100%';\n            container.style.height = '100%';\n            container._width = window.innerWidth;\n            container._height = window.innerHeight;\n            document.body.appendChild(container);\n        }\n        this.container = container;\n        this.camera = options.camera || new THREE.PerspectiveCamera(this.options.cameraFov, this.container.clientWidth / this.container.clientHeight, 1, 10000);\n        this.scene = options.scene || new THREE.Scene();\n        this.renderer = options.renderer || new THREE.WebGLRenderer({\n            alpha: true,\n            antialias: false\n        });\n        this.sceneReticle = new THREE.Scene();\n        this.viewIndicatorSize = this.options.indicatorSize;\n        this.reticle = {};\n        this.tempEnableReticle = this.options.enableReticle;\n        this.mode = Constants.MODES.NORMAL;\n        this.panorama = null;\n        this.widget = null;\n        this.hoverObject = null;\n        this.infospot = null;\n        this.pressEntityObject = null;\n        this.pressObject = null;\n        this.raycaster = new THREE.Raycaster();\n        this.raycasterPoint = new THREE.Vector2();\n        this.userMouse = new THREE.Vector2();\n        this.updateCallbacks = [];\n        this.requestAnimationId = null;\n        this.cameraFrustum = new THREE.Frustum();\n        this.cameraViewProjectionMatrix = new THREE.Matrix4();\n        this.autoRotateRequestId = null;\n        this.outputDivElement = null;\n        this.touchSupported = 'ontouchstart' in window || window.DocumentTouch && document instanceof DocumentTouch;\n        this.HANDLER_MOUSE_DOWN = this.onMouseDown.bind(this);\n        this.HANDLER_MOUSE_UP = this.onMouseUp.bind(this);\n        this.HANDLER_MOUSE_MOVE = this.onMouseMove.bind(this);\n        this.HANDLER_WINDOW_RESIZE = this.onWindowResize.bind(this);\n        this.HANDLER_KEY_DOWN = this.onKeyDown.bind(this);\n        this.HANDLER_KEY_UP = this.onKeyUp.bind(this);\n        this.HANDLER_TAP = this.onTap.bind(this, {\n            clientX: this.container.clientWidth / 2,\n            clientY: this.container.clientHeight / 2\n        });\n        this.OUTPUT_INFOSPOT = false;\n        this.tweenLeftAnimation = new TWEEN.Tween();\n        this.tweenUpAnimation = new TWEEN.Tween();\n        this.renderer.setPixelRatio(window.devicePixelRatio);\n        this.renderer.setSize(this.container.clientWidth, this.container.clientHeight);\n        this.renderer.setClearColor(0, 0);\n        this.renderer.autoClear = false;\n        this.renderer.domElement.classList.add('panolens-canvas');\n        this.renderer.domElement.style.display = 'block';\n        this.container.style.backgroundColor = '#000';\n        this.container.appendChild(this.renderer.domElement);\n        this.orbitControls = new OrbitControls(this.camera, this.container);\n        this.orbitControls.id = 'orbit';\n        this.orbitControls.minDistance = 1;\n        this.orbitControls.noPan = true;\n        this.orbitControls.autoRotate = this.options.autoRotate;\n        this.orbitControls.autoRotateSpeed = this.options.autoRotateSpeed;\n        this.deviceOrientationControls = new DeviceOrientationControls(this.camera, this.container);\n        this.deviceOrientationControls.id = 'device-orientation';\n        this.deviceOrientationControls.enabled = false;\n        this.camera.position.z = 1;\n        if (this.options.passiveRendering) {\n            console.warn('passiveRendering is now deprecated');\n        }\n        this.controls = [\n            this.orbitControls,\n            this.deviceOrientationControls\n        ];\n        this.control = this.orbitControls;\n        this.cardboardEffect = new CardboardEffect(this.renderer);\n        this.cardboardEffect.setSize(this.container.clientWidth, this.container.clientHeight);\n        this.stereoEffect = new StereoEffect(this.renderer);\n        this.stereoEffect.setSize(this.container.clientWidth, this.container.clientHeight);\n        this.effect = this.cardboardEffect;\n        this.addReticle();\n        if (this.options.horizontalView) {\n            this.orbitControls.minPolarAngle = Math.PI / 2;\n            this.orbitControls.maxPolarAngle = Math.PI / 2;\n        }\n        if (this.options.controlBar !== false) {\n            this.addDefaultControlBar(this.options.controlButtons);\n        }\n        if (this.options.viewIndicator) {\n            this.addViewIndicator();\n        }\n        if (this.options.reverseDragging) {\n            this.reverseDraggingDirection();\n        }\n        if (this.options.enableReticle) {\n            this.enableReticleControl();\n        } else {\n            this.registerMouseAndTouchEvents();\n        }\n        if (this.options.output === 'overlay') {\n            this.addOutputElement();\n        }\n        this.registerEventListeners();\n        this.animate.call(this);\n    }\n    ;\n    Viewer.prototype = Object.assign(Object.create(THREE.EventDispatcher.prototype), {\n        constructor: Viewer,\n        add: function (object) {\n            if (arguments.length > 1) {\n                for (let i = 0; i < arguments.length; i++) {\n                    this.add(arguments[i]);\n                }\n                return this;\n            }\n            this.scene.add(object);\n            if (object.addEventListener) {\n                object.addEventListener('panolens-viewer-handler', this.eventHandler.bind(this));\n            }\n            if (object instanceof Panorama && object.dispatchEvent) {\n                object.dispatchEvent({\n                    type: 'panolens-container',\n                    container: this.container\n                });\n            }\n            if (object instanceof CameraPanorama) {\n                object.dispatchEvent({\n                    type: 'panolens-scene',\n                    scene: this.scene\n                });\n            }\n            if (object.type === 'panorama') {\n                this.addPanoramaEventListener(object);\n                if (!this.panorama) {\n                    this.setPanorama(object);\n                }\n            }\n        },\n        remove: function (object) {\n            if (object.removeEventListener) {\n                object.removeEventListener('panolens-viewer-handler', this.eventHandler.bind(this));\n            }\n            this.scene.remove(object);\n        },\n        addDefaultControlBar: function (array) {\n            if (this.widget) {\n                console.warn('Default control bar exists');\n                return;\n            }\n            const widget = new Widget(this.container);\n            widget.addEventListener('panolens-viewer-handler', this.eventHandler.bind(this));\n            widget.addControlBar();\n            array.forEach(buttonName => {\n                widget.addControlButton(buttonName);\n            });\n            this.widget = widget;\n        },\n        setPanorama: function (pano) {\n            const leavingPanorama = this.panorama;\n            if (pano.type === 'panorama' && leavingPanorama !== pano) {\n                this.hideInfospot();\n                const afterEnterComplete = function () {\n                    if (leavingPanorama) {\n                        leavingPanorama.onLeave();\n                    }\n                    pano.removeEventListener('enter-fade-start', afterEnterComplete);\n                };\n                pano.addEventListener('enter-fade-start', afterEnterComplete);\n                (this.panorama = pano).onEnter();\n            }\n        },\n        eventHandler: function (event) {\n            if (event.method && this[event.method]) {\n                this[event.method](event.data);\n            }\n        },\n        dispatchEventToChildren: function (event) {\n            this.scene.traverse(function (object) {\n                if (object.dispatchEvent) {\n                    object.dispatchEvent(event);\n                }\n            });\n        },\n        activateWidgetItem: function (controlIndex, mode) {\n            const mainMenu = this.widget.mainMenu;\n            const ControlMenuItem = mainMenu.children[0];\n            const ModeMenuItem = mainMenu.children[1];\n            let item;\n            if (controlIndex !== undefined) {\n                switch (controlIndex) {\n                case 0:\n                    item = ControlMenuItem.subMenu.children[1];\n                    break;\n                case 1:\n                    item = ControlMenuItem.subMenu.children[2];\n                    break;\n                default:\n                    item = ControlMenuItem.subMenu.children[1];\n                    break;\n                }\n                ControlMenuItem.subMenu.setActiveItem(item);\n                ControlMenuItem.setSelectionTitle(item.textContent);\n            }\n            if (mode !== undefined) {\n                switch (mode) {\n                case Constants.MODES.CARDBOARD:\n                    item = ModeMenuItem.subMenu.children[2];\n                    break;\n                case Constants.MODES.STEREO:\n                    item = ModeMenuItem.subMenu.children[3];\n                    break;\n                default:\n                    item = ModeMenuItem.subMenu.children[1];\n                    break;\n                }\n                ModeMenuItem.subMenu.setActiveItem(item);\n                ModeMenuItem.setSelectionTitle(item.textContent);\n            }\n        },\n        enableEffect: function (mode) {\n            if (this.mode === mode) {\n                return;\n            }\n            if (mode === Constants.MODES.NORMAL) {\n                this.disableEffect();\n                return;\n            } else {\n                this.mode = mode;\n            }\n            const fov = this.camera.fov;\n            switch (mode) {\n            case Constants.MODES.CARDBOARD:\n                this.effect = this.cardboardEffect;\n                this.enableReticleControl();\n                break;\n            case Constants.MODES.STEREO:\n                this.effect = this.stereoEffect;\n                this.enableReticleControl();\n                break;\n            default:\n                this.effect = null;\n                this.disableReticleControl();\n                break;\n            }\n            this.activateWidgetItem(undefined, this.mode);\n            this.dispatchEventToChildren({\n                type: 'panolens-dual-eye-effect',\n                mode: this.mode\n            });\n            this.camera.fov = fov + 0.01;\n            this.effect.setSize(this.container.clientWidth, this.container.clientHeight);\n            this.render();\n            this.camera.fov = fov;\n            this.dispatchEvent({\n                type: 'mode-change',\n                mode: this.mode\n            });\n        },\n        disableEffect: function () {\n            if (this.mode === Constants.MODES.NORMAL) {\n                return;\n            }\n            this.mode = Constants.MODES.NORMAL;\n            this.disableReticleControl();\n            this.activateWidgetItem(undefined, this.mode);\n            this.dispatchEventToChildren({\n                type: 'panolens-dual-eye-effect',\n                mode: this.mode\n            });\n            this.renderer.setSize(this.container.clientWidth, this.container.clientHeight);\n            this.render();\n            this.dispatchEvent({\n                type: 'mode-change',\n                mode: this.mode\n            });\n        },\n        enableReticleControl: function () {\n            if (this.reticle.visible) {\n                return;\n            }\n            this.tempEnableReticle = true;\n            this.unregisterMouseAndTouchEvents();\n            this.reticle.show();\n            this.registerReticleEvent();\n            this.updateReticleEvent();\n        },\n        disableReticleControl: function () {\n            this.tempEnableReticle = false;\n            if (!this.options.enableReticle) {\n                this.reticle.hide();\n                this.unregisterReticleEvent();\n                this.registerMouseAndTouchEvents();\n            } else {\n                this.updateReticleEvent();\n            }\n        },\n        enableAutoRate: function () {\n            this.options.autoRotate = true;\n            this.orbitControls.autoRotate = true;\n        },\n        disableAutoRate: function () {\n            clearTimeout(this.autoRotateRequestId);\n            this.options.autoRotate = false;\n            this.orbitControls.autoRotate = false;\n        },\n        toggleVideoPlay: function (pause) {\n            if (this.panorama instanceof VideoPanorama) {\n                this.panorama.dispatchEvent({\n                    type: 'video-toggle',\n                    pause: pause\n                });\n            }\n        },\n        setVideoCurrentTime: function (percentage) {\n            if (this.panorama instanceof VideoPanorama) {\n                this.panorama.dispatchEvent({\n                    type: 'video-time',\n                    percentage: percentage\n                });\n            }\n        },\n        onVideoUpdate: function (percentage) {\n            const {widget} = this;\n            if (widget) {\n                widget.dispatchEvent({\n                    type: 'video-update',\n                    percentage: percentage\n                });\n            }\n        },\n        addUpdateCallback: function (fn) {\n            if (fn) {\n                this.updateCallbacks.push(fn);\n            }\n        },\n        removeUpdateCallback: function (fn) {\n            const index = this.updateCallbacks.indexOf(fn);\n            if (fn && index >= 0) {\n                this.updateCallbacks.splice(index, 1);\n            }\n        },\n        showVideoWidget: function () {\n            const {widget} = this;\n            if (widget) {\n                widget.dispatchEvent({ type: 'video-control-show' });\n            }\n        },\n        hideVideoWidget: function () {\n            const {widget} = this;\n            if (widget) {\n                widget.dispatchEvent({ type: 'video-control-hide' });\n            }\n        },\n        updateVideoPlayButton: function (paused) {\n            const {widget} = this;\n            if (widget && widget.videoElement && widget.videoElement.controlButton) {\n                widget.videoElement.controlButton.update(paused);\n            }\n        },\n        addPanoramaEventListener: function (pano) {\n            pano.addEventListener('enter-fade-start', this.setCameraControl.bind(this));\n            if (pano instanceof VideoPanorama) {\n                pano.addEventListener('enter-fade-start', this.showVideoWidget.bind(this));\n                pano.addEventListener('leave', function () {\n                    if (!(this.panorama instanceof VideoPanorama)) {\n                        this.hideVideoWidget.call(this);\n                    }\n                }.bind(this));\n            }\n        },\n        setCameraControl: function () {\n            this.orbitControls.target.copy(this.panorama.position);\n        },\n        getControl: function () {\n            return this.control;\n        },\n        getScene: function () {\n            return this.scene;\n        },\n        getCamera: function () {\n            return this.camera;\n        },\n        getRenderer: function () {\n            return this.renderer;\n        },\n        getContainer: function () {\n            return this.container;\n        },\n        getControlId: function () {\n            return this.control.id;\n        },\n        getNextControlId: function () {\n            return this.controls[this.getNextControlIndex()].id;\n        },\n        getNextControlIndex: function () {\n            const controls = this.controls;\n            const control = this.control;\n            const nextIndex = controls.indexOf(control) + 1;\n            return nextIndex >= controls.length ? 0 : nextIndex;\n        },\n        setCameraFov: function (fov) {\n            this.camera.fov = fov;\n            this.camera.updateProjectionMatrix();\n        },\n        enableControl: function (index) {\n            index = index >= 0 && index < this.controls.length ? index : 0;\n            this.control.enabled = false;\n            this.control = this.controls[index];\n            this.control.enabled = true;\n            switch (index) {\n            case Constants.CONTROLS.ORBIT:\n                this.camera.position.copy(this.panorama.position);\n                this.camera.position.z += 1;\n                break;\n            case Constants.CONTROLS.DEVICEORIENTATION:\n                this.camera.position.copy(this.panorama.position);\n                break;\n            default:\n                break;\n            }\n            this.control.update();\n            this.activateWidgetItem(index, undefined);\n        },\n        disableControl: function () {\n            this.control.enabled = false;\n        },\n        toggleNextControl: function () {\n            this.enableControl(this.getNextControlIndex());\n        },\n        getScreenVector: function (worldVector) {\n            const vector = worldVector.clone();\n            const widthHalf = this.container.clientWidth / 2;\n            const heightHalf = this.container.clientHeight / 2;\n            vector.project(this.camera);\n            vector.x = vector.x * widthHalf + widthHalf;\n            vector.y = -(vector.y * heightHalf) + heightHalf;\n            vector.z = 0;\n            return vector;\n        },\n        checkSpriteInViewport: function (sprite) {\n            this.camera.matrixWorldInverse.getInverse(this.camera.matrixWorld);\n            this.cameraViewProjectionMatrix.multiplyMatrices(this.camera.projectionMatrix, this.camera.matrixWorldInverse);\n            this.cameraFrustum.setFromMatrix(this.cameraViewProjectionMatrix);\n            return sprite.visible && this.cameraFrustum.intersectsSprite(sprite);\n        },\n        reverseDraggingDirection: function () {\n            this.orbitControls.rotateSpeed *= -1;\n            this.orbitControls.momentumScalingFactor *= -1;\n        },\n        addReticle: function () {\n            this.reticle = new Reticle(16777215, true, this.options.dwellTime);\n            this.reticle.hide();\n            this.camera.add(this.reticle);\n            this.sceneReticle.add(this.camera);\n        },\n        tweenControlCenter: function (vector, duration, easing) {\n            if (this.control !== this.orbitControls) {\n                return;\n            }\n            if (vector instanceof Array) {\n                duration = vector[1];\n                easing = vector[2];\n                vector = vector[0];\n            }\n            duration = duration !== undefined ? duration : 1000;\n            easing = easing || TWEEN.Easing.Exponential.Out;\n            let scope, ha, va, chv, cvv, hv, vv, vptc, ov, nv;\n            scope = this;\n            chv = this.camera.getWorldDirection(new THREE.Vector3());\n            cvv = chv.clone();\n            vptc = this.panorama.getWorldPosition(new THREE.Vector3()).sub(this.camera.getWorldPosition(new THREE.Vector3()));\n            hv = vector.clone();\n            hv.x *= -1;\n            hv.add(vptc).normalize();\n            vv = hv.clone();\n            chv.y = 0;\n            hv.y = 0;\n            ha = Math.atan2(hv.z, hv.x) - Math.atan2(chv.z, chv.x);\n            ha = ha > Math.PI ? ha - 2 * Math.PI : ha;\n            ha = ha < -Math.PI ? ha + 2 * Math.PI : ha;\n            va = Math.abs(cvv.angleTo(chv) + (cvv.y * vv.y <= 0 ? vv.angleTo(hv) : -vv.angleTo(hv)));\n            va *= vv.y < cvv.y ? 1 : -1;\n            ov = {\n                left: 0,\n                up: 0\n            };\n            nv = {\n                left: 0,\n                up: 0\n            };\n            this.tweenLeftAnimation.stop();\n            this.tweenUpAnimation.stop();\n            this.tweenLeftAnimation = new TWEEN.Tween(ov).to({ left: ha }, duration).easing(easing).onUpdate(function (ov) {\n                scope.control.rotateLeft(ov.left - nv.left);\n                nv.left = ov.left;\n            }).start();\n            this.tweenUpAnimation = new TWEEN.Tween(ov).to({ up: va }, duration).easing(easing).onUpdate(function (ov) {\n                scope.control.rotateUp(ov.up - nv.up);\n                nv.up = ov.up;\n            }).start();\n        },\n        tweenControlCenterByObject: function (object, duration, easing) {\n            let isUnderScalePlaceHolder = false;\n            object.traverseAncestors(function (ancestor) {\n                if (ancestor.scalePlaceHolder) {\n                    isUnderScalePlaceHolder = true;\n                }\n            });\n            if (isUnderScalePlaceHolder) {\n                const invertXVector = new THREE.Vector3(-1, 1, 1);\n                this.tweenControlCenter(object.getWorldPosition(new THREE.Vector3()).multiply(invertXVector), duration, easing);\n            } else {\n                this.tweenControlCenter(object.getWorldPosition(new THREE.Vector3()), duration, easing);\n            }\n        },\n        onWindowResize: function (windowWidth, windowHeight) {\n            let width, height;\n            const expand = this.container.classList.contains('panolens-container') || this.container.isFullscreen;\n            if (windowWidth !== undefined && windowHeight !== undefined) {\n                width = windowWidth;\n                height = windowHeight;\n                this.container._width = windowWidth;\n                this.container._height = windowHeight;\n            } else {\n                const isAndroid = /(android)/i.test(window.navigator.userAgent);\n                const adjustWidth = isAndroid ? Math.min(document.documentElement.clientWidth, window.innerWidth || 0) : Math.max(document.documentElement.clientWidth, window.innerWidth || 0);\n                const adjustHeight = isAndroid ? Math.min(document.documentElement.clientHeight, window.innerHeight || 0) : Math.max(document.documentElement.clientHeight, window.innerHeight || 0);\n                width = expand ? adjustWidth : this.container.clientWidth;\n                height = expand ? adjustHeight : this.container.clientHeight;\n                this.container._width = width;\n                this.container._height = height;\n            }\n            this.camera.aspect = width / height;\n            this.camera.updateProjectionMatrix();\n            this.renderer.setSize(width, height);\n            if (this.options.enableReticle || this.tempEnableReticle) {\n                this.updateReticleEvent();\n            }\n            this.dispatchEvent({\n                type: 'window-resize',\n                width: width,\n                height: height\n            });\n            this.scene.traverse(function (object) {\n                if (object.dispatchEvent) {\n                    object.dispatchEvent({\n                        type: 'window-resize',\n                        width: width,\n                        height: height\n                    });\n                }\n            });\n        },\n        addOutputElement: function () {\n            const element = document.createElement('div');\n            element.style.position = 'absolute';\n            element.style.right = '10px';\n            element.style.top = '10px';\n            element.style.color = '#fff';\n            this.container.appendChild(element);\n            this.outputDivElement = element;\n        },\n        outputPosition: function () {\n            const intersects = this.raycaster.intersectObject(this.panorama, true);\n            if (intersects.length > 0) {\n                const point = intersects[0].point.clone();\n                const converter = new THREE.Vector3(-1, 1, 1);\n                const world = this.panorama.getWorldPosition(new THREE.Vector3());\n                point.sub(world).multiply(converter);\n                const message = `${ point.x.toFixed(2) }, ${ point.y.toFixed(2) }, ${ point.z.toFixed(2) }`;\n                if (point.length() === 0) {\n                    return;\n                }\n                switch (this.options.output) {\n                case 'console':\n                    console.info(message);\n                    break;\n                case 'overlay':\n                    this.outputDivElement.textContent = message;\n                    break;\n                default:\n                    break;\n                }\n            }\n        },\n        onMouseDown: function (event) {\n            event.preventDefault();\n            this.userMouse.x = event.clientX >= 0 ? event.clientX : event.touches[0].clientX;\n            this.userMouse.y = event.clientY >= 0 ? event.clientY : event.touches[0].clientY;\n            this.userMouse.type = 'mousedown';\n            this.onTap(event);\n        },\n        onMouseMove: function (event) {\n            event.preventDefault();\n            this.userMouse.type = 'mousemove';\n            this.onTap(event);\n        },\n        onMouseUp: function (event) {\n            let onTarget = false;\n            this.userMouse.type = 'mouseup';\n            const type = this.userMouse.x >= event.clientX - this.options.clickTolerance && this.userMouse.x <= event.clientX + this.options.clickTolerance && this.userMouse.y >= event.clientY - this.options.clickTolerance && this.userMouse.y <= event.clientY + this.options.clickTolerance || event.changedTouches && this.userMouse.x >= event.changedTouches[0].clientX - this.options.clickTolerance && this.userMouse.x <= event.changedTouches[0].clientX + this.options.clickTolerance && this.userMouse.y >= event.changedTouches[0].clientY - this.options.clickTolerance && this.userMouse.y <= event.changedTouches[0].clientY + this.options.clickTolerance ? 'click' : undefined;\n            if (event && event.target && !event.target.classList.contains('panolens-canvas')) {\n                return;\n            }\n            event.preventDefault();\n            if (event.changedTouches && event.changedTouches.length === 1) {\n                onTarget = this.onTap({\n                    clientX: event.changedTouches[0].clientX,\n                    clientY: event.changedTouches[0].clientY\n                }, type);\n            } else {\n                onTarget = this.onTap(event, type);\n            }\n            this.userMouse.type = 'none';\n            if (onTarget) {\n                return;\n            }\n            if (type === 'click') {\n                const {\n                    options: {autoHideInfospot, autoHideControlBar},\n                    panorama,\n                    toggleControlBar\n                } = this;\n                if (autoHideInfospot && panorama) {\n                    panorama.toggleInfospotVisibility();\n                }\n                if (autoHideControlBar) {\n                    toggleControlBar();\n                }\n            }\n        },\n        onTap: function (event, type) {\n            const {left, top} = this.container.getBoundingClientRect();\n            const {clientWidth, clientHeight} = this.container;\n            this.raycasterPoint.x = (event.clientX - left) / clientWidth * 2 - 1;\n            this.raycasterPoint.y = -((event.clientY - top) / clientHeight) * 2 + 1;\n            this.raycaster.setFromCamera(this.raycasterPoint, this.camera);\n            if (!this.panorama) {\n                return;\n            }\n            if (event.type !== 'mousedown' && this.touchSupported || this.OUTPUT_INFOSPOT) {\n                this.outputPosition();\n            }\n            const intersects = this.raycaster.intersectObjects(this.panorama.children, true);\n            const intersect_entity = this.getConvertedIntersect(intersects);\n            const intersect = intersects.length > 0 ? intersects[0].object : undefined;\n            if (this.userMouse.type === 'mouseup') {\n                if (intersect_entity && this.pressEntityObject === intersect_entity && this.pressEntityObject.dispatchEvent) {\n                    this.pressEntityObject.dispatchEvent({\n                        type: 'pressstop-entity',\n                        mouseEvent: event\n                    });\n                }\n                this.pressEntityObject = undefined;\n            }\n            if (this.userMouse.type === 'mouseup') {\n                if (intersect && this.pressObject === intersect && this.pressObject.dispatchEvent) {\n                    this.pressObject.dispatchEvent({\n                        type: 'pressstop',\n                        mouseEvent: event\n                    });\n                }\n                this.pressObject = undefined;\n            }\n            if (type === 'click') {\n                this.panorama.dispatchEvent({\n                    type: 'click',\n                    intersects: intersects,\n                    mouseEvent: event\n                });\n                if (intersect_entity && intersect_entity.dispatchEvent) {\n                    intersect_entity.dispatchEvent({\n                        type: 'click-entity',\n                        mouseEvent: event\n                    });\n                }\n                if (intersect && intersect.dispatchEvent) {\n                    intersect.dispatchEvent({\n                        type: 'click',\n                        mouseEvent: event\n                    });\n                }\n            } else {\n                this.panorama.dispatchEvent({\n                    type: 'hover',\n                    intersects: intersects,\n                    mouseEvent: event\n                });\n                if (this.hoverObject && intersects.length > 0 && this.hoverObject !== intersect_entity || this.hoverObject && intersects.length === 0) {\n                    if (this.hoverObject.dispatchEvent) {\n                        this.hoverObject.dispatchEvent({\n                            type: 'hoverleave',\n                            mouseEvent: event\n                        });\n                        this.reticle.end();\n                    }\n                    this.hoverObject = undefined;\n                }\n                if (intersect_entity && intersects.length > 0) {\n                    if (this.hoverObject !== intersect_entity) {\n                        this.hoverObject = intersect_entity;\n                        if (this.hoverObject.dispatchEvent) {\n                            this.hoverObject.dispatchEvent({\n                                type: 'hoverenter',\n                                mouseEvent: event\n                            });\n                            if (this.options.autoReticleSelect && this.options.enableReticle || this.tempEnableReticle) {\n                                this.reticle.start(this.onTap.bind(this, event, 'click'));\n                            }\n                        }\n                    }\n                    if (this.userMouse.type === 'mousedown' && this.pressEntityObject != intersect_entity) {\n                        this.pressEntityObject = intersect_entity;\n                        if (this.pressEntityObject.dispatchEvent) {\n                            this.pressEntityObject.dispatchEvent({\n                                type: 'pressstart-entity',\n                                mouseEvent: event\n                            });\n                        }\n                    }\n                    if (this.userMouse.type === 'mousedown' && this.pressObject != intersect) {\n                        this.pressObject = intersect;\n                        if (this.pressObject.dispatchEvent) {\n                            this.pressObject.dispatchEvent({\n                                type: 'pressstart',\n                                mouseEvent: event\n                            });\n                        }\n                    }\n                    if (this.userMouse.type === 'mousemove' || this.options.enableReticle) {\n                        if (intersect && intersect.dispatchEvent) {\n                            intersect.dispatchEvent({\n                                type: 'hover',\n                                mouseEvent: event\n                            });\n                        }\n                        if (this.pressEntityObject && this.pressEntityObject.dispatchEvent) {\n                            this.pressEntityObject.dispatchEvent({\n                                type: 'pressmove-entity',\n                                mouseEvent: event\n                            });\n                        }\n                        if (this.pressObject && this.pressObject.dispatchEvent) {\n                            this.pressObject.dispatchEvent({\n                                type: 'pressmove',\n                                mouseEvent: event\n                            });\n                        }\n                    }\n                }\n                if (!intersect_entity && this.pressEntityObject && this.pressEntityObject.dispatchEvent) {\n                    this.pressEntityObject.dispatchEvent({\n                        type: 'pressstop-entity',\n                        mouseEvent: event\n                    });\n                    this.pressEntityObject = undefined;\n                }\n                if (!intersect && this.pressObject && this.pressObject.dispatchEvent) {\n                    this.pressObject.dispatchEvent({\n                        type: 'pressstop',\n                        mouseEvent: event\n                    });\n                    this.pressObject = undefined;\n                }\n            }\n            if (intersect && intersect instanceof Infospot) {\n                this.infospot = intersect;\n                if (type === 'click') {\n                    return true;\n                }\n            } else if (this.infospot) {\n                this.hideInfospot();\n            }\n            if (this.options.autoRotate && this.userMouse.type !== 'mousemove') {\n                clearTimeout(this.autoRotateRequestId);\n                if (this.control === this.orbitControls) {\n                    this.orbitControls.autoRotate = false;\n                    this.autoRotateRequestId = window.setTimeout(this.enableAutoRate.bind(this), this.options.autoRotateActivationDuration);\n                }\n            }\n        },\n        getConvertedIntersect: function (intersects) {\n            let intersect;\n            for (let i = 0; i < intersects.length; i++) {\n                if (intersects[i].distance >= 0 && intersects[i].object && !intersects[i].object.passThrough) {\n                    if (intersects[i].object.entity && intersects[i].object.entity.passThrough) {\n                        continue;\n                    } else if (intersects[i].object.entity && !intersects[i].object.entity.passThrough) {\n                        intersect = intersects[i].object.entity;\n                        break;\n                    } else {\n                        intersect = intersects[i].object;\n                        break;\n                    }\n                }\n            }\n            return intersect;\n        },\n        hideInfospot: function () {\n            if (this.infospot) {\n                this.infospot.onHoverEnd();\n                this.infospot = undefined;\n            }\n        },\n        toggleControlBar: function () {\n            const {widget} = this;\n            if (widget) {\n                widget.dispatchEvent({ type: 'control-bar-toggle' });\n            }\n        },\n        onKeyDown: function (event) {\n            if (this.options.output && this.options.output !== 'none' && event.key === 'Control') {\n                this.OUTPUT_INFOSPOT = true;\n            }\n        },\n        onKeyUp: function () {\n            this.OUTPUT_INFOSPOT = false;\n        },\n        update: function () {\n            TWEEN.update();\n            this.updateCallbacks.forEach(function (callback) {\n                callback();\n            });\n            this.control.update();\n            this.scene.traverse(function (child) {\n                if (child instanceof Infospot && child.element && (this.hoverObject === child || child.element.style.display !== 'none' || child.element.left && child.element.left.style.display !== 'none' || child.element.right && child.element.right.style.display !== 'none')) {\n                    if (this.checkSpriteInViewport(child)) {\n                        const {x, y} = this.getScreenVector(child.getWorldPosition(new THREE.Vector3()));\n                        child.translateElement(x, y);\n                    } else {\n                        child.onDismiss();\n                    }\n                }\n            }.bind(this));\n        },\n        render: function () {\n            if (this.mode === Constants.MODES.CARDBOARD || this.mode === Constants.MODES.STEREO) {\n                this.renderer.clear();\n                this.effect.render(this.scene, this.camera);\n                this.effect.render(this.sceneReticle, this.camera);\n            } else {\n                this.renderer.clear();\n                this.renderer.render(this.scene, this.camera);\n                this.renderer.clearDepth();\n                this.renderer.render(this.sceneReticle, this.camera);\n            }\n        },\n        animate: function () {\n            this.requestAnimationId = window.requestAnimationFrame(this.animate.bind(this));\n            this.onChange();\n        },\n        onChange: function () {\n            this.update();\n            this.render();\n        },\n        registerMouseAndTouchEvents: function () {\n            const options = { passive: false };\n            this.container.addEventListener('mousedown', this.HANDLER_MOUSE_DOWN, options);\n            this.container.addEventListener('mousemove', this.HANDLER_MOUSE_MOVE, options);\n            this.container.addEventListener('mouseup', this.HANDLER_MOUSE_UP, options);\n            this.container.addEventListener('touchstart', this.HANDLER_MOUSE_DOWN, options);\n            this.container.addEventListener('touchend', this.HANDLER_MOUSE_UP, options);\n        },\n        unregisterMouseAndTouchEvents: function () {\n            this.container.removeEventListener('mousedown', this.HANDLER_MOUSE_DOWN, false);\n            this.container.removeEventListener('mousemove', this.HANDLER_MOUSE_MOVE, false);\n            this.container.removeEventListener('mouseup', this.HANDLER_MOUSE_UP, false);\n            this.container.removeEventListener('touchstart', this.HANDLER_MOUSE_DOWN, false);\n            this.container.removeEventListener('touchend', this.HANDLER_MOUSE_UP, false);\n        },\n        registerReticleEvent: function () {\n            this.addUpdateCallback(this.HANDLER_TAP);\n        },\n        unregisterReticleEvent: function () {\n            this.removeUpdateCallback(this.HANDLER_TAP);\n        },\n        updateReticleEvent: function () {\n            const clientX = this.container.clientWidth / 2 + this.container.offsetLeft;\n            const clientY = this.container.clientHeight / 2;\n            this.removeUpdateCallback(this.HANDLER_TAP);\n            this.HANDLER_TAP = this.onTap.bind(this, {\n                clientX,\n                clientY\n            });\n            this.addUpdateCallback(this.HANDLER_TAP);\n        },\n        registerEventListeners: function () {\n            window.addEventListener('resize', this.HANDLER_WINDOW_RESIZE, true);\n            window.addEventListener('keydown', this.HANDLER_KEY_DOWN, true);\n            window.addEventListener('keyup', this.HANDLER_KEY_UP, true);\n        },\n        unregisterEventListeners: function () {\n            window.removeEventListener('resize', this.HANDLER_WINDOW_RESIZE, true);\n            window.removeEventListener('keydown', this.HANDLER_KEY_DOWN, true);\n            window.removeEventListener('keyup', this.HANDLER_KEY_UP, true);\n        },\n        dispose: function () {\n            this.tweenLeftAnimation.stop();\n            this.tweenUpAnimation.stop();\n            this.unregisterEventListeners();\n            function recursiveDispose(object) {\n                for (let i = object.children.length - 1; i >= 0; i--) {\n                    recursiveDispose(object.children[i]);\n                    object.remove(object.children[i]);\n                }\n                if (object instanceof Panorama || object instanceof Infospot) {\n                    object.dispose();\n                    object = null;\n                } else if (object.dispatchEvent) {\n                    object.dispatchEvent('dispose');\n                }\n            }\n            recursiveDispose(this.scene);\n            if (this.widget) {\n                this.widget.dispose();\n                this.widget = null;\n            }\n            if (THREE.Cache && THREE.Cache.enabled) {\n                THREE.Cache.clear();\n            }\n        },\n        destroy: function () {\n            this.dispose();\n            this.render();\n            window.cancelAnimationFrame(this.requestAnimationId);\n        },\n        onPanoramaDispose: function (panorama) {\n            if (panorama instanceof VideoPanorama) {\n                this.hideVideoWidget();\n            }\n            if (panorama === this.panorama) {\n                this.panorama = null;\n            }\n        },\n        loadAsyncRequest: function (url, callback = () => {\n        }) {\n            const request = new window.XMLHttpRequest();\n            request.onloadend = function (event) {\n                callback(event);\n            };\n            request.open('GET', url, true);\n            request.send(null);\n        },\n        addViewIndicator: function () {\n            const scope = this;\n            function loadViewIndicator(asyncEvent) {\n                if (asyncEvent.loaded === 0)\n                    return;\n                const viewIndicatorDiv = asyncEvent.target.responseXML.documentElement;\n                viewIndicatorDiv.style.width = scope.viewIndicatorSize + 'px';\n                viewIndicatorDiv.style.height = scope.viewIndicatorSize + 'px';\n                viewIndicatorDiv.style.position = 'absolute';\n                viewIndicatorDiv.style.top = '10px';\n                viewIndicatorDiv.style.left = '10px';\n                viewIndicatorDiv.style.opacity = '0.5';\n                viewIndicatorDiv.style.cursor = 'pointer';\n                viewIndicatorDiv.id = 'panolens-view-indicator-container';\n                scope.container.appendChild(viewIndicatorDiv);\n                const indicator = viewIndicatorDiv.querySelector('#indicator');\n                const setIndicatorD = function () {\n                    scope.radius = scope.viewIndicatorSize * 0.225;\n                    scope.currentPanoAngle = scope.camera.rotation.y - THREE.Math.degToRad(90);\n                    scope.fovAngle = THREE.Math.degToRad(scope.camera.fov);\n                    scope.leftAngle = -scope.currentPanoAngle - scope.fovAngle / 2;\n                    scope.rightAngle = -scope.currentPanoAngle + scope.fovAngle / 2;\n                    scope.leftX = scope.radius * Math.cos(scope.leftAngle);\n                    scope.leftY = scope.radius * Math.sin(scope.leftAngle);\n                    scope.rightX = scope.radius * Math.cos(scope.rightAngle);\n                    scope.rightY = scope.radius * Math.sin(scope.rightAngle);\n                    scope.indicatorD = 'M ' + scope.leftX + ' ' + scope.leftY + ' A ' + scope.radius + ' ' + scope.radius + ' 0 0 1 ' + scope.rightX + ' ' + scope.rightY;\n                    if (scope.leftX && scope.leftY && scope.rightX && scope.rightY && scope.radius) {\n                        indicator.setAttribute('d', scope.indicatorD);\n                    }\n                };\n                scope.addUpdateCallback(setIndicatorD);\n                const indicatorOnMouseEnter = function () {\n                    this.style.opacity = '1';\n                };\n                const indicatorOnMouseLeave = function () {\n                    this.style.opacity = '0.5';\n                };\n                viewIndicatorDiv.addEventListener('mouseenter', indicatorOnMouseEnter);\n                viewIndicatorDiv.addEventListener('mouseleave', indicatorOnMouseLeave);\n            }\n            this.loadAsyncRequest(DataImage.ViewIndicator, loadViewIndicator);\n        },\n        appendControlItem: function (option) {\n            const item = this.widget.createCustomItem(option);\n            if (option.group === 'video') {\n                this.widget.videoElement.appendChild(item);\n            } else {\n                this.widget.barElement.appendChild(item);\n            }\n            return item;\n        },\n        clearAllCache: function () {\n            THREE.Cache.clear();\n        }\n    });\n    return panolens.Viewer = Viewer;\n});\ndefine('skylark-panolens/loaders/CubeTextureLoader',[\n    './ImageLoader',\n    'skylark-threejs'\n], function (ImageLoader, THREE) {\n    'use strict';\n    const CubeTextureLoader = {\n        load: function (urls, onLoad = () => {\n        }, onProgress = () => {\n        }, onError) {\n            var texture, loaded, progress, all, loadings;\n            texture = new THREE.CubeTexture([]);\n            loaded = 0;\n            progress = {};\n            all = {};\n            urls.map(function (url, index) {\n                ImageLoader.load(url, function (image) {\n                    texture.images[index] = image;\n                    loaded++;\n                    if (loaded === 6) {\n                        texture.needsUpdate = true;\n                        onLoad(texture);\n                    }\n                }, function (event) {\n                    progress[index] = {\n                        loaded: event.loaded,\n                        total: event.total\n                    };\n                    all.loaded = 0;\n                    all.total = 0;\n                    loadings = 0;\n                    for (var i in progress) {\n                        loadings++;\n                        all.loaded += progress[i].loaded;\n                        all.total += progress[i].total;\n                    }\n                    if (loadings < 6) {\n                        all.total = all.total / loadings * 6;\n                    }\n                    onProgress(all);\n                }, onError);\n            });\n            return texture;\n        }\n    };\n    return CubeTextureLoader;\n});\ndefine('skylark-panolens/panorama/ImagePanorama',[\n    './Panorama',\n    '../loaders/TextureLoader',\n    'skylark-threejs'\n], function (Panorama, TextureLoader, THREE) {\n    'use strict';\n    function ImagePanorama(image, _geometry, _material) {\n        const radius = 5000;\n        const geometry = _geometry || new THREE.SphereBufferGeometry(radius, 60, 40);\n        const material = _material || new THREE.MeshBasicMaterial({\n            opacity: 0,\n            transparent: true\n        });\n        Panorama.call(this, geometry, material);\n        this.src = image;\n        this.radius = radius;\n    }\n    ImagePanorama.prototype = Object.assign(Object.create(Panorama.prototype), {\n        constructor: ImagePanorama,\n        load: function (src) {\n            src = src || this.src;\n            if (!src) {\n                console.warn('Image source undefined');\n                return;\n            } else if (typeof src === 'string') {\n                TextureLoader.load(src, this.onLoad.bind(this), this.onProgress.bind(this), this.onError.bind(this));\n            } else if (src instanceof HTMLImageElement) {\n                this.onLoad(new THREE.Texture(src));\n            }\n        },\n        onLoad: function (texture) {\n            texture.minFilter = texture.magFilter = THREE.LinearFilter;\n            texture.needsUpdate = true;\n            this.updateTexture(texture);\n            window.requestAnimationFrame(Panorama.prototype.onLoad.bind(this));\n        },\n        reset: function () {\n            Panorama.prototype.reset.call(this);\n        },\n        dispose: function () {\n            const {\n                material: {map}\n            } = this;\n            THREE.Cache.remove(this.src);\n            if (map) {\n                map.dispose();\n            }\n            Panorama.prototype.dispose.call(this);\n        }\n    });\n    return ImagePanorama;\n});\ndefine('skylark-panolens/panorama/EmptyPanorama',[\n    './Panorama',\n    'skylark-threejs'\n], function (Panorama, THREE) {\n    'use strict';\n    function EmptyPanorama() {\n        const geometry = new THREE.BufferGeometry();\n        const material = new THREE.MeshBasicMaterial({\n            color: 0,\n            opacity: 0,\n            transparent: true\n        });\n        geometry.addAttribute('position', new THREE.BufferAttribute(new Float32Array(), 1));\n        Panorama.call(this, geometry, material);\n    }\n    EmptyPanorama.prototype = Object.assign(Object.create(Panorama.prototype), { constructor: EmptyPanorama });\n    return EmptyPanorama;\n});\ndefine('skylark-panolens/panorama/CubePanorama',[\n    './Panorama',\n    '../loaders/CubeTextureLoader',\n    'skylark-threejs'\n], function (Panorama, CubeTextureLoader, THREE) {\n    'use strict';\n    function CubePanorama(images = []) {\n        const edgeLength = 10000;\n        const shader = Object.assign({}, THREE.ShaderLib['cube']);\n        const geometry = new THREE.BoxBufferGeometry(edgeLength, edgeLength, edgeLength);\n        const material = new THREE.ShaderMaterial({\n            fragmentShader: shader.fragmentShader,\n            vertexShader: shader.vertexShader,\n            uniforms: shader.uniforms,\n            side: THREE.BackSide,\n            transparent: true\n        });\n        Panorama.call(this, geometry, material);\n        this.images = images;\n        this.edgeLength = edgeLength;\n        this.material.uniforms.opacity.value = 0;\n    }\n    CubePanorama.prototype = Object.assign(Object.create(Panorama.prototype), {\n        constructor: CubePanorama,\n        load: function () {\n            CubeTextureLoader.load(this.images, this.onLoad.bind(this), this.onProgress.bind(this), this.onError.bind(this));\n        },\n        onLoad: function (texture) {\n            this.material.uniforms['tCube'].value = texture;\n            Panorama.prototype.onLoad.call(this);\n        },\n        dispose: function () {\n            const {value} = this.material.uniforms.tCube;\n            this.images.forEach(image => {\n                THREE.Cache.remove(image);\n            });\n            if (value instanceof THREE.CubeTexture) {\n                value.dispose();\n            }\n            Panorama.prototype.dispose.call(this);\n        }\n    });\n    return CubePanorama;\n});\ndefine('skylark-panolens/panorama/BasicPanorama',[\n    './CubePanorama',\n    '../DataImage'\n], function (CubePanorama, DataImage) {\n    'use strict';\n    function BasicPanorama() {\n        const images = [];\n        for (let i = 0; i < 6; i++) {\n            images.push(DataImage.WhiteTile);\n        }\n        CubePanorama.call(this, images);\n    }\n    BasicPanorama.prototype = Object.assign(Object.create(CubePanorama.prototype), { constructor: BasicPanorama });\n    return BasicPanorama;\n});\ndefine('skylark-panolens/loaders/GoogleStreetviewLoader',['./TextureLoader'], function (TextureLoader) {\n    'use strict';\n    function GoogleStreetviewLoader(parameters = {}) {\n        this._parameters = parameters;\n        this._zoom = null;\n        this._panoId = null;\n        this._panoClient = new google.maps.StreetViewService();\n        this._count = 0;\n        this._total = 0;\n        this._canvas = [];\n        this._ctx = [];\n        this._wc = 0;\n        this._hc = 0;\n        this.result = null;\n        this.rotation = 0;\n        this.copyright = '';\n        this.onSizeChange = null;\n        this.onPanoramaLoad = null;\n        this.levelsW = [\n            1,\n            2,\n            4,\n            7,\n            13,\n            26\n        ];\n        this.levelsH = [\n            1,\n            1,\n            2,\n            4,\n            7,\n            13\n        ];\n        this.widths = [\n            416,\n            832,\n            1664,\n            3328,\n            6656,\n            13312\n        ];\n        this.heights = [\n            416,\n            416,\n            832,\n            1664,\n            3328,\n            6656\n        ];\n        this.maxW = 6656;\n        this.maxH = 6656;\n        let gl;\n        try {\n            const canvas = document.createElement('canvas');\n            gl = canvas.getContext('experimental-webgl');\n            if (!gl) {\n                gl = canvas.getContext('webgl');\n            }\n        } catch (error) {\n        }\n        this.maxW = Math.max(gl.getParameter(gl.MAX_TEXTURE_SIZE), this.maxW);\n        this.maxH = Math.max(gl.getParameter(gl.MAX_TEXTURE_SIZE), this.maxH);\n    }\n    Object.assign(GoogleStreetviewLoader.prototype, {\n        constructor: GoogleStreetviewLoader,\n        setProgress: function (loaded, total) {\n            if (this.onProgress) {\n                this.onProgress({\n                    loaded: loaded,\n                    total: total\n                });\n            }\n        },\n        adaptTextureToZoom: function () {\n            const w = this.widths[this._zoom];\n            const h = this.heights[this._zoom];\n            const maxW = this.maxW;\n            const maxH = this.maxH;\n            this._wc = Math.ceil(w / maxW);\n            this._hc = Math.ceil(h / maxH);\n            for (let y = 0; y < this._hc; y++) {\n                for (let x = 0; x < this._wc; x++) {\n                    const c = document.createElement('canvas');\n                    if (x < this._wc - 1)\n                        c.width = maxW;\n                    else\n                        c.width = w - maxW * x;\n                    if (y < this._hc - 1)\n                        c.height = maxH;\n                    else\n                        c.height = h - maxH * y;\n                    this._canvas.push(c);\n                    this._ctx.push(c.getContext('2d'));\n                }\n            }\n        },\n        composeFromTile: function (x, y, texture) {\n            const maxW = this.maxW;\n            const maxH = this.maxH;\n            x *= 512;\n            y *= 512;\n            const px = Math.floor(x / maxW);\n            const py = Math.floor(y / maxH);\n            x -= px * maxW;\n            y -= py * maxH;\n            this._ctx[py * this._wc + px].drawImage(texture, 0, 0, texture.width, texture.height, x, y, 512, 512);\n            this.progress();\n        },\n        progress: function () {\n            this._count++;\n            this.setProgress(this._count, this._total);\n            if (this._count === this._total) {\n                this.canvas = this._canvas;\n                this.panoId = this._panoId;\n                this.zoom = this._zoom;\n                if (this.onPanoramaLoad) {\n                    this.onPanoramaLoad(this._canvas[0]);\n                }\n            }\n        },\n        composePanorama: function () {\n            this.setProgress(0, 1);\n            const w = this.levelsW[this._zoom];\n            const h = this.levelsH[this._zoom];\n            const self = this;\n            this._count = 0;\n            this._total = w * h;\n            const {useWebGL} = this._parameters;\n            for (let y = 0; y < h; y++) {\n                for (let x = 0; x < w; x++) {\n                    const url = 'https://geo0.ggpht.com/cbk?cb_client=maps_sv.tactile&authuser=0&hl=en&output=tile&zoom=' + this._zoom + '&x=' + x + '&y=' + y + '&panoid=' + this._panoId + '&nbt&fover=2';\n                    (function (x, y) {\n                        if (useWebGL) {\n                            const texture = TextureLoader.load(url, null, function () {\n                                self.composeFromTile(x, y, texture);\n                            });\n                        } else {\n                            const img = new Image();\n                            img.addEventListener('load', function () {\n                                self.composeFromTile(x, y, this);\n                            });\n                            img.crossOrigin = '';\n                            img.src = url;\n                        }\n                    }(x, y));\n                }\n            }\n        },\n        load: function (panoid) {\n            this.loadPano(panoid);\n        },\n        loadPano: function (id) {\n            const self = this;\n            this._panoClient.getPanoramaById(id, function (result, status) {\n                if (status === google.maps.StreetViewStatus.OK) {\n                    self.result = result;\n                    self.copyright = result.copyright;\n                    self._panoId = result.location.pano;\n                    self.composePanorama();\n                }\n            });\n        },\n        setZoom: function (z) {\n            this._zoom = z;\n            this.adaptTextureToZoom();\n        }\n    });\n    return GoogleStreetviewLoader;\n});\ndefine('skylark-panolens/panorama/GoogleStreetviewPanorama',[\n    './ImagePanorama',\n    '../loaders/GoogleStreetviewLoader',\n    'skylark-threejs'\n], function (ImagePanorama, GoogleStreetviewLoader, THREE) {\n    'use strict';\n    function GoogleStreetviewPanorama(panoId, apiKey) {\n        ImagePanorama.call(this);\n        this.panoId = panoId;\n        this.gsvLoader = null;\n        this.loadRequested = false;\n        this.setupGoogleMapAPI(apiKey);\n    }\n    GoogleStreetviewPanorama.prototype = Object.assign(Object.create(ImagePanorama.prototype), {\n        constructor: GoogleStreetviewPanorama,\n        load: function (panoId) {\n            this.loadRequested = true;\n            panoId = panoId || this.panoId || {};\n            if (panoId && this.gsvLoader) {\n                this.loadGSVLoader(panoId);\n            }\n        },\n        setupGoogleMapAPI: function (apiKey) {\n            const script = document.createElement('script');\n            script.src = 'https://maps.googleapis.com/maps/api/js?';\n            script.src += apiKey ? 'key=' + apiKey : '';\n            script.onreadystatechange = this.setGSVLoader.bind(this);\n            script.onload = this.setGSVLoader.bind(this);\n            document.querySelector('head').appendChild(script);\n        },\n        setGSVLoader: function () {\n            this.gsvLoader = new GoogleStreetviewLoader();\n            if (this.loadRequested) {\n                this.load();\n            }\n        },\n        getGSVLoader: function () {\n            return this.gsvLoader;\n        },\n        loadGSVLoader: function (panoId) {\n            this.loadRequested = false;\n            this.gsvLoader.onProgress = this.onProgress.bind(this);\n            this.gsvLoader.onPanoramaLoad = this.onLoad.bind(this);\n            this.gsvLoader.setZoom(this.getZoomLevel());\n            this.gsvLoader.load(panoId);\n            this.gsvLoader.loaded = true;\n        },\n        onLoad: function (canvas) {\n            ImagePanorama.prototype.onLoad.call(this, new THREE.Texture(canvas));\n        },\n        reset: function () {\n            this.gsvLoader = undefined;\n            ImagePanorama.prototype.reset.call(this);\n        }\n    });\n    return GoogleStreetviewPanorama;\n});\ndefine('skylark-panolens/shaders/StereographicShader',['skylark-threejs'], function (THREE) {\n    'use strict';\n    const StereographicShader = {\n        uniforms: {\n            'tDiffuse': { value: new THREE.Texture() },\n            'resolution': { value: 1 },\n            'transform': { value: new THREE.Matrix4() },\n            'zoom': { value: 1 },\n            'opacity': { value: 1 }\n        },\n        vertexShader: [\n            'varying vec2 vUv;',\n            'void main() {',\n            'vUv = uv;',\n            'gl_Position = vec4( position, 1.0 );',\n            '}'\n        ].join('\\n'),\n        fragmentShader: [\n            'uniform sampler2D tDiffuse;',\n            'uniform float resolution;',\n            'uniform mat4 transform;',\n            'uniform float zoom;',\n            'uniform float opacity;',\n            'varying vec2 vUv;',\n            'const float PI = 3.141592653589793;',\n            'void main(){',\n            'vec2 position = -1.0 +  2.0 * vUv;',\n            'position *= vec2( zoom * resolution, zoom * 0.5 );',\n            'float x2y2 = position.x * position.x + position.y * position.y;',\n            'vec3 sphere_pnt = vec3( 2. * position, x2y2 - 1. ) / ( x2y2 + 1. );',\n            'sphere_pnt = vec3( transform * vec4( sphere_pnt, 1.0 ) );',\n            'vec2 sampleUV = vec2(',\n            '(atan(sphere_pnt.y, sphere_pnt.x) / PI + 1.0) * 0.5,',\n            '(asin(sphere_pnt.z) / PI + 0.5)',\n            ');',\n            'gl_FragColor = texture2D( tDiffuse, sampleUV );',\n            'gl_FragColor.a *= opacity;',\n            '}'\n        ].join('\\n')\n    };\n    return StereographicShader;\n});\ndefine('skylark-panolens/panorama/LittlePlanet',[\n    './ImagePanorama',\n    '../infospot/Infospot',\n    '../Constants',\n    '../shaders/StereographicShader',\n    'skylark-threejs'\n], function (ImagePanorama, Infospot, Constants, StereographicShader, THREE) {\n    'use strict';\n    function LittlePlanet(type = 'image', source, size = 10000, ratio = 0.5) {\n        if (type === 'image') {\n            ImagePanorama.call(this, source, this.createGeometry(size, ratio), this.createMaterial(size));\n        }\n        this.size = size;\n        this.ratio = ratio;\n        this.EPS = 0.000001;\n        this.frameId = null;\n        this.dragging = false;\n        this.userMouse = new THREE.Vector2();\n        this.quatA = new THREE.Quaternion();\n        this.quatB = new THREE.Quaternion();\n        this.quatCur = new THREE.Quaternion();\n        this.quatSlerp = new THREE.Quaternion();\n        this.vectorX = new THREE.Vector3(1, 0, 0);\n        this.vectorY = new THREE.Vector3(0, 1, 0);\n        this.addEventListener('window-resize', this.onWindowResize);\n    }\n    LittlePlanet.prototype = Object.assign(Object.create(ImagePanorama.prototype), {\n        constructor: LittlePlanet,\n        add: function (object) {\n            if (arguments.length > 1) {\n                for (let i = 0; i < arguments.length; i++) {\n                    this.add(arguments[i]);\n                }\n                return this;\n            }\n            if (object instanceof Infospot) {\n                object.material.depthTest = false;\n            }\n            ImagePanorama.prototype.add.call(this, object);\n        },\n        createGeometry: function (size, ratio) {\n            return new THREE.PlaneBufferGeometry(size, size * ratio);\n        },\n        createMaterial: function (size) {\n            const shader = Object.assign({}, StereographicShader), uniforms = shader.uniforms;\n            uniforms.zoom.value = size;\n            uniforms.opacity.value = 0;\n            return new THREE.ShaderMaterial({\n                uniforms: uniforms,\n                vertexShader: shader.vertexShader,\n                fragmentShader: shader.fragmentShader,\n                side: THREE.BackSide,\n                transparent: true\n            });\n        },\n        registerMouseEvents: function () {\n            this.container.addEventListener('mousedown', this.onMouseDown.bind(this), { passive: true });\n            this.container.addEventListener('mousemove', this.onMouseMove.bind(this), { passive: true });\n            this.container.addEventListener('mouseup', this.onMouseUp.bind(this), { passive: true });\n            this.container.addEventListener('touchstart', this.onMouseDown.bind(this), { passive: true });\n            this.container.addEventListener('touchmove', this.onMouseMove.bind(this), { passive: true });\n            this.container.addEventListener('touchend', this.onMouseUp.bind(this), { passive: true });\n            this.container.addEventListener('mousewheel', this.onMouseWheel.bind(this), { passive: false });\n            this.container.addEventListener('DOMMouseScroll', this.onMouseWheel.bind(this), { passive: false });\n            this.container.addEventListener('contextmenu', this.onContextMenu.bind(this), { passive: true });\n        },\n        unregisterMouseEvents: function () {\n            this.container.removeEventListener('mousedown', this.onMouseDown.bind(this), false);\n            this.container.removeEventListener('mousemove', this.onMouseMove.bind(this), false);\n            this.container.removeEventListener('mouseup', this.onMouseUp.bind(this), false);\n            this.container.removeEventListener('touchstart', this.onMouseDown.bind(this), false);\n            this.container.removeEventListener('touchmove', this.onMouseMove.bind(this), false);\n            this.container.removeEventListener('touchend', this.onMouseUp.bind(this), false);\n            this.container.removeEventListener('mousewheel', this.onMouseWheel.bind(this), false);\n            this.container.removeEventListener('DOMMouseScroll', this.onMouseWheel.bind(this), false);\n            this.container.removeEventListener('contextmenu', this.onContextMenu.bind(this), false);\n        },\n        onMouseDown: function (event) {\n            const inputCount = event.touches && event.touches.length || 1;\n            switch (inputCount) {\n            case 1:\n                const x = event.clientX >= 0 ? event.clientX : event.touches[0].clientX;\n                const y = event.clientY >= 0 ? event.clientY : event.touches[0].clientY;\n                this.dragging = true;\n                this.userMouse.set(x, y);\n                break;\n            case 2:\n                const dx = event.touches[0].pageX - event.touches[1].pageX;\n                const dy = event.touches[0].pageY - event.touches[1].pageY;\n                const distance = Math.sqrt(dx * dx + dy * dy);\n                this.userMouse.pinchDistance = distance;\n                break;\n            default:\n                break;\n            }\n            this.onUpdateCallback();\n        },\n        onMouseMove: function (event) {\n            const inputCount = event.touches && event.touches.length || 1;\n            switch (inputCount) {\n            case 1:\n                const x = event.clientX >= 0 ? event.clientX : event.touches[0].clientX;\n                const y = event.clientY >= 0 ? event.clientY : event.touches[0].clientY;\n                const angleX = THREE.Math.degToRad(x - this.userMouse.x) * 0.4;\n                const angleY = THREE.Math.degToRad(y - this.userMouse.y) * 0.4;\n                if (this.dragging) {\n                    this.quatA.setFromAxisAngle(this.vectorY, angleX);\n                    this.quatB.setFromAxisAngle(this.vectorX, angleY);\n                    this.quatCur.multiply(this.quatA).multiply(this.quatB);\n                    this.userMouse.set(x, y);\n                }\n                break;\n            case 2:\n                const dx = event.touches[0].pageX - event.touches[1].pageX;\n                const dy = event.touches[0].pageY - event.touches[1].pageY;\n                const distance = Math.sqrt(dx * dx + dy * dy);\n                this.addZoomDelta(this.userMouse.pinchDistance - distance);\n                break;\n            default:\n                break;\n            }\n        },\n        onMouseUp: function () {\n            this.dragging = false;\n        },\n        onMouseWheel: function (event) {\n            event.preventDefault();\n            event.stopPropagation();\n            let delta = 0;\n            if (event.wheelDelta !== undefined) {\n                delta = event.wheelDelta;\n            } else if (event.detail !== undefined) {\n                delta = -event.detail;\n            }\n            this.addZoomDelta(delta);\n            this.onUpdateCallback();\n        },\n        addZoomDelta: function (delta) {\n            const uniforms = this.material.uniforms;\n            const lowerBound = this.size * 0.1;\n            const upperBound = this.size * 10;\n            uniforms.zoom.value += delta;\n            if (uniforms.zoom.value <= lowerBound) {\n                uniforms.zoom.value = lowerBound;\n            } else if (uniforms.zoom.value >= upperBound) {\n                uniforms.zoom.value = upperBound;\n            }\n        },\n        onUpdateCallback: function () {\n            this.frameId = window.requestAnimationFrame(this.onUpdateCallback.bind(this));\n            this.quatSlerp.slerp(this.quatCur, 0.1);\n            if (this.material) {\n                this.material.uniforms.transform.value.makeRotationFromQuaternion(this.quatSlerp);\n            }\n            if (!this.dragging && 1 - this.quatSlerp.clone().dot(this.quatCur) < this.EPS) {\n                window.cancelAnimationFrame(this.frameId);\n            }\n        },\n        reset: function () {\n            this.quatCur.set(0, 0, 0, 1);\n            this.quatSlerp.set(0, 0, 0, 1);\n            this.onUpdateCallback();\n        },\n        onLoad: function (texture) {\n            this.material.uniforms.resolution.value = this.container.clientWidth / this.container.clientHeight;\n            this.registerMouseEvents();\n            this.onUpdateCallback();\n            this.dispatchEvent({\n                type: 'panolens-viewer-handler',\n                method: 'disableControl'\n            });\n            ImagePanorama.prototype.onLoad.call(this, texture);\n        },\n        onLeave: function () {\n            this.unregisterMouseEvents();\n            this.dispatchEvent({\n                type: 'panolens-viewer-handler',\n                method: 'enableControl',\n                data: Constants.CONTROLS.ORBIT\n            });\n            window.cancelAnimationFrame(this.frameId);\n            ImagePanorama.prototype.onLeave.call(this);\n        },\n        onWindowResize: function () {\n            this.material.uniforms.resolution.value = this.container.clientWidth / this.container.clientHeight;\n        },\n        onContextMenu: function () {\n            this.dragging = false;\n        },\n        dispose: function () {\n            this.unregisterMouseEvents();\n            ImagePanorama.prototype.dispose.call(this);\n        }\n    });\n    return LittlePlanet;\n});\ndefine('skylark-panolens/panorama/ImageLittlePlanet',[\n    './LittlePlanet',\n    'skylark-threejs'\n], function (LittlePlanet, THREE) {\n    'use strict';\n    function ImageLittlePlanet(source, size, ratio) {\n        LittlePlanet.call(this, 'image', source, size, ratio);\n    }\n    ImageLittlePlanet.prototype = Object.assign(Object.create(LittlePlanet.prototype), {\n        constructor: ImageLittlePlanet,\n        onLoad: function (texture) {\n            this.updateTexture(texture);\n            LittlePlanet.prototype.onLoad.call(this, texture);\n        },\n        updateTexture: function (texture) {\n            texture.minFilter = texture.magFilter = THREE.LinearFilter;\n            this.material.uniforms['tDiffuse'].value = texture;\n        },\n        dispose: function () {\n            const tDiffuse = this.material.uniforms['tDiffuse'];\n            if (tDiffuse && tDiffuse.value) {\n                tDiffuse.value.dispose();\n            }\n            LittlePlanet.prototype.dispose.call(this);\n        }\n    });\n    return ImageLittlePlanet;\n});\ndefine('skylark-panolens/main',[\r\n\t\"skylark-langx-objects\",\r\n\t\"./panolens\",\r\n\t'./Constants',\r\n\t'./DataImage',\r\n\t'./Viewer',\r\n\t'./loaders/ImageLoader',\r\n\t'./loaders/TextureLoader',\r\n\t'./loaders/CubeTextureLoader',\r\n\t'./media/Media',\r\n\t'./interface/Reticle',\r\n\t'./infospot/Infospot',\r\n\t'./widget/Widget',\r\n\t'./panorama/Panorama',\r\n\t'./panorama/ImagePanorama',\r\n\t'./panorama/EmptyPanorama',\r\n\t'./panorama/CubePanorama',\r\n\t'./panorama/BasicPanorama',\r\n\t'./panorama/VideoPanorama',\r\n\t'./panorama/GoogleStreetviewPanorama',\r\n\t'./panorama/LittlePlanet',\r\n\t'./panorama/ImageLittlePlanet',\r\n\t'./panorama/CameraPanorama'\r\n],function(\r\n\tobjects,\r\n\tpanolens,\r\n\tConstants,\r\n\tDataImage,\r\n\tViewer,\r\n\tImageLoader,\r\n\tTextureLoader,\r\n\tCubeTextureLoader,\r\n\tMedia,\r\n\tReticle,\r\n\tInfospot,\r\n\tWidget,\r\n\tPanorama,\r\n\tImagePanorama,\r\n\tEmptyPanorama,\r\n\tCubePanorama,\r\n\tBasicPanorama,\r\n\tVideoPanorama,\r\n\tGoogleStreetviewPanorama,\r\n\tLittlePlanet,\r\n\tImageLittlePlanet,\r\n\tCameraPanorama\r\n){\r\n\tobjects.mixin(panolens,Constants);\r\n\tobjects.mixin(panolens,{\r\n\t\tDataImage,\r\n\t\tViewer,\r\n\t\tImageLoader,\r\n\t\tTextureLoader,\r\n\t\tCubeTextureLoader,\r\n\t\tMedia,\r\n\t\tReticle,\r\n\t\tInfospot,\r\n\t\tWidget,\r\n\t\tPanorama,\r\n\t\tImagePanorama,\r\n\t\tEmptyPanorama,\r\n\t\tCubePanorama,\r\n\t\tBasicPanorama,\r\n\t\tVideoPanorama,\r\n\t\tGoogleStreetviewPanorama,\r\n\t\tLittlePlanet,\r\n\t\tImageLittlePlanet,\r\n\t\tCameraPanorama\t\r\n\t});\r\n    return panolens;\r\n});\ndefine('skylark-panolens', ['skylark-panolens/main'], function (main) { return main; });\n\n"]}