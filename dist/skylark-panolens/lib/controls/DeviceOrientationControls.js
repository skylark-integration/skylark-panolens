/**
 * skylark-panolens - A version of panolens that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-panolens/
 * @license MIT
 */
define(["skylark-threejs"],function(e){"use strict";function t(t,n){var i=this,a={type:"change"},o=0,r=0,s=0,c=0;this.camera=t,this.camera.rotation.reorder("YXZ"),this.domElement=void 0!==n?n:document,this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alpha=0,this.alphaOffsetAngle=0;var d=function(e){i.deviceOrientation=e},h=function(){i.screenOrientation=window.orientation||0},u=function(e){e.preventDefault(),e.stopPropagation(),s=e.touches[0].pageX,c=e.touches[0].pageY},p=function(t){t.preventDefault(),t.stopPropagation(),o+=e.Math.degToRad((t.touches[0].pageX-s)/4),r+=e.Math.degToRad((c-t.touches[0].pageY)/4),i.updateAlphaOffsetAngle(o),s=t.touches[0].pageX,c=t.touches[0].pageY};this.connect=function(){h(),window.addEventListener("orientationchange",h,{passive:!0}),window.addEventListener("deviceorientation",d,{passive:!0}),window.addEventListener("deviceorientation",this.update.bind(this),{passive:!0}),i.domElement.addEventListener("touchstart",u,{passive:!1}),i.domElement.addEventListener("touchmove",p,{passive:!1}),i.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",h,!1),window.removeEventListener("deviceorientation",d,!1),window.removeEventListener("deviceorientation",this.update.bind(this),!1),i.domElement.removeEventListener("touchstart",u,!1),i.domElement.removeEventListener("touchmove",p,!1),i.enabled=!1},this.update=function(t){if(!1!==i.enabled){var n=i.deviceOrientation.alpha?e.Math.degToRad(i.deviceOrientation.alpha)+i.alphaOffsetAngle:0,o=i.deviceOrientation.beta?e.Math.degToRad(i.deviceOrientation.beta):0,s=i.deviceOrientation.gamma?e.Math.degToRad(i.deviceOrientation.gamma):0,c=i.screenOrientation?e.Math.degToRad(i.screenOrientation):0;!function(t,n,a,o,s){var c,d=new e.Vector3(0,0,1),h=new e.Euler,u=new e.Quaternion,p=new e.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5)),v=new e.Quaternion,l=new e.Quaternion;0==i.screenOrientation?(c=new e.Vector3(1,0,0),v.setFromAxisAngle(c,-r)):180==i.screenOrientation?(c=new e.Vector3(1,0,0),v.setFromAxisAngle(c,r)):90==i.screenOrientation?(c=new e.Vector3(0,1,0),v.setFromAxisAngle(c,r)):-90==i.screenOrientation&&(c=new e.Vector3(0,1,0),v.setFromAxisAngle(c,-r)),p.multiply(v),p.multiply(l),h.set(a,n,-o,"YXZ"),t.setFromEuler(h),t.multiply(p),t.multiply(u.setFromAxisAngle(d,-s))}(i.camera.quaternion,n,o,s,c),i.alpha=n,!0!==t&&i.dispatchEvent(a)}},this.updateAlphaOffsetAngle=function(e){this.alphaOffsetAngle=e,this.update()},this.dispose=function(){this.disconnect()},this.connect()}return t.prototype=Object.assign(Object.create(e.EventDispatcher.prototype),{constructor:t}),t});
//# sourceMappingURL=../../sourcemaps/lib/controls/DeviceOrientationControls.js.map
