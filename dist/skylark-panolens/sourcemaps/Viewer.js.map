{"version":3,"sources":["Viewer.js"],"names":["define","panolens","Constants","OrbitControls","DeviceOrientationControls","CardboardEffect","StereoEffect","Widget","Reticle","Infospot","DataImage","Panorama","VideoPanorama","CameraPanorama","THREE","TWEEN","Viewer","options","container","controlBar","undefined","controlButtons","autoHideControlBar","autoHideInfospot","horizontalView","clickTolerance","cameraFov","reverseDragging","enableReticle","dwellTime","autoReticleSelect","viewIndicator","indicatorSize","output","autoRotate","autoRotateSpeed","autoRotateActivationDuration","this","_width","clientWidth","_height","clientHeight","document","createElement","classList","add","style","width","height","window","innerWidth","innerHeight","body","appendChild","camera","PerspectiveCamera","scene","Scene","renderer","WebGLRenderer","alpha","antialias","sceneReticle","viewIndicatorSize","reticle","tempEnableReticle","mode","MODES","NORMAL","panorama","widget","hoverObject","infospot","pressEntityObject","pressObject","raycaster","Raycaster","raycasterPoint","Vector2","userMouse","updateCallbacks","requestAnimationId","cameraFrustum","Frustum","cameraViewProjectionMatrix","Matrix4","autoRotateRequestId","outputDivElement","touchSupported","DocumentTouch","HANDLER_MOUSE_DOWN","onMouseDown","bind","HANDLER_MOUSE_UP","onMouseUp","HANDLER_MOUSE_MOVE","onMouseMove","HANDLER_WINDOW_RESIZE","onWindowResize","HANDLER_KEY_DOWN","onKeyDown","HANDLER_KEY_UP","onKeyUp","HANDLER_TAP","onTap","clientX","clientY","OUTPUT_INFOSPOT","tweenLeftAnimation","Tween","tweenUpAnimation","setPixelRatio","devicePixelRatio","setSize","setClearColor","autoClear","domElement","display","backgroundColor","orbitControls","id","minDistance","noPan","deviceOrientationControls","enabled","position","z","passiveRendering","console","warn","controls","control","cardboardEffect","stereoEffect","effect","addReticle","minPolarAngle","Math","PI","maxPolarAngle","addDefaultControlBar","addViewIndicator","reverseDraggingDirection","enableReticleControl","registerMouseAndTouchEvents","addOutputElement","registerEventListeners","animate","call","prototype","Object","assign","create","EventDispatcher","constructor","object","arguments","length","i","addEventListener","eventHandler","dispatchEvent","type","addPanoramaEventListener","setPanorama","remove","removeEventListener","array","addControlBar","forEach","buttonName","addControlButton","pano","leavingPanorama","hideInfospot","afterEnterComplete","onLeave","onEnter","event","method","data","dispatchEventToChildren","traverse","activateWidgetItem","controlIndex","mainMenu","ControlMenuItem","children","ModeMenuItem","item","subMenu","setActiveItem","setSelectionTitle","textContent","CARDBOARD","STEREO","enableEffect","disableEffect","fov","disableReticleControl","render","visible","unregisterMouseAndTouchEvents","show","registerReticleEvent","updateReticleEvent","hide","unregisterReticleEvent","enableAutoRate","disableAutoRate","clearTimeout","toggleVideoPlay","pause","setVideoCurrentTime","percentage","onVideoUpdate","addUpdateCallback","fn","push","removeUpdateCallback","index","indexOf","splice","showVideoWidget","hideVideoWidget","updateVideoPlayButton","paused","videoElement","controlButton","update","setCameraControl","target","copy","getControl","getScene","getCamera","getRenderer","getContainer","getControlId","getNextControlId","getNextControlIndex","nextIndex","setCameraFov","updateProjectionMatrix","enableControl","CONTROLS","ORBIT","DEVICEORIENTATION","disableControl","toggleNextControl","getScreenVector","worldVector","vector","clone","widthHalf","heightHalf","project","x","y","checkSpriteInViewport","sprite","matrixWorldInverse","getInverse","matrixWorld","multiplyMatrices","projectionMatrix","setFromMatrix","intersectsSprite","rotateSpeed","momentumScalingFactor","tweenControlCenter","duration","easing","scope","ha","va","chv","cvv","hv","vv","vptc","ov","nv","Array","Easing","Exponential","Out","getWorldDirection","Vector3","getWorldPosition","sub","normalize","atan2","abs","angleTo","left","up","stop","to","onUpdate","rotateLeft","start","rotateUp","tweenControlCenterByObject","isUnderScalePlaceHolder","traverseAncestors","ancestor","scalePlaceHolder","invertXVector","multiply","windowWidth","windowHeight","expand","contains","isFullscreen","isAndroid","test","navigator","userAgent","adjustWidth","min","documentElement","max","adjustHeight","aspect","element","right","top","color","outputPosition","intersects","intersectObject","point","converter","world","message","toFixed","info","preventDefault","touches","onTarget","changedTouches","toggleControlBar","toggleInfospotVisibility","getBoundingClientRect","setFromCamera","intersectObjects","intersect_entity","getConvertedIntersect","intersect","mouseEvent","end","setTimeout","distance","passThrough","entity","onHoverEnd","key","callback","child","translateElement","onDismiss","clear","clearDepth","requestAnimationFrame","onChange","passive","offsetLeft","unregisterEventListeners","dispose","recursiveDispose","Cache","destroy","cancelAnimationFrame","onPanoramaDispose","loadAsyncRequest","url","request","XMLHttpRequest","onloadend","open","send","ViewIndicator","asyncEvent","loaded","viewIndicatorDiv","responseXML","opacity","cursor","indicator","querySelector","radius","currentPanoAngle","rotation","degToRad","fovAngle","leftAngle","rightAngle","leftX","cos","leftY","sin","rightX","rightY","indicatorD","setAttribute","appendControlItem","option","createCustomItem","group","barElement","clearAllCache"],"mappings":"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","file":"../Viewer.js","sourcesContent":["define([\n    './panolens',\n    './Constants',\n    './lib/controls/OrbitControls',\n    './lib/controls/DeviceOrientationControls',\n    './lib/effects/CardboardEffect',\n    './lib/effects/StereoEffect',\n    './widget/Widget',\n    './interface/Reticle',\n    './infospot/Infospot',\n    './DataImage',\n    './panorama/Panorama',\n    './panorama/VideoPanorama',\n    './panorama/CameraPanorama',\n    'skylark-threejs',\n    'skylark-tweenjs'\n], function (panolens,Constants, OrbitControls, DeviceOrientationControls, CardboardEffect, StereoEffect, Widget, Reticle, Infospot, DataImage, Panorama, VideoPanorama, CameraPanorama, THREE, TWEEN) {\n    'use strict';\n    function Viewer(options) {\n        let container;\n        options = options || {};\n        options.controlBar = options.controlBar !== undefined ? options.controlBar : true;\n        options.controlButtons = options.controlButtons || [\n            'fullscreen',\n            'setting',\n            'video'\n        ];\n        options.autoHideControlBar = options.autoHideControlBar !== undefined ? options.autoHideControlBar : false;\n        options.autoHideInfospot = options.autoHideInfospot !== undefined ? options.autoHideInfospot : true;\n        options.horizontalView = options.horizontalView !== undefined ? options.horizontalView : false;\n        options.clickTolerance = options.clickTolerance || 10;\n        options.cameraFov = options.cameraFov || 60;\n        options.reverseDragging = options.reverseDragging || false;\n        options.enableReticle = options.enableReticle || false;\n        options.dwellTime = options.dwellTime || 1500;\n        options.autoReticleSelect = options.autoReticleSelect !== undefined ? options.autoReticleSelect : true;\n        options.viewIndicator = options.viewIndicator !== undefined ? options.viewIndicator : false;\n        options.indicatorSize = options.indicatorSize || 30;\n        options.output = options.output ? options.output : 'none';\n        options.autoRotate = options.autoRotate || false;\n        options.autoRotateSpeed = options.autoRotateSpeed || 2;\n        options.autoRotateActivationDuration = options.autoRotateActivationDuration || 5000;\n        this.options = options;\n        if (options.container) {\n            container = options.container;\n            container._width = container.clientWidth;\n            container._height = container.clientHeight;\n        } else {\n            container = document.createElement('div');\n            container.classList.add('panolens-container');\n            container.style.width = '100%';\n            container.style.height = '100%';\n            container._width = window.innerWidth;\n            container._height = window.innerHeight;\n            document.body.appendChild(container);\n        }\n        this.container = container;\n        this.camera = options.camera || new THREE.PerspectiveCamera(this.options.cameraFov, this.container.clientWidth / this.container.clientHeight, 1, 10000);\n        this.scene = options.scene || new THREE.Scene();\n        this.renderer = options.renderer || new THREE.WebGLRenderer({\n            alpha: true,\n            antialias: false\n        });\n        this.sceneReticle = new THREE.Scene();\n        this.viewIndicatorSize = this.options.indicatorSize;\n        this.reticle = {};\n        this.tempEnableReticle = this.options.enableReticle;\n        this.mode = Constants.MODES.NORMAL;\n        this.panorama = null;\n        this.widget = null;\n        this.hoverObject = null;\n        this.infospot = null;\n        this.pressEntityObject = null;\n        this.pressObject = null;\n        this.raycaster = new THREE.Raycaster();\n        this.raycasterPoint = new THREE.Vector2();\n        this.userMouse = new THREE.Vector2();\n        this.updateCallbacks = [];\n        this.requestAnimationId = null;\n        this.cameraFrustum = new THREE.Frustum();\n        this.cameraViewProjectionMatrix = new THREE.Matrix4();\n        this.autoRotateRequestId = null;\n        this.outputDivElement = null;\n        this.touchSupported = 'ontouchstart' in window || window.DocumentTouch && document instanceof DocumentTouch;\n        this.HANDLER_MOUSE_DOWN = this.onMouseDown.bind(this);\n        this.HANDLER_MOUSE_UP = this.onMouseUp.bind(this);\n        this.HANDLER_MOUSE_MOVE = this.onMouseMove.bind(this);\n        this.HANDLER_WINDOW_RESIZE = this.onWindowResize.bind(this);\n        this.HANDLER_KEY_DOWN = this.onKeyDown.bind(this);\n        this.HANDLER_KEY_UP = this.onKeyUp.bind(this);\n        this.HANDLER_TAP = this.onTap.bind(this, {\n            clientX: this.container.clientWidth / 2,\n            clientY: this.container.clientHeight / 2\n        });\n        this.OUTPUT_INFOSPOT = false;\n        this.tweenLeftAnimation = new TWEEN.Tween();\n        this.tweenUpAnimation = new TWEEN.Tween();\n        this.renderer.setPixelRatio(window.devicePixelRatio);\n        this.renderer.setSize(this.container.clientWidth, this.container.clientHeight);\n        this.renderer.setClearColor(0, 0);\n        this.renderer.autoClear = false;\n        this.renderer.domElement.classList.add('panolens-canvas');\n        this.renderer.domElement.style.display = 'block';\n        this.container.style.backgroundColor = '#000';\n        this.container.appendChild(this.renderer.domElement);\n        this.orbitControls = new OrbitControls(this.camera, this.container);\n        this.orbitControls.id = 'orbit';\n        this.orbitControls.minDistance = 1;\n        this.orbitControls.noPan = true;\n        this.orbitControls.autoRotate = this.options.autoRotate;\n        this.orbitControls.autoRotateSpeed = this.options.autoRotateSpeed;\n        this.deviceOrientationControls = new DeviceOrientationControls(this.camera, this.container);\n        this.deviceOrientationControls.id = 'device-orientation';\n        this.deviceOrientationControls.enabled = false;\n        this.camera.position.z = 1;\n        if (this.options.passiveRendering) {\n            console.warn('passiveRendering is now deprecated');\n        }\n        this.controls = [\n            this.orbitControls,\n            this.deviceOrientationControls\n        ];\n        this.control = this.orbitControls;\n        this.cardboardEffect = new CardboardEffect(this.renderer);\n        this.cardboardEffect.setSize(this.container.clientWidth, this.container.clientHeight);\n        this.stereoEffect = new StereoEffect(this.renderer);\n        this.stereoEffect.setSize(this.container.clientWidth, this.container.clientHeight);\n        this.effect = this.cardboardEffect;\n        this.addReticle();\n        if (this.options.horizontalView) {\n            this.orbitControls.minPolarAngle = Math.PI / 2;\n            this.orbitControls.maxPolarAngle = Math.PI / 2;\n        }\n        if (this.options.controlBar !== false) {\n            this.addDefaultControlBar(this.options.controlButtons);\n        }\n        if (this.options.viewIndicator) {\n            this.addViewIndicator();\n        }\n        if (this.options.reverseDragging) {\n            this.reverseDraggingDirection();\n        }\n        if (this.options.enableReticle) {\n            this.enableReticleControl();\n        } else {\n            this.registerMouseAndTouchEvents();\n        }\n        if (this.options.output === 'overlay') {\n            this.addOutputElement();\n        }\n        this.registerEventListeners();\n        this.animate.call(this);\n    }\n    ;\n    Viewer.prototype = Object.assign(Object.create(THREE.EventDispatcher.prototype), {\n        constructor: Viewer,\n        add: function (object) {\n            if (arguments.length > 1) {\n                for (let i = 0; i < arguments.length; i++) {\n                    this.add(arguments[i]);\n                }\n                return this;\n            }\n            this.scene.add(object);\n            if (object.addEventListener) {\n                object.addEventListener('panolens-viewer-handler', this.eventHandler.bind(this));\n            }\n            if (object instanceof Panorama && object.dispatchEvent) {\n                object.dispatchEvent({\n                    type: 'panolens-container',\n                    container: this.container\n                });\n            }\n            if (object instanceof CameraPanorama) {\n                object.dispatchEvent({\n                    type: 'panolens-scene',\n                    scene: this.scene\n                });\n            }\n            if (object.type === 'panorama') {\n                this.addPanoramaEventListener(object);\n                if (!this.panorama) {\n                    this.setPanorama(object);\n                }\n            }\n        },\n        remove: function (object) {\n            if (object.removeEventListener) {\n                object.removeEventListener('panolens-viewer-handler', this.eventHandler.bind(this));\n            }\n            this.scene.remove(object);\n        },\n        addDefaultControlBar: function (array) {\n            if (this.widget) {\n                console.warn('Default control bar exists');\n                return;\n            }\n            const widget = new Widget(this.container);\n            widget.addEventListener('panolens-viewer-handler', this.eventHandler.bind(this));\n            widget.addControlBar();\n            array.forEach(buttonName => {\n                widget.addControlButton(buttonName);\n            });\n            this.widget = widget;\n        },\n        setPanorama: function (pano) {\n            const leavingPanorama = this.panorama;\n            if (pano.type === 'panorama' && leavingPanorama !== pano) {\n                this.hideInfospot();\n                const afterEnterComplete = function () {\n                    if (leavingPanorama) {\n                        leavingPanorama.onLeave();\n                    }\n                    pano.removeEventListener('enter-fade-start', afterEnterComplete);\n                };\n                pano.addEventListener('enter-fade-start', afterEnterComplete);\n                (this.panorama = pano).onEnter();\n            }\n        },\n        eventHandler: function (event) {\n            if (event.method && this[event.method]) {\n                this[event.method](event.data);\n            }\n        },\n        dispatchEventToChildren: function (event) {\n            this.scene.traverse(function (object) {\n                if (object.dispatchEvent) {\n                    object.dispatchEvent(event);\n                }\n            });\n        },\n        activateWidgetItem: function (controlIndex, mode) {\n            const mainMenu = this.widget.mainMenu;\n            const ControlMenuItem = mainMenu.children[0];\n            const ModeMenuItem = mainMenu.children[1];\n            let item;\n            if (controlIndex !== undefined) {\n                switch (controlIndex) {\n                case 0:\n                    item = ControlMenuItem.subMenu.children[1];\n                    break;\n                case 1:\n                    item = ControlMenuItem.subMenu.children[2];\n                    break;\n                default:\n                    item = ControlMenuItem.subMenu.children[1];\n                    break;\n                }\n                ControlMenuItem.subMenu.setActiveItem(item);\n                ControlMenuItem.setSelectionTitle(item.textContent);\n            }\n            if (mode !== undefined) {\n                switch (mode) {\n                case Constants.MODES.CARDBOARD:\n                    item = ModeMenuItem.subMenu.children[2];\n                    break;\n                case Constants.MODES.STEREO:\n                    item = ModeMenuItem.subMenu.children[3];\n                    break;\n                default:\n                    item = ModeMenuItem.subMenu.children[1];\n                    break;\n                }\n                ModeMenuItem.subMenu.setActiveItem(item);\n                ModeMenuItem.setSelectionTitle(item.textContent);\n            }\n        },\n        enableEffect: function (mode) {\n            if (this.mode === mode) {\n                return;\n            }\n            if (mode === Constants.MODES.NORMAL) {\n                this.disableEffect();\n                return;\n            } else {\n                this.mode = mode;\n            }\n            const fov = this.camera.fov;\n            switch (mode) {\n            case Constants.MODES.CARDBOARD:\n                this.effect = this.cardboardEffect;\n                this.enableReticleControl();\n                break;\n            case Constants.MODES.STEREO:\n                this.effect = this.stereoEffect;\n                this.enableReticleControl();\n                break;\n            default:\n                this.effect = null;\n                this.disableReticleControl();\n                break;\n            }\n            this.activateWidgetItem(undefined, this.mode);\n            this.dispatchEventToChildren({\n                type: 'panolens-dual-eye-effect',\n                mode: this.mode\n            });\n            this.camera.fov = fov + 0.01;\n            this.effect.setSize(this.container.clientWidth, this.container.clientHeight);\n            this.render();\n            this.camera.fov = fov;\n            this.dispatchEvent({\n                type: 'mode-change',\n                mode: this.mode\n            });\n        },\n        disableEffect: function () {\n            if (this.mode === Constants.MODES.NORMAL) {\n                return;\n            }\n            this.mode = Constants.MODES.NORMAL;\n            this.disableReticleControl();\n            this.activateWidgetItem(undefined, this.mode);\n            this.dispatchEventToChildren({\n                type: 'panolens-dual-eye-effect',\n                mode: this.mode\n            });\n            this.renderer.setSize(this.container.clientWidth, this.container.clientHeight);\n            this.render();\n            this.dispatchEvent({\n                type: 'mode-change',\n                mode: this.mode\n            });\n        },\n        enableReticleControl: function () {\n            if (this.reticle.visible) {\n                return;\n            }\n            this.tempEnableReticle = true;\n            this.unregisterMouseAndTouchEvents();\n            this.reticle.show();\n            this.registerReticleEvent();\n            this.updateReticleEvent();\n        },\n        disableReticleControl: function () {\n            this.tempEnableReticle = false;\n            if (!this.options.enableReticle) {\n                this.reticle.hide();\n                this.unregisterReticleEvent();\n                this.registerMouseAndTouchEvents();\n            } else {\n                this.updateReticleEvent();\n            }\n        },\n        enableAutoRate: function () {\n            this.options.autoRotate = true;\n            this.orbitControls.autoRotate = true;\n        },\n        disableAutoRate: function () {\n            clearTimeout(this.autoRotateRequestId);\n            this.options.autoRotate = false;\n            this.orbitControls.autoRotate = false;\n        },\n        toggleVideoPlay: function (pause) {\n            if (this.panorama instanceof VideoPanorama) {\n                this.panorama.dispatchEvent({\n                    type: 'video-toggle',\n                    pause: pause\n                });\n            }\n        },\n        setVideoCurrentTime: function (percentage) {\n            if (this.panorama instanceof VideoPanorama) {\n                this.panorama.dispatchEvent({\n                    type: 'video-time',\n                    percentage: percentage\n                });\n            }\n        },\n        onVideoUpdate: function (percentage) {\n            const {widget} = this;\n            if (widget) {\n                widget.dispatchEvent({\n                    type: 'video-update',\n                    percentage: percentage\n                });\n            }\n        },\n        addUpdateCallback: function (fn) {\n            if (fn) {\n                this.updateCallbacks.push(fn);\n            }\n        },\n        removeUpdateCallback: function (fn) {\n            const index = this.updateCallbacks.indexOf(fn);\n            if (fn && index >= 0) {\n                this.updateCallbacks.splice(index, 1);\n            }\n        },\n        showVideoWidget: function () {\n            const {widget} = this;\n            if (widget) {\n                widget.dispatchEvent({ type: 'video-control-show' });\n            }\n        },\n        hideVideoWidget: function () {\n            const {widget} = this;\n            if (widget) {\n                widget.dispatchEvent({ type: 'video-control-hide' });\n            }\n        },\n        updateVideoPlayButton: function (paused) {\n            const {widget} = this;\n            if (widget && widget.videoElement && widget.videoElement.controlButton) {\n                widget.videoElement.controlButton.update(paused);\n            }\n        },\n        addPanoramaEventListener: function (pano) {\n            pano.addEventListener('enter-fade-start', this.setCameraControl.bind(this));\n            if (pano instanceof VideoPanorama) {\n                pano.addEventListener('enter-fade-start', this.showVideoWidget.bind(this));\n                pano.addEventListener('leave', function () {\n                    if (!(this.panorama instanceof VideoPanorama)) {\n                        this.hideVideoWidget.call(this);\n                    }\n                }.bind(this));\n            }\n        },\n        setCameraControl: function () {\n            this.orbitControls.target.copy(this.panorama.position);\n        },\n        getControl: function () {\n            return this.control;\n        },\n        getScene: function () {\n            return this.scene;\n        },\n        getCamera: function () {\n            return this.camera;\n        },\n        getRenderer: function () {\n            return this.renderer;\n        },\n        getContainer: function () {\n            return this.container;\n        },\n        getControlId: function () {\n            return this.control.id;\n        },\n        getNextControlId: function () {\n            return this.controls[this.getNextControlIndex()].id;\n        },\n        getNextControlIndex: function () {\n            const controls = this.controls;\n            const control = this.control;\n            const nextIndex = controls.indexOf(control) + 1;\n            return nextIndex >= controls.length ? 0 : nextIndex;\n        },\n        setCameraFov: function (fov) {\n            this.camera.fov = fov;\n            this.camera.updateProjectionMatrix();\n        },\n        enableControl: function (index) {\n            index = index >= 0 && index < this.controls.length ? index : 0;\n            this.control.enabled = false;\n            this.control = this.controls[index];\n            this.control.enabled = true;\n            switch (index) {\n            case Constants.CONTROLS.ORBIT:\n                this.camera.position.copy(this.panorama.position);\n                this.camera.position.z += 1;\n                break;\n            case Constants.CONTROLS.DEVICEORIENTATION:\n                this.camera.position.copy(this.panorama.position);\n                break;\n            default:\n                break;\n            }\n            this.control.update();\n            this.activateWidgetItem(index, undefined);\n        },\n        disableControl: function () {\n            this.control.enabled = false;\n        },\n        toggleNextControl: function () {\n            this.enableControl(this.getNextControlIndex());\n        },\n        getScreenVector: function (worldVector) {\n            const vector = worldVector.clone();\n            const widthHalf = this.container.clientWidth / 2;\n            const heightHalf = this.container.clientHeight / 2;\n            vector.project(this.camera);\n            vector.x = vector.x * widthHalf + widthHalf;\n            vector.y = -(vector.y * heightHalf) + heightHalf;\n            vector.z = 0;\n            return vector;\n        },\n        checkSpriteInViewport: function (sprite) {\n            this.camera.matrixWorldInverse.getInverse(this.camera.matrixWorld);\n            this.cameraViewProjectionMatrix.multiplyMatrices(this.camera.projectionMatrix, this.camera.matrixWorldInverse);\n            this.cameraFrustum.setFromMatrix(this.cameraViewProjectionMatrix);\n            return sprite.visible && this.cameraFrustum.intersectsSprite(sprite);\n        },\n        reverseDraggingDirection: function () {\n            this.orbitControls.rotateSpeed *= -1;\n            this.orbitControls.momentumScalingFactor *= -1;\n        },\n        addReticle: function () {\n            this.reticle = new Reticle(16777215, true, this.options.dwellTime);\n            this.reticle.hide();\n            this.camera.add(this.reticle);\n            this.sceneReticle.add(this.camera);\n        },\n        tweenControlCenter: function (vector, duration, easing) {\n            if (this.control !== this.orbitControls) {\n                return;\n            }\n            if (vector instanceof Array) {\n                duration = vector[1];\n                easing = vector[2];\n                vector = vector[0];\n            }\n            duration = duration !== undefined ? duration : 1000;\n            easing = easing || TWEEN.Easing.Exponential.Out;\n            let scope, ha, va, chv, cvv, hv, vv, vptc, ov, nv;\n            scope = this;\n            chv = this.camera.getWorldDirection(new THREE.Vector3());\n            cvv = chv.clone();\n            vptc = this.panorama.getWorldPosition(new THREE.Vector3()).sub(this.camera.getWorldPosition(new THREE.Vector3()));\n            hv = vector.clone();\n            hv.x *= -1;\n            hv.add(vptc).normalize();\n            vv = hv.clone();\n            chv.y = 0;\n            hv.y = 0;\n            ha = Math.atan2(hv.z, hv.x) - Math.atan2(chv.z, chv.x);\n            ha = ha > Math.PI ? ha - 2 * Math.PI : ha;\n            ha = ha < -Math.PI ? ha + 2 * Math.PI : ha;\n            va = Math.abs(cvv.angleTo(chv) + (cvv.y * vv.y <= 0 ? vv.angleTo(hv) : -vv.angleTo(hv)));\n            va *= vv.y < cvv.y ? 1 : -1;\n            ov = {\n                left: 0,\n                up: 0\n            };\n            nv = {\n                left: 0,\n                up: 0\n            };\n            this.tweenLeftAnimation.stop();\n            this.tweenUpAnimation.stop();\n            this.tweenLeftAnimation = new TWEEN.Tween(ov).to({ left: ha }, duration).easing(easing).onUpdate(function (ov) {\n                scope.control.rotateLeft(ov.left - nv.left);\n                nv.left = ov.left;\n            }).start();\n            this.tweenUpAnimation = new TWEEN.Tween(ov).to({ up: va }, duration).easing(easing).onUpdate(function (ov) {\n                scope.control.rotateUp(ov.up - nv.up);\n                nv.up = ov.up;\n            }).start();\n        },\n        tweenControlCenterByObject: function (object, duration, easing) {\n            let isUnderScalePlaceHolder = false;\n            object.traverseAncestors(function (ancestor) {\n                if (ancestor.scalePlaceHolder) {\n                    isUnderScalePlaceHolder = true;\n                }\n            });\n            if (isUnderScalePlaceHolder) {\n                const invertXVector = new THREE.Vector3(-1, 1, 1);\n                this.tweenControlCenter(object.getWorldPosition(new THREE.Vector3()).multiply(invertXVector), duration, easing);\n            } else {\n                this.tweenControlCenter(object.getWorldPosition(new THREE.Vector3()), duration, easing);\n            }\n        },\n        onWindowResize: function (windowWidth, windowHeight) {\n            let width, height;\n            const expand = this.container.classList.contains('panolens-container') || this.container.isFullscreen;\n            if (windowWidth !== undefined && windowHeight !== undefined) {\n                width = windowWidth;\n                height = windowHeight;\n                this.container._width = windowWidth;\n                this.container._height = windowHeight;\n            } else {\n                const isAndroid = /(android)/i.test(window.navigator.userAgent);\n                const adjustWidth = isAndroid ? Math.min(document.documentElement.clientWidth, window.innerWidth || 0) : Math.max(document.documentElement.clientWidth, window.innerWidth || 0);\n                const adjustHeight = isAndroid ? Math.min(document.documentElement.clientHeight, window.innerHeight || 0) : Math.max(document.documentElement.clientHeight, window.innerHeight || 0);\n                width = expand ? adjustWidth : this.container.clientWidth;\n                height = expand ? adjustHeight : this.container.clientHeight;\n                this.container._width = width;\n                this.container._height = height;\n            }\n            this.camera.aspect = width / height;\n            this.camera.updateProjectionMatrix();\n            this.renderer.setSize(width, height);\n            if (this.options.enableReticle || this.tempEnableReticle) {\n                this.updateReticleEvent();\n            }\n            this.dispatchEvent({\n                type: 'window-resize',\n                width: width,\n                height: height\n            });\n            this.scene.traverse(function (object) {\n                if (object.dispatchEvent) {\n                    object.dispatchEvent({\n                        type: 'window-resize',\n                        width: width,\n                        height: height\n                    });\n                }\n            });\n        },\n        addOutputElement: function () {\n            const element = document.createElement('div');\n            element.style.position = 'absolute';\n            element.style.right = '10px';\n            element.style.top = '10px';\n            element.style.color = '#fff';\n            this.container.appendChild(element);\n            this.outputDivElement = element;\n        },\n        outputPosition: function () {\n            const intersects = this.raycaster.intersectObject(this.panorama, true);\n            if (intersects.length > 0) {\n                const point = intersects[0].point.clone();\n                const converter = new THREE.Vector3(-1, 1, 1);\n                const world = this.panorama.getWorldPosition(new THREE.Vector3());\n                point.sub(world).multiply(converter);\n                const message = `${ point.x.toFixed(2) }, ${ point.y.toFixed(2) }, ${ point.z.toFixed(2) }`;\n                if (point.length() === 0) {\n                    return;\n                }\n                switch (this.options.output) {\n                case 'console':\n                    console.info(message);\n                    break;\n                case 'overlay':\n                    this.outputDivElement.textContent = message;\n                    break;\n                default:\n                    break;\n                }\n            }\n        },\n        onMouseDown: function (event) {\n            event.preventDefault();\n            this.userMouse.x = event.clientX >= 0 ? event.clientX : event.touches[0].clientX;\n            this.userMouse.y = event.clientY >= 0 ? event.clientY : event.touches[0].clientY;\n            this.userMouse.type = 'mousedown';\n            this.onTap(event);\n        },\n        onMouseMove: function (event) {\n            event.preventDefault();\n            this.userMouse.type = 'mousemove';\n            this.onTap(event);\n        },\n        onMouseUp: function (event) {\n            let onTarget = false;\n            this.userMouse.type = 'mouseup';\n            const type = this.userMouse.x >= event.clientX - this.options.clickTolerance && this.userMouse.x <= event.clientX + this.options.clickTolerance && this.userMouse.y >= event.clientY - this.options.clickTolerance && this.userMouse.y <= event.clientY + this.options.clickTolerance || event.changedTouches && this.userMouse.x >= event.changedTouches[0].clientX - this.options.clickTolerance && this.userMouse.x <= event.changedTouches[0].clientX + this.options.clickTolerance && this.userMouse.y >= event.changedTouches[0].clientY - this.options.clickTolerance && this.userMouse.y <= event.changedTouches[0].clientY + this.options.clickTolerance ? 'click' : undefined;\n            if (event && event.target && !event.target.classList.contains('panolens-canvas')) {\n                return;\n            }\n            event.preventDefault();\n            if (event.changedTouches && event.changedTouches.length === 1) {\n                onTarget = this.onTap({\n                    clientX: event.changedTouches[0].clientX,\n                    clientY: event.changedTouches[0].clientY\n                }, type);\n            } else {\n                onTarget = this.onTap(event, type);\n            }\n            this.userMouse.type = 'none';\n            if (onTarget) {\n                return;\n            }\n            if (type === 'click') {\n                const {\n                    options: {autoHideInfospot, autoHideControlBar},\n                    panorama,\n                    toggleControlBar\n                } = this;\n                if (autoHideInfospot && panorama) {\n                    panorama.toggleInfospotVisibility();\n                }\n                if (autoHideControlBar) {\n                    toggleControlBar();\n                }\n            }\n        },\n        onTap: function (event, type) {\n            const {left, top} = this.container.getBoundingClientRect();\n            const {clientWidth, clientHeight} = this.container;\n            this.raycasterPoint.x = (event.clientX - left) / clientWidth * 2 - 1;\n            this.raycasterPoint.y = -((event.clientY - top) / clientHeight) * 2 + 1;\n            this.raycaster.setFromCamera(this.raycasterPoint, this.camera);\n            if (!this.panorama) {\n                return;\n            }\n            if (event.type !== 'mousedown' && this.touchSupported || this.OUTPUT_INFOSPOT) {\n                this.outputPosition();\n            }\n            const intersects = this.raycaster.intersectObjects(this.panorama.children, true);\n            const intersect_entity = this.getConvertedIntersect(intersects);\n            const intersect = intersects.length > 0 ? intersects[0].object : undefined;\n            if (this.userMouse.type === 'mouseup') {\n                if (intersect_entity && this.pressEntityObject === intersect_entity && this.pressEntityObject.dispatchEvent) {\n                    this.pressEntityObject.dispatchEvent({\n                        type: 'pressstop-entity',\n                        mouseEvent: event\n                    });\n                }\n                this.pressEntityObject = undefined;\n            }\n            if (this.userMouse.type === 'mouseup') {\n                if (intersect && this.pressObject === intersect && this.pressObject.dispatchEvent) {\n                    this.pressObject.dispatchEvent({\n                        type: 'pressstop',\n                        mouseEvent: event\n                    });\n                }\n                this.pressObject = undefined;\n            }\n            if (type === 'click') {\n                this.panorama.dispatchEvent({\n                    type: 'click',\n                    intersects: intersects,\n                    mouseEvent: event\n                });\n                if (intersect_entity && intersect_entity.dispatchEvent) {\n                    intersect_entity.dispatchEvent({\n                        type: 'click-entity',\n                        mouseEvent: event\n                    });\n                }\n                if (intersect && intersect.dispatchEvent) {\n                    intersect.dispatchEvent({\n                        type: 'click',\n                        mouseEvent: event\n                    });\n                }\n            } else {\n                this.panorama.dispatchEvent({\n                    type: 'hover',\n                    intersects: intersects,\n                    mouseEvent: event\n                });\n                if (this.hoverObject && intersects.length > 0 && this.hoverObject !== intersect_entity || this.hoverObject && intersects.length === 0) {\n                    if (this.hoverObject.dispatchEvent) {\n                        this.hoverObject.dispatchEvent({\n                            type: 'hoverleave',\n                            mouseEvent: event\n                        });\n                        this.reticle.end();\n                    }\n                    this.hoverObject = undefined;\n                }\n                if (intersect_entity && intersects.length > 0) {\n                    if (this.hoverObject !== intersect_entity) {\n                        this.hoverObject = intersect_entity;\n                        if (this.hoverObject.dispatchEvent) {\n                            this.hoverObject.dispatchEvent({\n                                type: 'hoverenter',\n                                mouseEvent: event\n                            });\n                            if (this.options.autoReticleSelect && this.options.enableReticle || this.tempEnableReticle) {\n                                this.reticle.start(this.onTap.bind(this, event, 'click'));\n                            }\n                        }\n                    }\n                    if (this.userMouse.type === 'mousedown' && this.pressEntityObject != intersect_entity) {\n                        this.pressEntityObject = intersect_entity;\n                        if (this.pressEntityObject.dispatchEvent) {\n                            this.pressEntityObject.dispatchEvent({\n                                type: 'pressstart-entity',\n                                mouseEvent: event\n                            });\n                        }\n                    }\n                    if (this.userMouse.type === 'mousedown' && this.pressObject != intersect) {\n                        this.pressObject = intersect;\n                        if (this.pressObject.dispatchEvent) {\n                            this.pressObject.dispatchEvent({\n                                type: 'pressstart',\n                                mouseEvent: event\n                            });\n                        }\n                    }\n                    if (this.userMouse.type === 'mousemove' || this.options.enableReticle) {\n                        if (intersect && intersect.dispatchEvent) {\n                            intersect.dispatchEvent({\n                                type: 'hover',\n                                mouseEvent: event\n                            });\n                        }\n                        if (this.pressEntityObject && this.pressEntityObject.dispatchEvent) {\n                            this.pressEntityObject.dispatchEvent({\n                                type: 'pressmove-entity',\n                                mouseEvent: event\n                            });\n                        }\n                        if (this.pressObject && this.pressObject.dispatchEvent) {\n                            this.pressObject.dispatchEvent({\n                                type: 'pressmove',\n                                mouseEvent: event\n                            });\n                        }\n                    }\n                }\n                if (!intersect_entity && this.pressEntityObject && this.pressEntityObject.dispatchEvent) {\n                    this.pressEntityObject.dispatchEvent({\n                        type: 'pressstop-entity',\n                        mouseEvent: event\n                    });\n                    this.pressEntityObject = undefined;\n                }\n                if (!intersect && this.pressObject && this.pressObject.dispatchEvent) {\n                    this.pressObject.dispatchEvent({\n                        type: 'pressstop',\n                        mouseEvent: event\n                    });\n                    this.pressObject = undefined;\n                }\n            }\n            if (intersect && intersect instanceof Infospot) {\n                this.infospot = intersect;\n                if (type === 'click') {\n                    return true;\n                }\n            } else if (this.infospot) {\n                this.hideInfospot();\n            }\n            if (this.options.autoRotate && this.userMouse.type !== 'mousemove') {\n                clearTimeout(this.autoRotateRequestId);\n                if (this.control === this.orbitControls) {\n                    this.orbitControls.autoRotate = false;\n                    this.autoRotateRequestId = window.setTimeout(this.enableAutoRate.bind(this), this.options.autoRotateActivationDuration);\n                }\n            }\n        },\n        getConvertedIntersect: function (intersects) {\n            let intersect;\n            for (let i = 0; i < intersects.length; i++) {\n                if (intersects[i].distance >= 0 && intersects[i].object && !intersects[i].object.passThrough) {\n                    if (intersects[i].object.entity && intersects[i].object.entity.passThrough) {\n                        continue;\n                    } else if (intersects[i].object.entity && !intersects[i].object.entity.passThrough) {\n                        intersect = intersects[i].object.entity;\n                        break;\n                    } else {\n                        intersect = intersects[i].object;\n                        break;\n                    }\n                }\n            }\n            return intersect;\n        },\n        hideInfospot: function () {\n            if (this.infospot) {\n                this.infospot.onHoverEnd();\n                this.infospot = undefined;\n            }\n        },\n        toggleControlBar: function () {\n            const {widget} = this;\n            if (widget) {\n                widget.dispatchEvent({ type: 'control-bar-toggle' });\n            }\n        },\n        onKeyDown: function (event) {\n            if (this.options.output && this.options.output !== 'none' && event.key === 'Control') {\n                this.OUTPUT_INFOSPOT = true;\n            }\n        },\n        onKeyUp: function () {\n            this.OUTPUT_INFOSPOT = false;\n        },\n        update: function () {\n            TWEEN.update();\n            this.updateCallbacks.forEach(function (callback) {\n                callback();\n            });\n            this.control.update();\n            this.scene.traverse(function (child) {\n                if (child instanceof Infospot && child.element && (this.hoverObject === child || child.element.style.display !== 'none' || child.element.left && child.element.left.style.display !== 'none' || child.element.right && child.element.right.style.display !== 'none')) {\n                    if (this.checkSpriteInViewport(child)) {\n                        const {x, y} = this.getScreenVector(child.getWorldPosition(new THREE.Vector3()));\n                        child.translateElement(x, y);\n                    } else {\n                        child.onDismiss();\n                    }\n                }\n            }.bind(this));\n        },\n        render: function () {\n            if (this.mode === Constants.MODES.CARDBOARD || this.mode === Constants.MODES.STEREO) {\n                this.renderer.clear();\n                this.effect.render(this.scene, this.camera);\n                this.effect.render(this.sceneReticle, this.camera);\n            } else {\n                this.renderer.clear();\n                this.renderer.render(this.scene, this.camera);\n                this.renderer.clearDepth();\n                this.renderer.render(this.sceneReticle, this.camera);\n            }\n        },\n        animate: function () {\n            this.requestAnimationId = window.requestAnimationFrame(this.animate.bind(this));\n            this.onChange();\n        },\n        onChange: function () {\n            this.update();\n            this.render();\n        },\n        registerMouseAndTouchEvents: function () {\n            const options = { passive: false };\n            this.container.addEventListener('mousedown', this.HANDLER_MOUSE_DOWN, options);\n            this.container.addEventListener('mousemove', this.HANDLER_MOUSE_MOVE, options);\n            this.container.addEventListener('mouseup', this.HANDLER_MOUSE_UP, options);\n            this.container.addEventListener('touchstart', this.HANDLER_MOUSE_DOWN, options);\n            this.container.addEventListener('touchend', this.HANDLER_MOUSE_UP, options);\n        },\n        unregisterMouseAndTouchEvents: function () {\n            this.container.removeEventListener('mousedown', this.HANDLER_MOUSE_DOWN, false);\n            this.container.removeEventListener('mousemove', this.HANDLER_MOUSE_MOVE, false);\n            this.container.removeEventListener('mouseup', this.HANDLER_MOUSE_UP, false);\n            this.container.removeEventListener('touchstart', this.HANDLER_MOUSE_DOWN, false);\n            this.container.removeEventListener('touchend', this.HANDLER_MOUSE_UP, false);\n        },\n        registerReticleEvent: function () {\n            this.addUpdateCallback(this.HANDLER_TAP);\n        },\n        unregisterReticleEvent: function () {\n            this.removeUpdateCallback(this.HANDLER_TAP);\n        },\n        updateReticleEvent: function () {\n            const clientX = this.container.clientWidth / 2 + this.container.offsetLeft;\n            const clientY = this.container.clientHeight / 2;\n            this.removeUpdateCallback(this.HANDLER_TAP);\n            this.HANDLER_TAP = this.onTap.bind(this, {\n                clientX,\n                clientY\n            });\n            this.addUpdateCallback(this.HANDLER_TAP);\n        },\n        registerEventListeners: function () {\n            window.addEventListener('resize', this.HANDLER_WINDOW_RESIZE, true);\n            window.addEventListener('keydown', this.HANDLER_KEY_DOWN, true);\n            window.addEventListener('keyup', this.HANDLER_KEY_UP, true);\n        },\n        unregisterEventListeners: function () {\n            window.removeEventListener('resize', this.HANDLER_WINDOW_RESIZE, true);\n            window.removeEventListener('keydown', this.HANDLER_KEY_DOWN, true);\n            window.removeEventListener('keyup', this.HANDLER_KEY_UP, true);\n        },\n        dispose: function () {\n            this.tweenLeftAnimation.stop();\n            this.tweenUpAnimation.stop();\n            this.unregisterEventListeners();\n            function recursiveDispose(object) {\n                for (let i = object.children.length - 1; i >= 0; i--) {\n                    recursiveDispose(object.children[i]);\n                    object.remove(object.children[i]);\n                }\n                if (object instanceof Panorama || object instanceof Infospot) {\n                    object.dispose();\n                    object = null;\n                } else if (object.dispatchEvent) {\n                    object.dispatchEvent('dispose');\n                }\n            }\n            recursiveDispose(this.scene);\n            if (this.widget) {\n                this.widget.dispose();\n                this.widget = null;\n            }\n            if (THREE.Cache && THREE.Cache.enabled) {\n                THREE.Cache.clear();\n            }\n        },\n        destroy: function () {\n            this.dispose();\n            this.render();\n            window.cancelAnimationFrame(this.requestAnimationId);\n        },\n        onPanoramaDispose: function (panorama) {\n            if (panorama instanceof VideoPanorama) {\n                this.hideVideoWidget();\n            }\n            if (panorama === this.panorama) {\n                this.panorama = null;\n            }\n        },\n        loadAsyncRequest: function (url, callback = () => {\n        }) {\n            const request = new window.XMLHttpRequest();\n            request.onloadend = function (event) {\n                callback(event);\n            };\n            request.open('GET', url, true);\n            request.send(null);\n        },\n        addViewIndicator: function () {\n            const scope = this;\n            function loadViewIndicator(asyncEvent) {\n                if (asyncEvent.loaded === 0)\n                    return;\n                const viewIndicatorDiv = asyncEvent.target.responseXML.documentElement;\n                viewIndicatorDiv.style.width = scope.viewIndicatorSize + 'px';\n                viewIndicatorDiv.style.height = scope.viewIndicatorSize + 'px';\n                viewIndicatorDiv.style.position = 'absolute';\n                viewIndicatorDiv.style.top = '10px';\n                viewIndicatorDiv.style.left = '10px';\n                viewIndicatorDiv.style.opacity = '0.5';\n                viewIndicatorDiv.style.cursor = 'pointer';\n                viewIndicatorDiv.id = 'panolens-view-indicator-container';\n                scope.container.appendChild(viewIndicatorDiv);\n                const indicator = viewIndicatorDiv.querySelector('#indicator');\n                const setIndicatorD = function () {\n                    scope.radius = scope.viewIndicatorSize * 0.225;\n                    scope.currentPanoAngle = scope.camera.rotation.y - THREE.Math.degToRad(90);\n                    scope.fovAngle = THREE.Math.degToRad(scope.camera.fov);\n                    scope.leftAngle = -scope.currentPanoAngle - scope.fovAngle / 2;\n                    scope.rightAngle = -scope.currentPanoAngle + scope.fovAngle / 2;\n                    scope.leftX = scope.radius * Math.cos(scope.leftAngle);\n                    scope.leftY = scope.radius * Math.sin(scope.leftAngle);\n                    scope.rightX = scope.radius * Math.cos(scope.rightAngle);\n                    scope.rightY = scope.radius * Math.sin(scope.rightAngle);\n                    scope.indicatorD = 'M ' + scope.leftX + ' ' + scope.leftY + ' A ' + scope.radius + ' ' + scope.radius + ' 0 0 1 ' + scope.rightX + ' ' + scope.rightY;\n                    if (scope.leftX && scope.leftY && scope.rightX && scope.rightY && scope.radius) {\n                        indicator.setAttribute('d', scope.indicatorD);\n                    }\n                };\n                scope.addUpdateCallback(setIndicatorD);\n                const indicatorOnMouseEnter = function () {\n                    this.style.opacity = '1';\n                };\n                const indicatorOnMouseLeave = function () {\n                    this.style.opacity = '0.5';\n                };\n                viewIndicatorDiv.addEventListener('mouseenter', indicatorOnMouseEnter);\n                viewIndicatorDiv.addEventListener('mouseleave', indicatorOnMouseLeave);\n            }\n            this.loadAsyncRequest(DataImage.ViewIndicator, loadViewIndicator);\n        },\n        appendControlItem: function (option) {\n            const item = this.widget.createCustomItem(option);\n            if (option.group === 'video') {\n                this.widget.videoElement.appendChild(item);\n            } else {\n                this.widget.barElement.appendChild(item);\n            }\n            return item;\n        },\n        clearAllCache: function () {\n            THREE.Cache.clear();\n        }\n    });\n    return panolens.Viewer = Viewer;\n});"]}