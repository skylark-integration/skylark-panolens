{"version":3,"sources":["widget/Widget.js"],"names":["define","Constants","DataImage","THREE","Widget","container","console","warn","EventDispatcher","call","this","DEFAULT_TRANSITION","TOUCH_ENABLED","window","DocumentTouch","document","PREVENT_EVENT_HANDLER","event","preventDefault","stopPropagation","barElement","fullscreenElement","videoElement","settingElement","mainMenu","activeMainItem","activeSubMenu","mask","prototype","Object","assign","create","constructor","addControlBar","bar","styleTranslate","styleOpacity","gradientStyle","scope","createElement","style","width","height","float","transform","webkitTransform","msTransform","background","transition","pointerEvents","isHidden","toggle","opacity","menu","createDefaultMenu","createMainMenu","appendChild","createMask","dispose","removeChild","addEventListener","hide","deactivate","handler","method","data","dispatchEvent","type","title","subMenu","CONTROLS","ORBIT","DEVICEORIENTATION","MODES","CARDBOARD","STEREO","addControlButton","name","element","createFullscreenButton","createSettingButton","createVideoControl","position","top","left","display","show","item","createCustomItem","backgroundImage","Setting","webkitTransition","onTap","activated","activate","visible","_width","changeSize","unslideAll","stylesheetId","isFullscreen","tapSkipped","fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled","onFullScreenChange","FullscreenEnter","exitFullscreen","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen","requestFullscreen","msRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","Element","ALLOW_KEYBOARD_INPUT","FullscreenLeave","querySelector","sheet","id","innerHTML","body","controlButton","paused","update","createVideoControlButton","seekBar","createVideoControlSeekbar","VideoPlay","undefined","VideoPause","progressElement","progressElementControl","mouseX","percentageNow","percentageNext","isDragging","onMouseDown","clientX","changedTouches","parseInt","onVideoControlDrag","passive","onVideoControlStop","clientWidth","setProgress","removeControlListeners","removeEventListener","backgroundColor","borderRadius","marginTop","target","percentage","length","pageX","getBoundingClientRect","offsetX","onDispose","createMenuItem","textContent","padding","textDecoration","cursor","slide","right","unslide","setIcon","url","icon","setSelectionTitle","selection","addSelection","fontSize","fontWeight","addIcon","ChevronRight","flip","backgroundSize","addSubMenu","items","createSubMenu","createMenuItemHeader","header","borderBottom","paddingBottom","menus","createMenu","slideAll","parentElement","requestAnimationFrame","i","addItem","paddingLeft","setActiveItem","activeItem","addHeader","bottom","fontFamily","visibility","boxShadow","overflow","willChange","children","Check","options","backgroundRepeat","backgroundPosition","webkitUserSelect","MozUserSelect","userSelect","filter","webkitFilter","mergeStyleOptions","property","hasOwnProperty"],"mappings":"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","file":"../../widget/Widget.js","sourcesContent":["define([\n    '../Constants',\n    '../DataImage',\n    'skylark-threejs'\n], function (Constants, DataImage, THREE) {\n    'use strict';\n    function Widget(container) {\n        if (!container) {\n            console.warn('PANOLENS.Widget: No container specified');\n        }\n        THREE.EventDispatcher.call(this);\n        this.DEFAULT_TRANSITION = 'all 0.27s ease';\n        this.TOUCH_ENABLED = !!('ontouchstart' in window || window.DocumentTouch && document instanceof DocumentTouch);\n        this.PREVENT_EVENT_HANDLER = function (event) {\n            event.preventDefault();\n            event.stopPropagation();\n        };\n        this.container = container;\n        this.barElement = null;\n        this.fullscreenElement = null;\n        this.videoElement = null;\n        this.settingElement = null;\n        this.mainMenu = null;\n        this.activeMainItem = null;\n        this.activeSubMenu = null;\n        this.mask = null;\n    }\n    Widget.prototype = Object.assign(Object.create(THREE.EventDispatcher.prototype), {\n        constructor: Widget,\n        addControlBar: function () {\n            if (!this.container) {\n                console.warn('Widget container not set');\n                return;\n            }\n            var scope = this, bar, styleTranslate, styleOpacity, gradientStyle;\n            gradientStyle = 'linear-gradient(bottom, rgba(0,0,0,0.2), rgba(0,0,0,0))';\n            bar = document.createElement('div');\n            bar.style.width = '100%';\n            bar.style.height = '44px';\n            bar.style.float = 'left';\n            bar.style.transform = bar.style.webkitTransform = bar.style.msTransform = 'translateY(-100%)';\n            bar.style.background = '-webkit-' + gradientStyle;\n            bar.style.background = '-moz-' + gradientStyle;\n            bar.style.background = '-o-' + gradientStyle;\n            bar.style.background = '-ms-' + gradientStyle;\n            bar.style.background = gradientStyle;\n            bar.style.transition = this.DEFAULT_TRANSITION;\n            bar.style.pointerEvents = 'none';\n            bar.isHidden = false;\n            bar.toggle = function () {\n                bar.isHidden = !bar.isHidden;\n                styleTranslate = bar.isHidden ? 'translateY(0)' : 'translateY(-100%)';\n                styleOpacity = bar.isHidden ? 0 : 1;\n                bar.style.transform = bar.style.webkitTransform = bar.style.msTransform = styleTranslate;\n                bar.style.opacity = styleOpacity;\n            };\n            var menu = this.createDefaultMenu();\n            this.mainMenu = this.createMainMenu(menu);\n            bar.appendChild(this.mainMenu);\n            var mask = this.createMask();\n            this.mask = mask;\n            this.container.appendChild(mask);\n            bar.dispose = function () {\n                if (scope.fullscreenElement) {\n                    bar.removeChild(scope.fullscreenElement);\n                    scope.fullscreenElement.dispose();\n                    scope.fullscreenElement = null;\n                }\n                if (scope.settingElement) {\n                    bar.removeChild(scope.settingElement);\n                    scope.settingElement.dispose();\n                    scope.settingElement = null;\n                }\n                if (scope.videoElement) {\n                    bar.removeChild(scope.videoElement);\n                    scope.videoElement.dispose();\n                    scope.videoElement = null;\n                }\n            };\n            this.container.appendChild(bar);\n            this.mask.addEventListener('mousemove', this.PREVENT_EVENT_HANDLER, true);\n            this.mask.addEventListener('mouseup', this.PREVENT_EVENT_HANDLER, true);\n            this.mask.addEventListener('mousedown', this.PREVENT_EVENT_HANDLER, true);\n            this.mask.addEventListener(scope.TOUCH_ENABLED ? 'touchend' : 'click', function (event) {\n                event.preventDefault();\n                event.stopPropagation();\n                scope.mask.hide();\n                scope.settingElement.deactivate();\n            }, false);\n            this.addEventListener('control-bar-toggle', bar.toggle);\n            this.barElement = bar;\n        },\n        createDefaultMenu: function () {\n            var scope = this, handler;\n            handler = function (method, data) {\n                return function () {\n                    scope.dispatchEvent({\n                        type: 'panolens-viewer-handler',\n                        method: method,\n                        data: data\n                    });\n                };\n            };\n            return [\n                {\n                    title: 'Control',\n                    subMenu: [\n                        {\n                            title: this.TOUCH_ENABLED ? 'Touch' : 'Mouse',\n                            handler: handler('enableControl', Constants.CONTROLS.ORBIT)\n                        },\n                        {\n                            title: 'Sensor',\n                            handler: handler('enableControl', Constants.CONTROLS.DEVICEORIENTATION)\n                        }\n                    ]\n                },\n                {\n                    title: 'Mode',\n                    subMenu: [\n                        {\n                            title: 'Normal',\n                            handler: handler('disableEffect')\n                        },\n                        {\n                            title: 'Cardboard',\n                            handler: handler('enableEffect', Constants.MODES.CARDBOARD)\n                        },\n                        {\n                            title: 'Stereoscopic',\n                            handler: handler('enableEffect', Constants.MODES.STEREO)\n                        }\n                    ]\n                }\n            ];\n        },\n        addControlButton: function (name) {\n            let element;\n            switch (name) {\n            case 'fullscreen':\n                element = this.createFullscreenButton();\n                this.fullscreenElement = element;\n                break;\n            case 'setting':\n                element = this.createSettingButton();\n                this.settingElement = element;\n                break;\n            case 'video':\n                element = this.createVideoControl();\n                this.videoElement = element;\n                break;\n            default:\n                return;\n            }\n            if (!element) {\n                return;\n            }\n            this.barElement.appendChild(element);\n        },\n        createMask: function () {\n            const element = document.createElement('div');\n            element.style.position = 'absolute';\n            element.style.top = 0;\n            element.style.left = 0;\n            element.style.width = '100%';\n            element.style.height = '100%';\n            element.style.background = 'transparent';\n            element.style.display = 'none';\n            element.show = function () {\n                this.style.display = 'block';\n            };\n            element.hide = function () {\n                this.style.display = 'none';\n            };\n            return element;\n        },\n        createSettingButton: function () {\n            let scope = this, item;\n            function onTap(event) {\n                event.preventDefault();\n                event.stopPropagation();\n                scope.mainMenu.toggle();\n                if (this.activated) {\n                    this.deactivate();\n                } else {\n                    this.activate();\n                }\n            }\n            item = this.createCustomItem({\n                style: {\n                    backgroundImage: 'url(\"' + DataImage.Setting + '\")',\n                    webkitTransition: this.DEFAULT_TRANSITION,\n                    transition: this.DEFAULT_TRANSITION\n                },\n                onTap: onTap\n            });\n            item.activate = function () {\n                this.style.transform = 'rotate3d(0,0,1,90deg)';\n                this.activated = true;\n                scope.mask.show();\n            };\n            item.deactivate = function () {\n                this.style.transform = 'rotate3d(0,0,0,0)';\n                this.activated = false;\n                scope.mask.hide();\n                if (scope.mainMenu && scope.mainMenu.visible) {\n                    scope.mainMenu.hide();\n                }\n                if (scope.activeSubMenu && scope.activeSubMenu.visible) {\n                    scope.activeSubMenu.hide();\n                }\n                if (scope.mainMenu && scope.mainMenu._width) {\n                    scope.mainMenu.changeSize(scope.mainMenu._width);\n                    scope.mainMenu.unslideAll();\n                }\n            };\n            item.activated = false;\n            return item;\n        },\n        createFullscreenButton: function () {\n            let scope = this, item, isFullscreen = false, tapSkipped = true, stylesheetId;\n            const {container} = this;\n            stylesheetId = 'panolens-style-addon';\n            if (!document.fullscreenEnabled && !document.webkitFullscreenEnabled && !document.mozFullScreenEnabled && !document.msFullscreenEnabled) {\n                return;\n            }\n            function onTap(event) {\n                event.preventDefault();\n                event.stopPropagation();\n                tapSkipped = false;\n                if (!isFullscreen) {\n                    if (container.requestFullscreen) {\n                        container.requestFullscreen();\n                    }\n                    if (container.msRequestFullscreen) {\n                        container.msRequestFullscreen();\n                    }\n                    if (container.mozRequestFullScreen) {\n                        container.mozRequestFullScreen();\n                    }\n                    if (container.webkitRequestFullscreen) {\n                        container.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);\n                    }\n                    isFullscreen = true;\n                } else {\n                    if (document.exitFullscreen) {\n                        document.exitFullscreen();\n                    }\n                    if (document.msExitFullscreen) {\n                        document.msExitFullscreen();\n                    }\n                    if (document.mozCancelFullScreen) {\n                        document.mozCancelFullScreen();\n                    }\n                    if (document.webkitExitFullscreen) {\n                        document.webkitExitFullscreen();\n                    }\n                    isFullscreen = false;\n                }\n                this.style.backgroundImage = isFullscreen ? 'url(\"' + DataImage.FullscreenLeave + '\")' : 'url(\"' + DataImage.FullscreenEnter + '\")';\n            }\n            function onFullScreenChange() {\n                if (tapSkipped) {\n                    isFullscreen = !isFullscreen;\n                    item.style.backgroundImage = isFullscreen ? 'url(\"' + DataImage.FullscreenLeave + '\")' : 'url(\"' + DataImage.FullscreenEnter + '\")';\n                }\n                scope.dispatchEvent({\n                    type: 'panolens-viewer-handler',\n                    method: 'onWindowResize'\n                });\n                tapSkipped = true;\n            }\n            document.addEventListener('fullscreenchange', onFullScreenChange, false);\n            document.addEventListener('webkitfullscreenchange', onFullScreenChange, false);\n            document.addEventListener('mozfullscreenchange', onFullScreenChange, false);\n            document.addEventListener('MSFullscreenChange', onFullScreenChange, false);\n            item = this.createCustomItem({\n                style: { backgroundImage: 'url(\"' + DataImage.FullscreenEnter + '\")' },\n                onTap: onTap\n            });\n            if (!document.querySelector(stylesheetId)) {\n                const sheet = document.createElement('style');\n                sheet.id = stylesheetId;\n                sheet.innerHTML = ':-webkit-full-screen { width: 100% !important; height: 100% !important }';\n                document.body.appendChild(sheet);\n            }\n            return item;\n        },\n        createVideoControl: function () {\n            const item = document.createElement('span');\n            item.style.display = 'none';\n            item.show = function () {\n                item.style.display = '';\n            };\n            item.hide = function () {\n                item.style.display = 'none';\n                item.controlButton.paused = true;\n                item.controlButton.update();\n            };\n            item.controlButton = this.createVideoControlButton();\n            item.seekBar = this.createVideoControlSeekbar();\n            item.appendChild(item.controlButton);\n            item.appendChild(item.seekBar);\n            item.dispose = function () {\n                item.removeChild(item.controlButton);\n                item.removeChild(item.seekBar);\n                item.controlButton.dispose();\n                item.controlButton = null;\n                item.seekBar.dispose();\n                item.seekBar = null;\n            };\n            this.addEventListener('video-control-show', item.show);\n            this.addEventListener('video-control-hide', item.hide);\n            return item;\n        },\n        createVideoControlButton: function () {\n            const scope = this;\n            function onTap(event) {\n                event.preventDefault();\n                event.stopPropagation();\n                scope.dispatchEvent({\n                    type: 'panolens-viewer-handler',\n                    method: 'toggleVideoPlay',\n                    data: !this.paused\n                });\n                this.paused = !this.paused;\n                item.update();\n            }\n            ;\n            const item = this.createCustomItem({\n                style: {\n                    float: 'left',\n                    backgroundImage: 'url(\"' + DataImage.VideoPlay + '\")'\n                },\n                onTap: onTap\n            });\n            item.paused = true;\n            item.update = function (paused) {\n                this.paused = paused !== undefined ? paused : this.paused;\n                this.style.backgroundImage = 'url(\"' + (this.paused ? DataImage.VideoPlay : DataImage.VideoPause) + '\")';\n            };\n            return item;\n        },\n        createVideoControlSeekbar: function () {\n            let scope = this, item, progressElement, progressElementControl, isDragging = false, mouseX, percentageNow, percentageNext;\n            progressElement = document.createElement('div');\n            progressElement.style.width = '0%';\n            progressElement.style.height = '100%';\n            progressElement.style.backgroundColor = '#fff';\n            progressElementControl = document.createElement('div');\n            progressElementControl.style.float = 'right';\n            progressElementControl.style.width = '14px';\n            progressElementControl.style.height = '14px';\n            progressElementControl.style.transform = 'translate(7px, -5px)';\n            progressElementControl.style.borderRadius = '50%';\n            progressElementControl.style.backgroundColor = '#ddd';\n            progressElementControl.addEventListener('mousedown', onMouseDown, { passive: true });\n            progressElementControl.addEventListener('touchstart', onMouseDown, { passive: true });\n            function onMouseDown(event) {\n                event.stopPropagation();\n                isDragging = true;\n                mouseX = event.clientX || event.changedTouches && event.changedTouches[0].clientX;\n                percentageNow = parseInt(progressElement.style.width) / 100;\n                addControlListeners();\n            }\n            function onVideoControlDrag(event) {\n                if (isDragging) {\n                    const clientX = event.clientX || event.changedTouches && event.changedTouches[0].clientX;\n                    percentageNext = (clientX - mouseX) / item.clientWidth;\n                    percentageNext = percentageNow + percentageNext;\n                    percentageNext = percentageNext > 1 ? 1 : percentageNext < 0 ? 0 : percentageNext;\n                    item.setProgress(percentageNext);\n                    scope.dispatchEvent({\n                        type: 'panolens-viewer-handler',\n                        method: 'setVideoCurrentTime',\n                        data: percentageNext\n                    });\n                }\n            }\n            function onVideoControlStop(event) {\n                event.stopPropagation();\n                isDragging = false;\n                removeControlListeners();\n            }\n            function addControlListeners() {\n                scope.container.addEventListener('mousemove', onVideoControlDrag, { passive: true });\n                scope.container.addEventListener('mouseup', onVideoControlStop, { passive: true });\n                scope.container.addEventListener('touchmove', onVideoControlDrag, { passive: true });\n                scope.container.addEventListener('touchend', onVideoControlStop, { passive: true });\n            }\n            function removeControlListeners() {\n                scope.container.removeEventListener('mousemove', onVideoControlDrag, false);\n                scope.container.removeEventListener('mouseup', onVideoControlStop, false);\n                scope.container.removeEventListener('touchmove', onVideoControlDrag, false);\n                scope.container.removeEventListener('touchend', onVideoControlStop, false);\n            }\n            function onTap(event) {\n                event.preventDefault();\n                event.stopPropagation();\n                if (event.target === progressElementControl) {\n                    return;\n                }\n                const percentage = event.changedTouches && event.changedTouches.length > 0 ? (event.changedTouches[0].pageX - event.target.getBoundingClientRect().left) / this.clientWidth : event.offsetX / this.clientWidth;\n                scope.dispatchEvent({\n                    type: 'panolens-viewer-handler',\n                    method: 'setVideoCurrentTime',\n                    data: percentage\n                });\n                item.setProgress(event.offsetX / this.clientWidth);\n            }\n            ;\n            function onDispose() {\n                removeControlListeners();\n                progressElement = null;\n                progressElementControl = null;\n            }\n            progressElement.appendChild(progressElementControl);\n            item = this.createCustomItem({\n                style: {\n                    float: 'left',\n                    width: '30%',\n                    height: '4px',\n                    marginTop: '20px',\n                    backgroundColor: 'rgba(188,188,188,0.8)'\n                },\n                onTap: onTap,\n                onDispose: onDispose\n            });\n            item.appendChild(progressElement);\n            item.setProgress = function (percentage) {\n                progressElement.style.width = percentage * 100 + '%';\n            };\n            this.addEventListener('video-update', function (event) {\n                item.setProgress(event.percentage);\n            });\n            item.progressElement = progressElement;\n            item.progressElementControl = progressElementControl;\n            return item;\n        },\n        createMenuItem: function (title) {\n            const scope = this;\n            const item = document.createElement('a');\n            item.textContent = title;\n            item.style.display = 'block';\n            item.style.padding = '10px';\n            item.style.textDecoration = 'none';\n            item.style.cursor = 'pointer';\n            item.style.pointerEvents = 'auto';\n            item.style.transition = this.DEFAULT_TRANSITION;\n            item.slide = function (right) {\n                this.style.transform = 'translateX(' + (right ? '' : '-') + '100%)';\n            };\n            item.unslide = function () {\n                this.style.transform = 'translateX(0)';\n            };\n            item.setIcon = function (url) {\n                if (this.icon) {\n                    this.icon.style.backgroundImage = 'url(' + url + ')';\n                }\n            };\n            item.setSelectionTitle = function (title) {\n                if (this.selection) {\n                    this.selection.textContent = title;\n                }\n            };\n            item.addSelection = function (name) {\n                const selection = document.createElement('span');\n                selection.style.fontSize = '13px';\n                selection.style.fontWeight = '300';\n                selection.style.float = 'right';\n                this.selection = selection;\n                this.setSelectionTitle(name);\n                this.appendChild(selection);\n                return this;\n            };\n            item.addIcon = function (url = DataImage.ChevronRight, left = false, flip = false) {\n                const element = document.createElement('span');\n                element.style.float = left ? 'left' : 'right';\n                element.style.width = '17px';\n                element.style.height = '17px';\n                element.style['margin' + (left ? 'Right' : 'Left')] = '12px';\n                element.style.backgroundSize = 'cover';\n                if (flip) {\n                    element.style.transform = 'rotateZ(180deg)';\n                }\n                this.icon = element;\n                this.setIcon(url);\n                this.appendChild(element);\n                return this;\n            };\n            item.addSubMenu = function (title, items) {\n                this.subMenu = scope.createSubMenu(title, items);\n                return this;\n            };\n            item.addEventListener('mouseenter', function () {\n                this.style.backgroundColor = '#e0e0e0';\n            }, false);\n            item.addEventListener('mouseleave', function () {\n                this.style.backgroundColor = '#fafafa';\n            }, false);\n            return item;\n        },\n        createMenuItemHeader: function (title) {\n            const header = this.createMenuItem(title);\n            header.style.borderBottom = '1px solid #333';\n            header.style.paddingBottom = '15px';\n            return header;\n        },\n        createMainMenu: function (menus) {\n            let scope = this, menu = this.createMenu();\n            menu._width = 200;\n            menu.changeSize(menu._width);\n            function onTap(event) {\n                event.preventDefault();\n                event.stopPropagation();\n                let mainMenu = scope.mainMenu, subMenu = this.subMenu;\n                function onNextTick() {\n                    mainMenu.changeSize(subMenu.clientWidth);\n                    subMenu.show();\n                    subMenu.unslideAll();\n                }\n                mainMenu.hide();\n                mainMenu.slideAll();\n                mainMenu.parentElement.appendChild(subMenu);\n                scope.activeMainItem = this;\n                scope.activeSubMenu = subMenu;\n                window.requestAnimationFrame(onNextTick);\n            }\n            ;\n            for (var i = 0; i < menus.length; i++) {\n                var item = menu.addItem(menus[i].title);\n                item.style.paddingLeft = '20px';\n                item.addIcon().addEventListener(scope.TOUCH_ENABLED ? 'touchend' : 'click', onTap, false);\n                if (menus[i].subMenu && menus[i].subMenu.length > 0) {\n                    var title = menus[i].subMenu[0].title;\n                    item.addSelection(title).addSubMenu(menus[i].title, menus[i].subMenu);\n                }\n            }\n            return menu;\n        },\n        createSubMenu: function (title, items) {\n            let scope = this, menu, subMenu = this.createMenu();\n            subMenu.items = items;\n            subMenu.activeItem = null;\n            function onTap(event) {\n                event.preventDefault();\n                event.stopPropagation();\n                menu = scope.mainMenu;\n                menu.changeSize(menu._width);\n                menu.unslideAll();\n                menu.show();\n                subMenu.slideAll(true);\n                subMenu.hide();\n                if (this.type !== 'header') {\n                    subMenu.setActiveItem(this);\n                    scope.activeMainItem.setSelectionTitle(this.textContent);\n                    if (this.handler) {\n                        this.handler();\n                    }\n                }\n            }\n            subMenu.addHeader(title).addIcon(undefined, true, true).addEventListener(scope.TOUCH_ENABLED ? 'touchend' : 'click', onTap, false);\n            for (let i = 0; i < items.length; i++) {\n                const item = subMenu.addItem(items[i].title);\n                item.style.fontWeight = 300;\n                item.handler = items[i].handler;\n                item.addIcon(' ', true);\n                item.addEventListener(scope.TOUCH_ENABLED ? 'touchend' : 'click', onTap, false);\n                if (!subMenu.activeItem) {\n                    subMenu.setActiveItem(item);\n                }\n            }\n            subMenu.slideAll(true);\n            return subMenu;\n        },\n        createMenu: function () {\n            const scope = this;\n            const menu = document.createElement('span');\n            const style = menu.style;\n            style.padding = '5px 0';\n            style.position = 'fixed';\n            style.bottom = '100%';\n            style.right = '14px';\n            style.backgroundColor = '#fafafa';\n            style.fontFamily = 'Helvetica Neue';\n            style.fontSize = '14px';\n            style.visibility = 'hidden';\n            style.opacity = 0;\n            style.boxShadow = '0 0 12pt rgba(0,0,0,0.25)';\n            style.borderRadius = '2px';\n            style.overflow = 'hidden';\n            style.willChange = 'width, height, opacity';\n            style.pointerEvents = 'auto';\n            style.transition = this.DEFAULT_TRANSITION;\n            menu.visible = false;\n            menu.changeSize = function (width, height) {\n                if (width) {\n                    this.style.width = width + 'px';\n                }\n                if (height) {\n                    this.style.height = height + 'px';\n                }\n            };\n            menu.show = function () {\n                this.style.opacity = 1;\n                this.style.visibility = 'visible';\n                this.visible = true;\n            };\n            menu.hide = function () {\n                this.style.opacity = 0;\n                this.style.visibility = 'hidden';\n                this.visible = false;\n            };\n            menu.toggle = function () {\n                if (this.visible) {\n                    this.hide();\n                } else {\n                    this.show();\n                }\n            };\n            menu.slideAll = function (right) {\n                for (let i = 0; i < menu.children.length; i++) {\n                    if (menu.children[i].slide) {\n                        menu.children[i].slide(right);\n                    }\n                }\n            };\n            menu.unslideAll = function () {\n                for (let i = 0; i < menu.children.length; i++) {\n                    if (menu.children[i].unslide) {\n                        menu.children[i].unslide();\n                    }\n                }\n            };\n            menu.addHeader = function (title) {\n                const header = scope.createMenuItemHeader(title);\n                header.type = 'header';\n                this.appendChild(header);\n                return header;\n            };\n            menu.addItem = function (title) {\n                const item = scope.createMenuItem(title);\n                item.type = 'item';\n                this.appendChild(item);\n                return item;\n            };\n            menu.setActiveItem = function (item) {\n                if (this.activeItem) {\n                    this.activeItem.setIcon(' ');\n                }\n                item.setIcon(DataImage.Check);\n                this.activeItem = item;\n            };\n            menu.addEventListener('mousemove', this.PREVENT_EVENT_HANDLER, true);\n            menu.addEventListener('mouseup', this.PREVENT_EVENT_HANDLER, true);\n            menu.addEventListener('mousedown', this.PREVENT_EVENT_HANDLER, true);\n            return menu;\n        },\n        createCustomItem: function (options = {}) {\n            const scope = this;\n            const item = options.element || document.createElement('span');\n            const {onDispose} = options;\n            item.style.cursor = 'pointer';\n            item.style.float = 'right';\n            item.style.width = '44px';\n            item.style.height = '100%';\n            item.style.backgroundSize = '60%';\n            item.style.backgroundRepeat = 'no-repeat';\n            item.style.backgroundPosition = 'center';\n            item.style.webkitUserSelect = item.style.MozUserSelect = item.style.userSelect = 'none';\n            item.style.position = 'relative';\n            item.style.pointerEvents = 'auto';\n            item.addEventListener(scope.TOUCH_ENABLED ? 'touchstart' : 'mouseenter', function () {\n                item.style.filter = item.style.webkitFilter = 'drop-shadow(0 0 5px rgba(255,255,255,1))';\n            }, { passive: true });\n            item.addEventListener(scope.TOUCH_ENABLED ? 'touchend' : 'mouseleave', function () {\n                item.style.filter = item.style.webkitFilter = '';\n            }, { passive: true });\n            this.mergeStyleOptions(item, options.style);\n            if (options.onTap) {\n                item.addEventListener(scope.TOUCH_ENABLED ? 'touchend' : 'click', options.onTap, false);\n            }\n            item.dispose = function () {\n                item.removeEventListener(scope.TOUCH_ENABLED ? 'touchend' : 'click', options.onTap, false);\n                if (onDispose) {\n                    options.onDispose();\n                }\n            };\n            return item;\n        },\n        mergeStyleOptions: function (element, options = {}) {\n            for (let property in options) {\n                if (options.hasOwnProperty(property)) {\n                    element.style[property] = options[property];\n                }\n            }\n            return element;\n        },\n        dispose: function () {\n            if (this.barElement) {\n                this.container.removeChild(this.barElement);\n                this.barElement.dispose();\n                this.barElement = null;\n            }\n        }\n    });\n    return Widget;\n});"]}